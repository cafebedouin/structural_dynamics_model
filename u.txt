% ============================================================================
% CONSTRAINT STORY: udhr_1948
% ============================================================================
% Generated: 2026-01-19
% Model: Gemini 2.0 Flash
% Source: Universal Declaration of Human Rights (1948)
% ============================================================================

:- module(constraint_udhr_1948, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks ---
:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:constraint_metric/3,
    constraint_indexing:constraint_classification/3,
    constraint_indexing:extractiveness_for_agent/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: udhr_1948
 * human_readable: Universal Declaration of Human Rights
 * domain: political/legal/social
 * temporal_scope: 1948 - Present (Civilizational aspiration)
 * spatial_scope: Global
 * * SUMMARY:
 * The UDHR is a foundational international document establishing "inalienable" 
 * rights for all humans. It serves as a "common standard of achievement" to 
 * prevent "barbarous acts" and provide a framework for freedom, justice, and peace.
 * * KEY AGENTS:
 * - The UN General Assembly: Institutional architect and rule-maker.
 * - The Individual Citizen: The intended beneficiary, often powerless relative to states.
 * - The Sovereign State: The primary enforcer and potential violator of the constraint.
 * * NARRATIVE ARC:
 * Born from the horrors of WWII, the UDHR moves from a proclamation of "natural law"
 * (Mountain) to a functional treaty framework (Rope), though it is often experienced
 * as a coercive limit (Snare) by states or a distant, unreachble ideal (Mountain)
 * by the oppressed.
 */

/* ==========================================================================
   2. CORE SYSTEM INTEGRATION
   ========================================================================== */

% Required for DR-Audit Suite
narrative_ontology:interval(un_era, 1948, 2026).
narrative_ontology:constraint_claim(udhr_1948, rope).

% Base extractiveness: 0.1
% Rationale: The UDHR is designed to be anti-extractive, returning agency to 
% individuals. However, minimal "extraction" exists in the form of states 
% yielding absolute sovereignty to the international order.
domain_priors:base_extractiveness(udhr_1948, 0.1).

% Suppression score: 0.2
% Rationale: It suppresses "tyranny and oppression" but encourages the visibility 
% of alternatives to authoritarianism. It presents itself as "natural."
domain_priors:suppression_score(udhr_1948, 0.2).

% Constraint metric facts (bridge for classification engine)
narrative_ontology:constraint_metric(udhr_1948, extractiveness, 0.1).
narrative_ontology:constraint_metric(udhr_1948, suppression_requirement, 0.2).

% Enforcement: Requires active maintenance through treaties and international pressure.
domain_priors:requires_active_enforcement(udhr_1948).

% Beneficiaries & Victims
constraint_beneficiary(udhr_1948, human_family).
constraint_beneficiary(udhr_1948, individual_citizens).
constraint_victim(udhr_1948, totalitarians).
constraint_victim(udhr_1948, absolute_monarchs).

% Metrics
/* ==========================================================================
   3. INDEXED CLASSIFICATIONS
   ========================================================================== */

/* --------------------------------------------------------------------------
   PERSPECTIVE 1: THE DISPOSSESSED REFUGEE - Mountain
   --------------------------------------------------------------------------
   WHO: powerless - No state protection, relying on "inherent" rights.
   WHEN: biographical - Their immediate survival depends on these "eternal" truths.
   WHERE: trapped - Often physically or legally unable to exit their situation.
   SCOPE: local/global - Focused on immediate safety via global principles.
   
   WHY THIS CLASSIFICATION:
   For the powerless, the UDHR is framed as "natural law" (born free and equal). 
   Because they cannot change the declaration and rely on its "inalienable" 
   status to survive, it functions as an unchangeable Mountain of reality.
   
   NARRATIVE EVIDENCE:
   "All human beings are born free and equal... endowed with reason and conscience." (Article 1)
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    udhr_1948,
    mountain,
    context(
        agent_power(powerless),
        time_horizon(biographical),
        exit_options(trapped),
        spatial_scope(global)
    )
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 2: THE UN GENERAL ASSEMBLY - Rope
   --------------------------------------------------------------------------
   WHO: institutional - The collective power of member states.
   WHEN: civilizational - Looking at the long-term progress of humanity.
   WHERE: mobile - States can negotiate, draft, and amend treaties.
   SCOPE: global - Worldwide jurisdiction of the declaration.
   
   WHY THIS CLASSIFICATION:
   To the UN, the UDHR is a "common standard of achievement" (Article 1). It is 
   a coordination mechanism (Rope) designed to promote "social progress" and 
   "friendly relations between nations." It is a tool for functional harmony.
   
   NARRATIVE EVIDENCE:
   "A common understanding... is of the greatest importance for the full realization of this pledge." (Preamble)
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    udhr_1948,
    rope,
    context(
        agent_power(institutional),
        time_horizon(civilizational),
        exit_options(mobile),
        spatial_scope(global)
    )
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 3: THE AUTHORITARIAN REGIME - Snare
   --------------------------------------------------------------------------
   WHO: institutional (local) - Power over a specific territory.
   WHEN: immediate - Focused on maintaining current control.
   WHERE: constrained - Subject to international sanctions/pressure if they fail.
   SCOPE: national - Their power is limited by these international standards.
   
   WHY THIS CLASSIFICATION:
   For a regime seeking absolute control, the UDHR is an asymmetric constraint 
   imposed by an external collective (UN). It restricts their "sovereign right" 
   to suppress dissent, acting as a Snare that tightens via international law.
   
   NARRATIVE EVIDENCE:
   "No one shall be subjected to arbitrary arrest... Everyone has the right to leave any country." (Articles 9, 13)
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    udhr_1948,
    snare,
    context(
        agent_power(institutional),
        time_horizon(immediate),
        exit_options(constrained),
        spatial_scope(national)
    )
) :-
    domain_priors:base_extractiveness(udhr_1948, E),
    E < 0.2. % Even low extraction is seen as coercive by those losing power.

/* ==========================================================================
   4. TESTS
   ========================================================================== */

:- begin_tests(udhr_1948_tests).

test(multi_perspective_variance) :-
    constraint_indexing:constraint_classification(udhr_1948, Type1, context(agent_power(powerless), time_horizon(biographical), exit_options(trapped), spatial_scope(global))),
    constraint_indexing:constraint_classification(udhr_1948, Type2, context(agent_power(institutional), time_horizon(civil_horizon), exit_options(mobile), spatial_scope(global))),
    Type1 = mountain,
    Type2 = rope.

test(regime_snare_perception) :-
    constraint_indexing:constraint_classification(udhr_1948, snare, context(agent_power(institutional), time_horizon(immediate), exit_options(constrained), spatial_scope(national))).

test(low_extractiveness_baseline) :-
    domain_priors:base_extractiveness(udhr_1948, E),
    E < 0.3.

:- end_tests(udhr_1948_tests).

/* ==========================================================================
   5. MODEL INTERPRETATION
   ========================================================================== */

/**
 * LLM GENERATION NOTES
 * * Model: Gemini 2.0 Flash
 * * KEY DECISIONS:
 * 1. BASE EXTRACTIVENESS (0.1): The UDHR is a "gift" of rights, but it extracts 
 * sovereignty from states.
 * 2. PERSPECTIVE SELECTION: Included the 'Dispossessed Refugee' (Powerless) 
 * to highlight the 'Mountain' aspect of natural law vs. the 'UN' (Institutional) 
 * 'Rope' of administrative coordination.
 * 3. CLASSIFICATION RATIONALE:
 * - Refugee -> Mountain: Because rights are declared "inalienable," they are
 * treated as fixed features of the universe.
 * - UN -> Rope: Because the document is a "standard of achievement" (a goal/tool).
 * - Authoritarian -> Snare: Because it limits the exercise of absolute power.
 * * AMBIGUITIES:
 * - The transition from a non-binding "Declaration" to binding "Covenants" (1966)
 * blurs the line between Rope and Snare. I kept the focus on the 1948 Declaration.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω)
   ========================================================================== */

omega_variable(
    enforcement_gap,
    "Is a right a 'Mountain' if there is no mechanism to enforce it?",
    resolution_mechanism("Observe correlation between UDHR citations and actual reduction in state violence."),
    impact("If no correlation: UDHR is a 'Scaffold' (hollow). If high: it is a true 'Mountain'."),
    confidence_without_resolution(medium)
).

omega_variable(
    universal_consensus,
    "Is the UDHR truly universal (Mountain) or a western liberal construct (Rope/Snare)?",
    resolution_mechanism("Cross-cultural longitudinal survey of value alignment across non-Western states."),
    impact("If Western only: Snare for non-Western states. If Universal: Mountain for humanity."),
    confidence_without_resolution(low)
).

/* ==========================================================================
   7. ALTERNATIVE ANALYSIS
   ========================================================================== */

/**
 * VIABLE ALTERNATIVES
 * * ALTERNATIVE 1: Westphalian Sovereignty (Absolute)
 * Viability: The status quo prior to 1948.
 * Suppression: Explicitly rejected by the UDHR's preamble ("barbarous acts").
 * Evidence: "It is essential... human rights should be protected by the rule of law."
 * * ALTERNATIVE 2: Regional/Religious Rights Codes
 * Viability: Cairo Declaration on Human Rights in Islam, etc.
 * Suppression: UDHR claims "universal" and "without distinction" status.
 * * CONCLUSION:
 * The presence of these alternatives, which the UDHR seeks to supersede or 
 * coordinate, confirms its role as a Rope/Snare depending on power level.
 */

/* ==========================================================================
   8. INTEGRATION HOOKS
   ========================================================================== */

% TO USE:
% ?- [udhr_1948].
% ?- run_tests(udhr_1948_tests).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */


% --- v3.1 Indexical Relativity Stubs (Fleet Repair) ---
constraint_indexing:constraint_classification(udhr_1946, mountain, agent_power(analytical)).
constraint_indexing:constraint_classification(udhr_1946, rope, agent_power(institutional)).
constraint_indexing:constraint_classification(udhr_1946, snare, agent_power(powerless)).
% ============================================================================
% CONSTRAINT STORY: ukr_mobilization
% ============================================================================
% Version: 3.4 (Deferential Realism Core)
% Logic: 3.3 (Indexed Tuple P,T,E,S)
% Generated: 2024-02-29
% ============================================================================

:- module(constraint_ukr_mobilization, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: ukr_mobilization
 * human_readable: Ukrainian Mobilization Law
 * domain: political
 * * SUMMARY:
 * The Ukrainian government is attempting to mobilize citizens to fight against the Russian invasion. This involves restrictions on movement, compulsory service, and potential penalties for evasion. The law aims to bolster defenses but faces public resistance and concerns about human rights.
 * * KEY AGENTS:
 * - Ukrainian Citizens: Subject (Powerless)
 * - Ukrainian Government: Beneficiary (Institutional)
 * - International Observers: Auditor (Analytical)
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(ukr_mobilization, 0.65). % Mountain suppression <= 0.05, Rope extraction <= 0.15, Snare extraction >= 0.46
domain_priors:suppression_score(ukr_mobilization, 0.75).   % Structural property (raw, unscaled). Only extractiveness is scaled (by power and scope).
domain_priors:theater_ratio(ukr_mobilization, 0.20).       % Piton detection (>= 0.70)

% Constraint metric facts — primary keys used by the classification engine.
% These mirror domain_priors values using the metric key names from config.pl.
narrative_ontology:constraint_metric(ukr_mobilization, extractiveness, 0.65).
narrative_ontology:constraint_metric(ukr_mobilization, suppression_requirement, 0.75).
narrative_ontology:constraint_metric(ukr_mobilization, theater_ratio, 0.20).

% Binary flags
domain_priors:requires_active_enforcement(ukr_mobilization). % Required for Tangled Rope

% Structural property derivation hooks:
%   has_coordination_function/1 is DERIVED from constraint_beneficiary/2
%   has_asymmetric_extraction/1 is DERIVED from constraint_victim/2
% Both are required for Tangled Rope. Coordination is also required for Scaffold.
narrative_ontology:constraint_beneficiary(ukr_mobilization, ukrainian_government).
narrative_ontology:constraint_victim(ukr_mobilization, ukrainian_citizens).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   Power (P) and Scope (S) both affect effective extraction.
   Scope modifiers: local=0.8, regional=0.9, national=1.0,
                    continental=1.1, global=1.2, universal=1.0.
   ========================================================================== */

% PERSPECTIVE 1: THE SUBJECT (SNARE/MOUNTAIN)
% High extraction felt as an immutable limit or predatory trap.
% NOTE: This may be upgraded to 'organized' power if a critical mass of victims exists.
constraint_indexing:constraint_classification(ukr_mobilization, snare,
    context(agent_power(powerless),
            time_horizon(biographical),
            exit_options(trapped),
            spatial_scope(national))).

% PERSPECTIVE 2: THE BENEFICIARY (ROPE)
% Viewed as essential infrastructure or coordination.
constraint_indexing:constraint_classification(ukr_mobilization, rope,
    context(agent_power(institutional),
            time_horizon(generational),
            exit_options(mobile),
            spatial_scope(national))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER
% Default analytical context (civilizational/analytical/global).
% This perspective is used by the bridge to derive constraint_claim.
% Type should reflect what the metrics compute: mountain, rope, tangled_rope, snare, scaffold, or piton.
constraint_indexing:constraint_classification(ukr_mobilization, tangled_rope,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(ukr_mobilization_tests).

test(perspectival_gap) :-
    % Verify there is a perspectival gap between powerless and institutional.
    constraint_indexing:constraint_classification(ukr_mobilization, TypePowerless, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(ukr_mobilization, TypeInstitutional, context(agent_power(institutional), _, _, _)),
    TypePowerless \= TypeInstitutional.

test(threshold_validation) :-
    config:param(extractiveness_metric_name, ExtMetricName),
    narrative_ontology:constraint_metric(ukr_mobilization, ExtMetricName, E),
    E >= 0.46. % Ensures it's a high-extraction Snare/Tangled.

:- end_tests(ukr_mobilization_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * The Ukrainian Mobilization Law is classified as a Snare from the perspective of Ukrainian citizens, as they are forced into military service with limited options.
 * The Ukrainian government views it as a Rope, essential for coordinating the war effort.
 * From an analytical perspective, it's a Tangled Rope because it serves a coordination function (defense) but also involves significant extraction and coercion. The base extractiveness is high (0.65) due to the severity of the obligations. The suppression score (0.75) reflects the lack of alternatives for those being mobilized.
 *
 * The Perspectival Gap arises because the government prioritizes national defense, while citizens may prioritize personal safety and freedom.
 * * MANDATROPHY ANALYSIS:
 * The Tangled Rope classification prevents the system from mislabeling the mobilization as pure extraction (Snare). The government aims to defend the country, a coordination function. However, it also extracts labor and freedom from its citizens, which is asymmetric. The `requires_active_enforcement` flag acknowledges the coercion involved.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

% omega_variable(ID, Question, Resolution_Mechanism, Impact, Confidence).
omega_variable(
    omega_ukr_mobilization,
    'Will the mobilization law ultimately strengthen or weaken Ukrainian society in the long run?',
    'Longitudinal study of social and economic impacts post-conflict.',
    'If strengthens: Increased national resilience; If weakens: Demographic and economic decline.',
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

% Required for external script parsing
narrative_ontology:interval(ukr_mobilization, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Temporal data enables drift detection (metric_substitution,
% extraction_accumulation) by providing measurements at multiple time points.
% Model how the constraint intensified or changed across the interval.
%
% Required for high-extraction constraints (base_extractiveness > 0.46).
% Use at least 3 time points (T=0, midpoint, T=end) for each tracked metric.
%
% Theater ratio over time (triggers metric_substitution detection):
narrative_ontology:measurement(ukr_mobilization_tr_t0, ukr_mobilization, theater_ratio, 0, 0.10).
narrative_ontology:measurement(ukr_mobilization_tr_t5, ukr_mobilization, theater_ratio, 5, 0.20).
narrative_ontology:measurement(ukr_mobilization_tr_t10, ukr_mobilization, theater_ratio, 10, 0.20).

% Extraction over time (triggers extraction_accumulation detection):
narrative_ontology:measurement(ukr_mobilization_ex_t0, ukr_mobilization, base_extractiveness, 0, 0.50).
narrative_ontology:measurement(ukr_mobilization_ex_t5, ukr_mobilization, base_extractiveness, 5, 0.65).
narrative_ontology:measurement(ukr_mobilization_ex_t10, ukr_mobilization, base_extractiveness, 10, 0.65).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */% ============================================================================
% CONSTRAINT STORY: ulysses_tower_1904
% ============================================================================
% Version: 3.4 (Deferential Realism Core)
% Logic: 3.3 (Indexed Tuple P,T,E,S)
% Generated: 2026-02-06
% ============================================================================

:- module(constraint_ulysses_tower, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: ulysses_tower_1904
 * human_readable: The Martello Tower Usurpation
 * domain: social/political/religious
 * * SUMMARY:
 * The Martello tower, originally built as a defensive Rope against French 
 * invasion, has become a Snare for Stephen Dedalus. Despite paying the 
 * twelve quid rent to the British state, Stephen is socially and 
 * psychologically "usurped" by Buck Mulligan's performative dominance and 
 * Haines's colonial presence.
 * * KEY AGENTS:
 * - Stephen Dedalus: Subject (Powerless) - The "server of a servant".
 * - Buck Mulligan: Beneficiary (Institutional) - Controlling the social theater.
 * - Haines: Auditor (Analytical) - The English presence collecting "sayings".
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(ulysses_tower_1904, 0.48). 
domain_priors:suppression_score(ulysses_tower_1904, 0.65).   
domain_priors:theater_ratio(ulysses_tower_1904, 0.82). % Mulligan's high mockery

% Primary keys for classification engine
narrative_ontology:constraint_metric(ulysses_tower_1904, extractiveness, 0.48).
narrative_ontology:constraint_metric(ulysses_tower_1904, suppression_requirement, 0.65).
narrative_ontology:constraint_metric(ulysses_tower_1904, theater_ratio, 0.82).

% Structural Property Declarations
narrative_ontology:constraint_beneficiary(ulysses_tower_1904, colonial_subjects).
narrative_ontology:constraint_victim(ulysses_tower_1904, stephen_dedalus).
domain_priors:requires_active_enforcement(ulysses_tower_1904).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   ========================================================================== */

% PERSPECTIVE 1: STEPHEN DEDALUS (SNARE)
% Effective Extraction: 0.48 * 1.5 (powerless) * 0.8 (local) = 0.576.
% Perceived as a predatory trap of "Agenbite of inwit" and unpaid debts.
constraint_indexing:constraint_classification(ulysses_tower_1904, snare, 
    context(agent_power(powerless), 
            time_horizon(biographical), 
            exit_options(trapped), 
            spatial_scope(local))).

% PERSPECTIVE 2: BUCK MULLIGAN (ROPE)
% Effective Extraction: 0.48 * -0.2 (institutional) * 0.8 = -0.0768.
% Viewed as a blithe coordination for breakfast, swimming, and "Hellenizing".
constraint_indexing:constraint_classification(ulysses_tower_1904, rope, 
    context(agent_power(institutional), 
            time_horizon(generational), 
            exit_options(mobile), 
            spatial_scope(local))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (PITON)
% Extreme Theater Ratio (0.82) indicates a Piton of atrophied function.
constraint_indexing:constraint_classification(ulysses_tower_1904, piton,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(national))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(ulysses_tower_1904_tests).

test(perspectival_gap) :-
    % Verify the shift from Snare (Stephen) to Rope (Mulligan).
    constraint_indexing:constraint_classification(ulysses_tower_1904, snare, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(ulysses_tower_1904, rope, context(agent_power(institutional), _, _, _)).

test(piton_theater_check) :-
    % Piton classification requires theater_ratio >= 0.70.
    domain_priors:theater_ratio(ulysses_tower_1904, TR),
    TR >= 0.70.

:- end_tests(ulysses_tower_1904_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * Stephen perceives the tower as a Snare because his payment of the twelve 
 * quid rent to the British state does not grant him social sovereignty. 
 * Mulligan's constant mockery (TR: 0.82) transforms the living arrangement 
 * into a Piton for analytical observers—it is a structure of atrophied 
 * defense now serving as a stage for "mummers".
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_usurpation,
    "Will Stephen successfully withhold the key and the rent?",
    "Review of the final encounter at the foot of the ladder.",
    "Withholding confirms a Rope; surrender hardens the Snare.",
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

narrative_ontology:interval(ulysses_tower_1904, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Theater Ratio (Mulligan's performative blasphemy peaking during breakfast)
narrative_ontology:measurement(ut_tr_t0, ulysses_tower_1904, theater_ratio, 0, 0.70).
narrative_ontology:measurement(ut_tr_t5, ulysses_tower_1904, theater_ratio, 5, 0.85).
narrative_ontology:measurement(ut_tr_t10, ulysses_tower_1904, theater_ratio, 10, 0.82).

% Extraction (Rent payments and social debts accumulating)
narrative_ontology:measurement(ut_ex_t0, ulysses_tower_1904, base_extractiveness, 0, 0.35).
narrative_ontology:measurement(ut_ex_t5, ulysses_tower_1904, base_extractiveness, 5, 0.45).
narrative_ontology:measurement(ut_ex_t10, ulysses_tower_1904, base_extractiveness, 10, 0.48).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: ulysses_school_1904
% ============================================================================
% Version: 3.4 (Deferential Realism Core)
% Logic: 3.3 (Indexed Tuple P,T,E,S)
% Generated: 2026-02-06
% ============================================================================

:- module(constraint_ulysses_school, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: ulysses_school_1904
 * human_readable: The Nightmare of History (Dalkey School)
 * domain: economic/social/political
 * * SUMMARY:
 * For Stephen Dedalus, the school at Dalkey is a Snare defined by the 
 * "nightmare of history" and the futility of teaching privileged boys who 
 * lack innocence[cite: 377, 555]. The educational structure is a Tangled 
 * Rope for Mr. Deasy, who uses it to enforce a "generous but just" financial 
 * discipline while maintaining a high theater of anti-Semitic and 
 * pro-Unionist rhetoric[cite: 492, 537].
 * * KEY AGENTS:
 * - Stephen Dedalus: Subject (Powerless) - Trapped in "three nooses" of debt and role[cite: 475, 488].
 * - Mr. Deasy: Beneficiary (Institutional) - Paying his way and managing the "Strongroom"[cite: 464, 486].
 * - The Students: Auditor (Analytical) - Observing Stephen's "lack of rule"[cite: 374].
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(ulysses_school_1904, 0.49). % High due to Stephen's list of debts[cite: 488].
domain_priors:suppression_score(ulysses_school_1904, 0.72).   % History as a "branded" and "fettered" room.
domain_priors:theater_ratio(ulysses_school_1904, 0.78).      % Deasy's performative "wisdom" and savings-box prodding[cite: 467, 512].

% Primary keys for classification engine
narrative_ontology:constraint_metric(ulysses_school_1904, extractiveness, 0.49).
narrative_ontology:constraint_metric(ulysses_school_1904, suppression_requirement, 0.72).
narrative_ontology:constraint_metric(ulysses_school_1904, theater_ratio, 0.78).

% Structural Property Declarations
narrative_ontology:constraint_beneficiary(ulysses_school_1904, english_empire). % History moving toward a manifest goal[cite: 558].
narrative_ontology:constraint_victim(ulysses_school_1904, stephen_dedalus).
domain_priors:requires_active_enforcement(ulysses_school_1904). % Deasy's prodding and strict "rules"[cite: 374, 512].

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   ========================================================================== */

% PERSPECTIVE 1: STEPHEN DEDALUS (SNARE)
% Effective Extraction: 0.49 * 1.5 (powerless) * 1.0 (national) = 0.735.
% Perceived as a nightmare from which he is trying to awake.
constraint_indexing:constraint_classification(ulysses_school_1904, snare, 
    context(agent_power(powerless), 
            time_horizon(biographical), 
            exit_options(trapped), 
            spatial_scope(national))).

% PERSPECTIVE 2: MR. DEASY (ROPE)
% Effective Extraction: 0.49 * -0.2 (institutional) * 1.0 = -0.098.
% Viewed as the essential coordination of "paying one's way" and justice[cite: 486, 492].
constraint_indexing:constraint_classification(ulysses_school_1904, rope, 
    context(agent_power(institutional), 
            time_horizon(generational), 
            exit_options(mobile), 
            spatial_scope(national))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (PITON)
% Extreme Theater Ratio (0.78) suggests the atrophied function of "toothless terrors"[cite: 584].
constraint_indexing:constraint_classification(ulysses_school_1904, piton,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(ulysses_school_1904_tests).

test(perspectival_gap) :-
    % Verify the shift from Snare (Stephen) to Rope (Deasy).
    constraint_indexing:constraint_classification(ulysses_school_1904, snare, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(ulysses_school_1904, rope, context(agent_power(institutional), _, _, _)).

test(piton_theater_validation) :-
    % Piton classification requires theater_ratio >= 0.70.
    domain_priors:theater_ratio(ulysses_school_1904, TR),
    TR >= 0.70.

:- end_tests(ulysses_school_1904_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * Stephen identifies the "three nooses" of his financial and social reality 
 * as a Snare—a predatory trap of accumulated debt and listless labor[cite: 475, 488]. 
 * Conversely, Mr. Deasy views the system as a Rope of coordination, 
 * maintaining the "proudest boast" of the Englishman: "I paid my way"[cite: 486]. 
 * The high Theater Ratio (0.78) comes from the "mummery" of Deasy’s symbols—
 * the savings-box, the Stuart coins, and his insistence on anti-Semitic 
 * conspiracy theories that mask the "nightmare" of Irish history[cite: 435, 457, 537].
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_history_as_nightmare,
    "Is history truly a trapped room of ousted possibilities, or a joust moving toward God? [cite: 386, 558]",
    "Tracking the manifestation of the 'great goal' vs the 'shout in the street'[cite: 558, 560].",
    "God-goal confirms a Rope; street-shout hardens the Snare.",
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

narrative_ontology:interval(ulysses_school_1904, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Theater Ratio (Deasy's rhetorical intensity rising toward the anti-Semitic climax)
narrative_ontology:measurement(us_tr_t0, ulysses_school_1904, theater_ratio, 0, 0.65).
narrative_ontology:measurement(us_tr_t5, ulysses_school_1904, theater_ratio, 5, 0.75).
narrative_ontology:measurement(us_tr_t10, ulysses_school_1904, theater_ratio, 10, 0.78).

% Extraction (Accumulation of Stephen's biographical and spiritual debt [cite: 488])
narrative_ontology:measurement(us_ex_t0, ulysses_school_1904, base_extractiveness, 0, 0.40).
narrative_ontology:measurement(us_ex_t5, ulysses_school_1904, base_extractiveness, 5, 0.45).
narrative_ontology:measurement(us_ex_t10, ulysses_school_1904, base_extractiveness, 10, 0.49).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: ulysses_proteus_1904
% ============================================================================
% Version: 3.4 (Deferential Realism Core)
% Logic: 3.3 (Indexed Tuple P,T,E,S)
% Generated: 2026-02-06
% ============================================================================

:- module(constraint_ulysses_proteus, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: ulysses_proteus_1904
 * human_readable: The Ineluctable Modality (Sandymount Strand)
 * domain: philosophical/social/technological
 * * SUMMARY:
 * Stephen Dedalus navigates Sandymount Strand, bound by the "ineluctable 
 * modality of the visible". This perceptual Mountain forces him 
 * to read the "signatures of all things". For Stephen, the 
 * experience is a Snare of internal brooding, where memories of Paris and 
 * family decay act as "heavy sands" of language silted by the past.
 * * KEY AGENTS:
 * - Stephen Dedalus: Subject (Powerless) - Walking through "short times of space"[cite: 603].
 * - The Physical Universe: Beneficiary (Institutional) - Enforcing the "lex eterna".
 * - The Reader/Observer: Auditor (Analytical) - Witnessing the "mummer" of thought[cite: 832].
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(ulysses_proteus_1904, 0.52). % High due to "Agenbite of inwit"[cite: 237, 836].
domain_priors:suppression_score(ulysses_proteus_1904, 0.85).   % The "ineluctable" nature of vision and sound[cite: 595, 604].
domain_priors:theater_ratio(ulysses_proteus_1904, 0.72).      % Internal "mummery" and "pretenders"[cite: 773, 831].

% Primary keys for classification engine
narrative_ontology:constraint_metric(ulysses_proteus_1904, extractiveness, 0.52).
narrative_ontology:constraint_metric(ulysses_proteus_1904, suppression_requirement, 0.85).
narrative_ontology:constraint_metric(ulysses_proteus_1904, theater_ratio, 0.72).

% Structural Property Declarations
narrative_ontology:constraint_beneficiary(ulysses_proteus_1904, physical_reality).
narrative_ontology:constraint_victim(ulysses_proteus_1904, stephen_dedalus).
domain_priors:requires_active_enforcement(ulysses_proteus_1904). % Memory and guilt as active "tyrants"[cite: 443].

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   ========================================================================== */

% PERSPECTIVE 1: STEPHEN DEDALUS (SNARE)
% Effective Extraction: 0.52 * 1.5 (powerless) * 0.8 (local) = 0.624.
% Perceived as a trap of "unwholesome sandflats" and "sewage breath".
constraint_indexing:constraint_classification(ulysses_proteus_1904, snare, 
    context(agent_power(powerless), 
            time_horizon(biographical), 
            exit_options(trapped), 
            spatial_scope(local))).

% PERSPECTIVE 2: THE PHYSICAL UNIVERSE (MOUNTAIN)
% Effective Extraction: 0.52 * -0.2 (institutional) * 1.0 (national/universal) = -0.104.
% The "lex eterna"  functions as a fixed topological floor.
constraint_indexing:constraint_classification(ulysses_proteus_1904, mountain, 
    context(agent_power(institutional), 
            time_horizon(civilizational), 
            exit_options(mobile), 
            spatial_scope(universal))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (PITON)
% Theater Ratio (0.72) suggests a Piton of "vanished crowds" and "mummery"[cite: 513, 831].
constraint_indexing:constraint_classification(ulysses_proteus_1904, piton,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(ulysses_proteus_1904_tests).

test(perspectival_gap) :-
    % Verify the shift from Snare (Subjective guilt) to Mountain (Objective physics).
    constraint_indexing:constraint_classification(ulysses_proteus_1904, snare, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(ulysses_proteus_1904, mountain, context(agent_power(institutional), _, _, _)).

test(piton_theater_validation) :-
    % Piton classification requires theater_ratio >= 0.70.
    domain_priors:theater_ratio(ulysses_proteus_1904, TR),
    TR >= 0.70.

:- end_tests(ulysses_proteus_1904_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * Stephen’s walk is a meditation on the Mountain of the "Ineluctable". 
 * While physics provides a stable floor (the "nacheinander" of time)[cite: 603], 
 * his psychological state is a Snare. The "heavy sands" of his past—Paris 
 * poverty [cite: 689], his mother’s death[cite: 702], and uncle Richie’s 
 * "houses of decay" [cite: 649]—extract spiritual energy, leaving him 
 * "lonely here"[cite: 843]. The high Theater Ratio (0.72) reflects his 
 * "mummer" nature, where internal monologues on Aristotle and 
 * Berkeley mask his social "dispossession"[cite: 694].
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_protean_identity,
    "Is the 'other me' [cite: 693] a stable Rope of identity or a shifting Snare of solipsism?",
    "Review of the 'word known to all men'  vs 'phantasmal mirth'[cite: 131].",
    "Word-known confirms a Rope; phantasmal-mirth hardens the Snare.",
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

narrative_ontology:interval(ulysses_proteus_1904, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Theater Ratio (Peaking as Stephen's internal mummery becomes more abstract)
narrative_ontology:measurement(up_tr_t0, ulysses_proteus_1904, theater_ratio, 0, 0.60).
narrative_ontology:measurement(up_tr_t5, ulysses_proteus_1904, theater_ratio, 5, 0.75).
narrative_ontology:measurement(up_tr_t10, ulysses_proteus_1904, theater_ratio, 10, 0.72).

% Extraction (The increasing weight of "Agenbite of inwit" and hunger)
narrative_ontology:measurement(up_ex_t0, ulysses_proteus_1904, base_extractiveness, 0, 0.45).
narrative_ontology:measurement(up_ex_t5, ulysses_proteus_1904, base_extractiveness, 5, 0.50).
narrative_ontology:measurement(up_ex_t10, ulysses_proteus_1904, base_extractiveness, 10, 0.52).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: ulysses_calypso_1904
% ============================================================================
% Version: 3.4 (Deferential Realism Core)
% Logic: 3.3 (Indexed Tuple P,T,E,S)
% Generated: 2026-02-06
% ============================================================================

:- module(constraint_ulysses_calypso, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: ulysses_calypso_1904
 * human_readable: The Domestic Calypso (7 Eccles Street)
 * domain: social/economic/religious
 * * SUMMARY:
 * Leopold Bloom navigates the "loose brass quoits" of his domestic life. 
 * While the morning routine functions as a Rope of coordination (preparing 
 * Molly's tea and kidney), Bloom is caught in a Snare of looming 
 * marital infidelity (the letter from Blazes Boylan) and the "grey sunken 
 * cunt of the world" of Zionist/Orientalist desolation.
 * * KEY AGENTS:
 * - Leopold Bloom: Subject (Powerless) - Moving on "quietly creaky boots".
 * - Molly Bloom: Beneficiary (Institutional) - Ruling from her "ample bedwarmed flesh".
 * - Blazes Boylan: Auditor (Analytical) - The "bold hand" on the morning letters.
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(ulysses_calypso_1904, 0.47). % High due to marital anxiety and debt symbols.
domain_priors:suppression_score(ulysses_calypso_1904, 0.60).   % Domestic habits and "ineluctable" hunger.
domain_priors:theater_ratio(ulysses_calypso_1904, 0.75).      % High theater: "metempsychosis", Orientalist daydreams, and Plasto's hat labels.

% Primary keys for classification engine
narrative_ontology:constraint_metric(ulysses_calypso_1904, extractiveness, 0.47).
narrative_ontology:constraint_metric(ulysses_calypso_1904, suppression_requirement, 0.60).
narrative_ontology:constraint_metric(ulysses_calypso_1904, theater_ratio, 0.75).

% Structural Property Declarations
narrative_ontology:constraint_beneficiary(ulysses_calypso_1904, marion_bloom). % Receiving breakfast in bed.
narrative_ontology:constraint_victim(ulysses_calypso_1904, leopold_bloom).    % The "servant" of the house.
domain_priors:requires_active_enforcement(ulysses_calypso_1904). % Molly's calls: "Poldy! Scald the teapot."

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   ========================================================================== */

% PERSPECTIVE 1: LEOPOLD BLOOM (SNARE)
% Effective Extraction: 0.47 * 1.5 (powerless) * 0.8 (local) = 0.564.
% Perceived as a trap of "useless" affection and looming "destiny" (Milly/Molly).
constraint_indexing:constraint_classification(ulysses_calypso_1904, snare, 
    context(agent_power(powerless), 
            time_horizon(biographical), 
            exit_options(trapped), 
            spatial_scope(local))).

% PERSPECTIVE 2: MOLLY BLOOM (ROPE)
% Effective Extraction: 0.47 * -0.2 (institutional) * 0.8 = -0.0752.
% Viewed as the essential coordination of being "parched" and needing tea.
constraint_indexing:constraint_classification(ulysses_calypso_1904, rope, 
    context(agent_power(institutional), 
            time_horizon(generational), 
            exit_options(mobile), 
            spatial_scope(local))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (PITON)
% Theater Ratio (0.75) indicates a Piton of "Agendath Netaim" and "metempsychosis".
constraint_indexing:constraint_classification(ulysses_calypso_1904, piton,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(ulysses_calypso_1904_tests).

test(perspectival_gap) :-
    % Verify the shift from Snare (Bloom's anxiety) to Rope (Molly's breakfast).
    constraint_indexing:constraint_classification(ulysses_calypso_1904, TypePowerless, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(ulysses_calypso_1904, TypeInstitutional, context(agent_power(institutional), _, _, _)),
    TypePowerless \= TypeInstitutional.

test(piton_theater_check) :-
    % Piton classification requires theater_ratio >= 0.70.
    domain_priors:theater_ratio(ulysses_calypso_1904, TR),
    TR >= 0.70.

:- end_tests(ulysses_calypso_1904_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * Leopold Bloom perceives his domestic life as a Snare—a predatory trap of 
 * marital insecurity ("Bold hand. Mrs Marion") and the "grey horror" of 
 * a "dead land"[cite: 1024]. Conversely, Molly perceives the morning as a Rope 
 * of coordination, where Bloom is the "server" bringing her "Love's Old 
 * Sweet Song" and tea[cite: 1041, 1069]. The high Theater Ratio (0.75) 
 * is driven by Bloom's performative fantasies about "Oriental" Jaffa 
 * [cite: 1002] and the "mummery" of explaining Greek terms like 
 * "metempsychosis" to mask his visceral "desolation"[cite: 1024, 1080].
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_metempsychosis,
    "Is Bloom's life a unique Rope of new experience or a Snare of reincarnation?",
    "Review of the 'word known to all men' vs the 'smudge of the dead' in Titbits.",
    "Reincarnation confirms the Snare; agency confirms the Rope.",
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

narrative_ontology:interval(ulysses_calypso_1904, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Theater Ratio (Bloom's daydreaming peaking during his walk to Dlugacz's)
narrative_ontology:measurement(uc_tr_t0, ulysses_calypso_1904, theater_ratio, 0, 0.65).
narrative_ontology:measurement(uc_tr_t5, ulysses_calypso_1904, theater_ratio, 5, 0.80).
narrative_ontology:measurement(uc_tr_t10, ulysses_calypso_1904, theater_ratio, 10, 0.75).

% Extraction (Bloom's psychological cost rising as he reads the letters)
narrative_ontology:measurement(uc_ex_t0, ulysses_calypso_1904, base_extractiveness, 0, 0.35).
narrative_ontology:measurement(uc_ex_t5, ulysses_calypso_1904, base_extractiveness, 5, 0.42).
narrative_ontology:measurement(uc_ex_t10, ulysses_calypso_1904, base_extractiveness, 10, 0.47).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: ulysses_lotus_1904
% ============================================================================
% Version: 3.4 (Deferential Realism Core)
% Logic: 3.3 (Indexed Tuple P,T,E,S)
% Generated: 2026-02-06
% ============================================================================

:- module(constraint_ulysses_lotus, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: ulysses_lotus_1904
 * human_readable: The Narcotic Social Rope (Lotus Eaters)
 * domain: social/religious/technological
 * * SUMMARY:
 * Leopold Bloom navigates the "lethargy" and "flowers of idleness" of 1904 
 * Dublin. Shared rituals—the post office secrecy, the aromatic tea 
 * advertisements, and the Catholic Mass—function as a Rope of coordination 
 * that anchors his social existence. However, for Bloom as "Henry Flower," 
 * these same rituals become a Snare of "Agenbite of inwit" and spiritual 
 * "sleeping sickness."
 * * KEY AGENTS:
 * - Leopold Bloom: Subject (Powerless) - The "naughty boy" seeking punishment.
 * - The Catholic Church: Beneficiary (Institutional) - The "wonderful organisation" of clockwork salvation.
 * - Martha Clifford: Auditor (Analytical) - Probing through the "language of flowers."
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(ulysses_lotus_1904, 0.48). 
domain_priors:suppression_score(ulysses_lotus_1904, 0.70).   
domain_priors:theater_ratio(ulysses_lotus_1904, 0.85). % High mummery: mass, flowers, and pseudonyms.

% Primary keys for classification engine
narrative_ontology:constraint_metric(ulysses_lotus_1904, extractiveness, 0.48).
narrative_ontology:constraint_metric(ulysses_lotus_1904, suppression_requirement, 0.70).
narrative_ontology:constraint_metric(ulysses_lotus_1904, theater_ratio, 0.85).

% Structural Property Declarations
narrative_ontology:constraint_beneficiary(ulysses_lotus_1904, holy_roman_church).
narrative_ontology:constraint_victim(ulysses_lotus_1904, leopold_bloom).
domain_priors:requires_active_enforcement(ulysses_lotus_1904). % Social etiquette and the secret correspondence.

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   ========================================================================== */

% PERSPECTIVE 1: BLOOM AS "HENRY FLOWER" (SNARE)
% Effective Extraction: 0.48 * 1.5 (powerless) * 0.8 (local) = 0.576.
% Perceived as a "poison bouquet" of secret guilt and "punishment."
constraint_indexing:constraint_classification(ulysses_lotus_1904, snare, 
    context(agent_power(powerless), 
            time_horizon(biographical), 
            exit_options(trapped), 
            spatial_scope(local))).

% PERSPECTIVE 2: THE CHURCH MILITANT (ROPE)
% Effective Extraction: 0.48 * -0.2 (institutional) * 0.8 = -0.0768.
% Viewed as the "clockwork" coordination of "bread of angels" and family parties.
constraint_indexing:constraint_classification(ulysses_lotus_1904, rope, 
    context(agent_power(institutional), 
            time_horizon(generational), 
            exit_options(mobile), 
            spatial_scope(local))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (PITON)
% Theater Ratio (0.85) indicates a Piton of "mummery" and "vanished crowds."
constraint_indexing:constraint_classification(ulysses_lotus_1904, piton,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(ulysses_lotus_1904_tests).

test(perspectival_gap) :-
    % Verify the shift from Snare (Bloom) to Rope (Church).
    constraint_indexing:constraint_classification(ulysses_lotus_1904, snare, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(ulysses_lotus_1904, rope, context(agent_power(institutional), _, _, _)).

test(piton_theater_check) :-
    % Piton classification requires theater_ratio >= 0.70.
    domain_priors:theater_ratio(ulysses_lotus_1904, TR),
    TR >= 0.70.

:- end_tests(ulysses_lotus_1904_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * Leopold Bloom experiences Dublin as a site of narcotic coordination. 
 * Shared spaces like the post office and church function as a Rope of 
 * daily movement, yet his internal "Henry Flower" identity is a Snare 
 * where extraction is felt as the "punishment" demanded by Martha Clifford. 
 * The high Theater Ratio (0.85) stems from the "mummery" of the Mass 
 * (described as "eating bits of a corpse") and the performative "language 
 * of flowers" that Bloom uses to mask his material and emotional isolation.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_narcotic_solipsism,
    "Is Bloom's 'Henry Flower' persona a Rope for growth or a Snare of isolation?",
    "Review of the 'word known to all men' vs the 'language of flowers'.",
    "Communication confirms a Rope; secret letters harden the Snare.",
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

narrative_ontology:interval(ulysses_lotus_1904, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Theater Ratio (Peaking during the Communion ritual and the reading of Martha's letter)
narrative_ontology:measurement(ul_tr_t0, ulysses_lotus_1904, theater_ratio, 0, 0.70).
narrative_ontology:measurement(ul_tr_t5, ulysses_lotus_1904, theater_ratio, 5, 0.88).
narrative_ontology:measurement(ul_tr_t10, ulysses_lotus_1904, theater_ratio, 10, 0.85).

% Extraction (The increasing weight of Bloom's "naughty boy" guilt and loneliness)
narrative_ontology:measurement(ul_ex_t0, ulysses_lotus_1904, base_extractiveness, 0, 0.38).
narrative_ontology:measurement(ul_ex_t5, ulysses_lotus_1904, base_extractiveness, 5, 0.44).
narrative_ontology:measurement(ul_ex_t10, ulysses_lotus_1904, base_extractiveness, 10, 0.48).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: ulysses_hades_1904
% ============================================================================
% Version: 3.4 (Deferential Realism Core)
% Logic: 3.3 (Indexed Tuple P,T,E,S)
% Generated: 2026-02-06
% ============================================================================

:- module(constraint_ulysses_hades, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: ulysses_hades_1904
 * human_readable: The Funerary Mountain (Prospect Cemetery)
 * domain: social/religious/technological
 * * SUMMARY:
 * Leopold Bloom attends the funeral of Paddy Dignam, navigating the communal 
 * Ropes of mourning while confronting the absolute Mountain of death. 
 * The ritual coordination of the carriage ride and the interment is 
 * punctuated by the high theater of Father Coffey’s Latin and the 
 * "ineluctable" reality of decomposition and forgotten names.
 * * KEY AGENTS:
 * - Leopold Bloom: Subject (Powerless) - Counting the bared heads (thirteen).
 * - Father Coffey: Beneficiary (Institutional) - Balancing a book against his "toad's belly".
 * - John O'Connell: Auditor (Analytical) - The caretaker puzzling keys at his back.
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(ulysses_hades_1904, 0.49). % High due to biological decay and grief.
domain_priors:suppression_score(ulysses_hades_1904, 0.95).   % Death as an absolute "Fixed Point".
domain_priors:theater_ratio(ulysses_hades_1904, 0.88).      % The "Pomp of death" and Father Coffey's "fluent croak".

% Primary keys for classification engine
narrative_ontology:constraint_metric(ulysses_hades_1904, extractiveness, 0.49).
narrative_ontology:constraint_metric(ulysses_hades_1904, suppression_requirement, 0.95).
narrative_ontology:constraint_metric(ulysses_hades_1904, theater_ratio, 0.88).

% Structural Property Declarations
narrative_ontology:constraint_beneficiary(ulysses_hades_1904, burial_societies). % Paying the penny a week for turf.
narrative_ontology:constraint_victim(ulysses_hades_1904, paddy_dignam).          % The "stiff" in the dealer box.
domain_priors:requires_active_enforcement(ulysses_hades_1904). % Gravediggers and caretakers enforcing "rest".

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   ========================================================================== */

% PERSPECTIVE 1: THE DEPARTED (MOUNTAIN)
% Effective Extraction: 0.49 * 1.5 (powerless) * 1.2 (universal) = 0.882.
% χ < 0.05 logic check: In death, extraction ceases because agency is zero.
% However, for the survivor Bloom, it is a Mountain of "Inertial Limit".
constraint_indexing:constraint_classification(ulysses_hades_1904, mountain, 
    context(agent_power(powerless), 
            time_horizon(civilizational), 
            exit_options(trapped), 
            spatial_scope(universal))).

% PERSPECTIVE 2: THE CARETAKER (ROPE)
% Effective Extraction: 0.49 * -0.2 (institutional) * 0.8 (local) = -0.0784.
% Viewed as the essential coordination of "cheering a fellow up" and "keys".
constraint_indexing:constraint_classification(ulysses_hades_1904, rope, 
    context(agent_power(institutional), 
            time_horizon(generational), 
            exit_options(mobile), 
            spatial_scope(local))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (PITON)
% Extreme Theater Ratio (0.88) indicates a Piton of "vanished crowds" and "mummery".
constraint_indexing:constraint_classification(ulysses_hades_1904, piton,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(ulysses_hades_1904_tests).

test(perspectival_gap) :-
    % Verify shift from the Mountain of death to the Rope of the caretaker.
    constraint_indexing:constraint_classification(ulysses_hades_1904, mountain, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(ulysses_hades_1904, rope, context(agent_power(institutional), _, _, _)).

test(piton_theater_check) :-
    % Piton classification requires theater_ratio >= 0.70.
    domain_priors:theater_ratio(ulysses_hades_1904, TR),
    TR >= 0.70.

:- end_tests(ulysses_hades_1904_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * Leopold Bloom experiences Prospect Cemetery as a site of the Funerary 
 * Mountain—an irreducible "Fixed Point" where "once you are dead you are 
 * dead"[cite: 4007]. While burial societies and caretakers provide a Rope 
 * of coordination (managing "twenty or thirty funerals every day" [cite: 3911]), 
 * the high Theater Ratio (0.88) reflects the "Pomp of death". 
 * Bloom sees through this theater, noting that Father Coffey’s Latin 
 * "stupefies them first" [cite: 3520] and that the "resurrection and the 
 * life" is merely a "pump" that eventually "gets bunged up"[cite: 4005, 4006].
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_mortality_theater,
    "Is the 'last day idea' a Rope for social hope or a Snare for religious extraction?",
    "Review of 'waiting for it to melt in their stomachs' vs 'safe in the arms of kingdom come'.",
    "Hope-coordination confirms a Rope; 'pious fraud' hardens the Snare.",
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

narrative_ontology:interval(ulysses_hades_1904, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Theater Ratio (Peaking during the mortuary chapel service and Father Coffey's croak)
narrative_ontology:measurement(uh_tr_t0, ulysses_hades_1904, theater_ratio, 0, 0.75).
narrative_ontology:measurement(uh_tr_t5, ulysses_hades_1904, theater_ratio, 5, 0.92).
narrative_ontology:measurement(uh_tr_t10, ulysses_hades_1904, theater_ratio, 10, 0.88).

% Extraction (The weight of the "dead weight" coffin and Bloom's thoughts on his own plot)
narrative_ontology:measurement(uh_ex_t0, ulysses_hades_1904, base_extractiveness, 0, 0.40).
narrative_ontology:measurement(uh_ex_t5, ulysses_hades_1904, base_extractiveness, 5, 0.45).
narrative_ontology:measurement(uh_ex_t10, ulysses_hades_1904, base_extractiveness, 10, 0.49).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: ulysses_aeolus_1904
% ============================================================================
% Version: 3.4 (Deferential Realism Core)
% Logic: 3.3 (Indexed Tuple P,T,E,S)
% Generated: 2026-02-06
% ============================================================================

:- module(constraint_ulysses_aeolus, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: ulysses_aeolus_1904
 * human_readable: The Rhetorical Press (Aeolus)
 * domain: technological/social/political
 * * SUMMARY:
 * Leopold Bloom navigates the "clanking drums" of the Freeman's Journal office, 
 * attempting to coordinate a simple advertisement renewal. He is caught 
 * between the irreducible Mountain of the machines and the high-theater 
 * Snare of rhetorical bombast from Myles Crawford and the "windbag" orators.
 * * KEY AGENTS:
 * - Leopold Bloom: Subject (Powerless) - Rebuffed by the "K.M.R.I.A." response.
 * - Myles Crawford: Beneficiary (Institutional) - Controlling the "pressgang".
 * - Professor MacHugh: Auditor (Analytical) - Observing the "divine afflatus".
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(ulysses_aeolus_1904, 0.51). % High due to Bloom's rejected labor.
domain_priors:suppression_score(ulysses_aeolus_1904, 0.75).   % The "nightmare" of mechanical rhythm.
domain_priors:theater_ratio(ulysses_aeolus_1904, 0.85).      % High bombast: "divine afflatus" and headlines.

% Primary keys for classification engine
narrative_ontology:constraint_metric(ulysses_aeolus_1904, extractiveness, 0.51).
narrative_ontology:constraint_metric(ulysses_aeolus_1904, suppression_requirement, 0.75).
narrative_ontology:constraint_metric(ulysses_aeolus_1904, theater_ratio, 0.85).

% Structural Property Declarations
narrative_ontology:constraint_beneficiary(ulysses_aeolus_1904, press_institution). % Daily circulation.
narrative_ontology:constraint_victim(ulysses_aeolus_1904, leopold_bloom).          % The rejected canvasser.
domain_priors:requires_active_enforcement(ulysses_aeolus_1904). % The editor's "Begone!" and yelling newsboys.

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   ========================================================================== */

% PERSPECTIVE 1: LEOPOLD BLOOM (SNARE)
% Effective Extraction: 0.51 * 1.5 (powerless) * 1.0 (national) = 0.765.
% Perceived as a "hurricane" of noise and personal humiliation.
constraint_indexing:constraint_classification(ulysses_aeolus_1904, snare, 
    context(agent_power(powerless), 
            time_horizon(biographical), 
            exit_options(trapped), 
            spatial_scope(national))).

% PERSPECTIVE 2: THE EDITOR (ROPE)
% Effective Extraction: 0.51 * -0.2 (institutional) * 1.0 = -0.102.
% Viewed as the essential "workaday worker tack" of a great daily organ.
constraint_indexing:constraint_classification(ulysses_aeolus_1904, rope, 
    context(agent_power(institutional), 
            time_horizon(generational), 
            exit_options(mobile), 
            spatial_scope(national))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (PITON)
% Extreme Theater Ratio (0.85) suggests a Piton of "lost causes" and "cloaquae".
constraint_indexing:constraint_classification(ulysses_aeolus_1904, piton,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(ulysses_aeolus_1904_tests).

test(perspectival_gap) :-
    % Verify shift from the Snare of rejection to the Rope of institutional function.
    constraint_indexing:constraint_classification(ulysses_aeolus_1904, snare, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(ulysses_aeolus_1904, rope, context(agent_power(institutional), _, _, _)).

test(piton_theater_validation) :-
    % Piton classification requires theater_ratio >= 0.70.
    domain_priors:theater_ratio(ulysses_aeolus_1904, TR),
    TR >= 0.70.

:- end_tests(ulysses_aeolus_1904_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * Leopold Bloom experiences the press as a Tangled Rope—it coordinates the 
 * " Hibernian Metropolis" through its trams and mailcars, yet it extracts 
 * his social sovereignty[cite: 4718, 4722]. The high Theater Ratio (0.85) 
 * is driven by the "mummery" of letters and the "inflated windbag" oratory 
 * of Dan Dawson and John F. Taylor[cite: 4867, 5085]. Crawford’s 
 * "K.M.R.I.A." (Kiss My Royal Irish Arse) is the definitive marker of 
 * asymmetric extraction felt by the powerless agent[cite: 5174].
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_aeolian_agency,
    "Is the editor's rejection a Rope of editorial standards or a Snare of personal malice?",
    "Review of the 'Canada swindle' and 'Ontario' references.",
    "Editorial standard confirms a Rope; malice hardens the Snare.",
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

narrative_ontology:interval(ulysses_aeolus_1904, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Theater Ratio (Peaking during the 'Pisgah Sight of Palestine' and Taylor's speech)
narrative_ontology:measurement(ua_tr_t0, ulysses_aeolus_1904, theater_ratio, 0, 0.72).
narrative_ontology:measurement(ua_tr_t5, ulysses_aeolus_1904, theater_ratio, 5, 0.90).
narrative_ontology:measurement(ua_tr_t10, ulysses_aeolus_1904, theater_ratio, 10, 0.85).

% Extraction (Increasing as Bloom is chased by newsboys and rebuffed by Crawford)
narrative_ontology:measurement(ua_ex_t0, ulysses_aeolus_1904, base_extractiveness, 0, 0.42).
narrative_ontology:measurement(ua_ex_t5, ulysses_aeolus_1904, base_extractiveness, 5, 0.48).
narrative_ontology:measurement(ua_ex_t10, ulysses_aeolus_1904, base_extractiveness, 10, 0.51).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: ulysses_lestrygonians_1904
% ============================================================================
% Version: 3.4 (Deferential Realism Core)
% Logic: 3.3 (Indexed Tuple P,T,E,S)
% Generated: 2026-02-06
% ============================================================================

:- module(constraint_ulysses_lestrygonians, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: ulysses_lestrygonians_1904
 * human_readable: The Lestrygonian Food Chain (Lunchtime Dublin)
 * domain: social/economic/biological
 * * SUMMARY:
 * Leopold Bloom wanders Dublin at lunchtime, contemplating the "predatory" 
 * nature of existence. He views the social and biological requirement of 
 * eating as a Snare where the "Burton" diners wolf down food like animals, 
 * while institutions use the "Blood of the Lamb" and "Plumtree's Potted Meat" 
 * as Ropes of social and religious coordination.
 * * KEY AGENTS:
 * - Leopold Bloom: Subject (Powerless) - Avoiding the "worst man in Dublin".
 * - The Lestrygonians (Burton Diners): Beneficiary (Institutional) - Wolfing down "gory meat".
 * - The Y.M.C.A. Man: Auditor (Analytical) - Distributing "Blood of the Lamb" throwaways.
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(ulysses_lestrygonians_1904, 0.50). % High predatory extraction.
domain_priors:suppression_score(ulysses_lestrygonians_1904, 0.80).   % Biological necessity of hunger.
domain_priors:theater_ratio(ulysses_lestrygonians_1904, 0.75).      % High social mummery/advertising.

% Primary keys for classification engine
narrative_ontology:constraint_metric(ulysses_lestrygonians_1904, extractiveness, 0.50).
narrative_ontology:constraint_metric(ulysses_lestrygonians_1904, suppression_requirement, 0.80).
narrative_ontology:constraint_metric(ulysses_lestrygonians_1904, theater_ratio, 0.75).

% Structural Property Declarations
narrative_ontology:constraint_beneficiary(ulysses_lestrygonians_1904, social_hierarchy).
narrative_ontology:constraint_victim(ulysses_lestrygonians_1904, leopold_bloom).
domain_priors:requires_active_enforcement(ulysses_lestrygonians_1904). % The "enforced" manners of the Burton.

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   ========================================================================== */

% PERSPECTIVE 1: THE HUNGRY SUBJECT (SNARE)
% Effective Extraction: 0.50 * 1.5 (powerless) * 0.8 (local) = 0.60.
% Bloom perceives the Burton restaurant as a predatory trap of "stinking" food.
constraint_indexing:constraint_classification(ulysses_lestrygonians_1904, snare, 
    context(agent_power(powerless), 
            time_horizon(biographical), 
            exit_options(trapped), 
            spatial_scope(local))).

% PERSPECTIVE 2: THE INSTITUTIONAL DINER (ROPE)
% Effective Extraction: 0.50 * -0.2 (institutional) * 0.8 = -0.08.
% Viewed as the essential "nourishment" and coordination of the "Great Daily Organ".
constraint_indexing:constraint_classification(ulysses_lestrygonians_1904, rope, 
    context(agent_power(institutional), 
            time_horizon(generational), 
            exit_options(mobile), 
            spatial_scope(local))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (PITON)
% Extreme Theater Ratio (0.75) indicates a Piton of atrophied social "respectability."
constraint_indexing:constraint_classification(ulysses_lestrygonians_1904, piton,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(ulysses_lestrygonians_1904_tests).

test(perspectival_gap) :-
    % Verify the shift from Snare (Bloom's disgust) to Rope (Social function).
    constraint_indexing:constraint_classification(ulysses_lestrygonians_1904, TypePowerless, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(ulysses_lestrygonians_1904, TypeInstitutional, context(agent_power(institutional), _, _, _)),
    TypePowerless \= TypeInstitutional.

test(piton_theater_check) :-
    % Piton classification requires theater_ratio >= 0.70.
    domain_priors:theater_ratio(ulysses_lestrygonians_1904, TR),
    TR >= 0.70.

:- end_tests(ulysses_lestrygonians_1904_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * Leopold Bloom experiences lunchtime as the "Lestrygonian Snare." While 
 * the city coordinates around the lunch hour (Rope), Bloom sees the 
 * "cannibalistic" extraction of the Burton diners—"men, men, men" bolting 
 * down "gory meat". The high Theater Ratio (0.75) reflects the 
 * performative nature of social dining and advertisements like 
 * "Plumtree's Potted Meat" which mask the irreducible Mountain of 
 * biological hunger and death.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_biological_snare,
    "Is 'social dining' a Rope of civilizational progress or a Snare of animal regression?",
    "Review of the 'Burton' vs 'Davy Byrne's' dining modalities.",
    "Temperance confirms a Rope; 'wolfing' hardens the Snare.",
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

narrative_ontology:interval(ulysses_lestrygonians_1904, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Theater Ratio (Peaking as social etiquette is abandoned at the Burton)
narrative_ontology:measurement(ul_tr_t0, ulysses_lestrygonians_1904, theater_ratio, 0, 0.60).
narrative_ontology:measurement(ul_tr_t5, ulysses_lestrygonians_1904, theater_ratio, 5, 0.85).
narrative_ontology:measurement(ul_tr_t10, ulysses_lestrygonians_1904, theater_ratio, 10, 0.75).

% Extraction (Increasing as the "predatory" lunch hour intensifies)
narrative_ontology:measurement(ul_ex_t0, ulysses_lestrygonians_1904, base_extractiveness, 0, 0.35).
narrative_ontology:measurement(ul_ex_t5, ulysses_lestrygonians_1904, base_extractiveness, 5, 0.45).
narrative_ontology:measurement(ul_ex_t10, ulysses_lestrygonians_1904, base_extractiveness, 10, 0.50).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: ulysses_scylla_1904
% ============================================================================
% Version: 3.4 (Deferential Realism Core)
% Logic: 3.3 (Indexed Tuple P,T,E,S)
% Generated: 2026-02-06
% ============================================================================

:- module(constraint_ulysses_scylla, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: ulysses_scylla_1904
 * human_readable: The Hamlet Algebra (National Library)
 * domain: social/religious/philosophical
 * * SUMMARY:
 * Stephen Dedalus performs his elaborate "Hamlet" theory in the National 
 * Library, navigating between the Scylla of Aristotelian dogmatic realism 
 * and the Charybdis of Platonic mysticism[cite: 7009, 6807]. The library 
 * functions as a Piton of atrophied intellectualism, while Stephen’s theory 
 * serves as a personal Scaffold for his artistic identity, even as his 
 * auditors perceive it as a Snare of "perverted ingenuity"[cite: 7948].
 * * KEY AGENTS:
 * - Stephen Dedalus: Subject (Powerless) - The "horrible example of free thought"[cite: 6719].
 * - John Eglinton: Beneficiary (Institutional) - The "elder's gall" challenging the bard[cite: 7948].
 * - The Quaker Librarian: Auditor (Analytical) - Purring "urbane" comfort[cite: 7948].
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(ulysses_scylla_1904, 0.50). % High spiritual/intellectual labor[cite: 6525].
domain_priors:suppression_score(ulysses_scylla_1904, 0.70).   % The "mummery" of letters and tradition.
domain_priors:theater_ratio(ulysses_scylla_1904, 0.90).      % Peak performance: "Shakespeare's ghost".

% Primary keys for classification engine
narrative_ontology:constraint_metric(ulysses_scylla_1904, extractiveness, 0.50).
narrative_ontology:constraint_metric(ulysses_scylla_1904, suppression_requirement, 0.70).
narrative_ontology:constraint_metric(ulysses_scylla_1904, theater_ratio, 0.90).

% Structural Property Declarations
narrative_ontology:constraint_beneficiary(ulysses_scylla_1904, dublin_intelligentsia). % Coordination of culture[cite: 7948].
narrative_ontology:constraint_victim(ulysses_scylla_1904, stephen_dedalus).           % The rejected "bard"[cite: 6480].
domain_priors:requires_active_enforcement(ulysses_scylla_1904). % The "gall" of John Eglinton[cite: 7948].
narrative_ontology:has_sunset_clause(ulysses_scylla_1904).     % Stephen's theory is a temporary "movement".

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   ========================================================================== */

% PERSPECTIVE 1: STEPHEN DEDALUS (SNARE)
% Effective Extraction: 0.50 * 1.5 (powerless) * 0.8 (local) = 0.60.
% Perceived as a trap of "toothless terrors" and social mockery[cite: 6998, 6429].
constraint_indexing:constraint_classification(ulysses_scylla_1904, snare, 
    context(agent_power(powerless), 
            time_horizon(biographical), 
            exit_options(trapped), 
            spatial_scope(local))).

% PERSPECTIVE 2: THE LITERARY CIRCLE (ROPE)
% Effective Extraction: 0.50 * -0.2 (institutional) * 0.8 = -0.08.
% Viewed as the essential coordination of "priceless pages" and debate[cite: 7948].
constraint_indexing:constraint_classification(ulysses_scylla_1904, rope, 
    context(agent_power(institutional), 
            time_horizon(generational), 
            exit_options(mobile), 
            spatial_scope(local))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (PITON)
% Extreme Theater Ratio (0.90) indicates a Piton of "vanished crowds" and mummery[cite: 6927].
constraint_indexing:constraint_classification(ulysses_scylla_1904, piton,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

% PERSPECTIVE 4: THE CREATIVE ARCHITECT (SCAFFOLD)
% The "Hamlet" theory is a temporary support for artistic birth.
constraint_indexing:constraint_classification(ulysses_scylla_1904, scaffold,
    context(agent_power(organized),
            time_horizon(generational),
            exit_options(constrained),
            spatial_scope(national))) :-
    narrative_ontology:has_sunset_clause(ulysses_scylla_1904).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(ulysses_scylla_1904_tests).

test(perspectival_gap) :-
    % Verify shift from the Snare of Stephen's isolation to the Rope of culture.
    constraint_indexing:constraint_classification(ulysses_scylla_1904, snare, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(ulysses_scylla_1904, rope, context(agent_power(institutional), _, _, _)).

test(piton_theater_validation) :-
    % Piton classification requires theater_ratio >= 0.70.
    domain_priors:theater_ratio(ulysses_scylla_1904, TR),
    TR >= 0.70.

:- end_tests(ulysses_scylla_1904_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * Stephen Dedalus experiences the National Library as a Scylla-and-Charybdis 
 * Snare—a predatory trap of intellectual "mummery" where his theory is 
 * used to extract his spiritual energy for the entertainment of "swine"[cite: 6494]. 
 * Conversely, the librarians perceive it as a Rope of coordination, 
 * a "sea of troubles" navigated through "priceless pages" of Meister[cite: 7948]. 
 * The high Theater Ratio (0.90) is the defining feature; Stephen proves 
 * by "algebra" that Shakespeare is his own father's ghost, a performance 
 * that anchors his identity (Scaffold) while serving as a spectacular 
 * atrophied function (Piton) for the Dublin circle[cite: 6847, 6927].
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_intellectual_paternity,
    "Is Stephen's theory a Rope for his own artistic birth or a Snare of solipsism?",
    "Review of the 'word known to all men' vs the 'mummery of letters'[cite: 7258, 6849].",
    "Creative birth confirms a Rope; 'phantasmal mirth' hardens the Snare[cite: 6545].",
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

narrative_ontology:interval(ulysses_scylla_1904, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Theater Ratio (Peaking during the climax of the Shakespearean proof)
narrative_ontology:measurement(us_tr_t0, ulysses_scylla_1904, theater_ratio, 0, 0.75).
narrative_ontology:measurement(us_tr_t5, ulysses_scylla_1904, theater_ratio, 5, 0.95).
narrative_ontology:measurement(us_tr_t10, ulysses_scylla_1904, theater_ratio, 10, 0.90).

% Extraction (The weight of Stephen's spiritual "debt" and creative labor)
narrative_ontology:measurement(us_ex_t0, ulysses_scylla_1904, base_extractiveness, 0, 0.40).
narrative_ontology:measurement(us_ex_t5, ulysses_scylla_1904, base_extractiveness, 5, 0.55).
narrative_ontology:measurement(us_ex_t10, ulysses_scylla_1904, base_extractiveness, 10, 0.50).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: ulysses_rocks_1904
% ============================================================================
% Version: 3.4 (Deferential Realism Core)
% Logic: 3.3 (Indexed Tuple P,T,E,S)
% Generated: 2026-02-06
% ============================================================================

:- module(constraint_ulysses_rocks, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: ulysses_rocks_1904
 * human_readable: The Dublin Simultaneity (Wandering Rocks)
 * domain: social/political/religious
 * * SUMMARY:
 * Chapter 10 models Dublin as a complex system of simultaneous movements and 
 * near-misses. The city acts as a Tangled Rope of coordination, where the 
 * progress of the Viceregal cavalcade and Father Conmee provides a 
 * structural floor for the diverse inhabitants, even as it extracts 
 * their attention and social deference through a high theater of 
 * colonial and religious "pomp".
 * * KEY AGENTS:
 * - Dublin Inhabitants: Subject (Powerless) - Navigating the city's 
 * "short circuits" and coincidences.
 * - The Viceregal Cavalcade: Beneficiary (Institutional) - Representing 
 * the imperial "pomp" and coordination of the state.
 * - Father Conmee: Auditor (Analytical) - Observing and blessing 
 * the city's movements while managing his own errands.
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(ulysses_rocks_1904, 0.48). 
domain_priors:suppression_score(ulysses_rocks_1904, 0.75).   
domain_priors:theater_ratio(ulysses_rocks_1904, 0.82). % High "pomp": viceregal salutes and blessings.

% Primary keys for classification engine
narrative_ontology:constraint_metric(ulysses_rocks_1904, extractiveness, 0.48).
narrative_ontology:constraint_metric(ulysses_rocks_1904, suppression_requirement, 0.75).
narrative_ontology:constraint_metric(ulysses_rocks_1904, theater_ratio, 0.82).

% Structural Property Declarations
narrative_ontology:constraint_beneficiary(ulysses_rocks_1904, colonial_and_church_authorities).
narrative_ontology:constraint_victim(ulysses_rocks_1904, dublin_citizens).
domain_priors:requires_active_enforcement(ulysses_rocks_1904). % The "timekeeper" and "bawled" tram departures.

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   ========================================================================== */

% PERSPECTIVE 1: THE DUBLIN CITIZEN (SNARE)
% Effective Extraction: 0.48 * 1.5 (powerless) * 0.8 (local) = 0.576.
% Perceived as a "short circuit" trap of coincidences and "stale" social debts.
constraint_indexing:constraint_classification(ulysses_rocks_1904, snare, 
    context(agent_power(powerless), 
            time_horizon(biographical), 
            exit_options(trapped), 
            spatial_scope(local))).

% PERSPECTIVE 2: THE VICEREGAL AUTHORITY (ROPE)
% Effective Extraction: 0.48 * -0.2 (institutional) * 0.8 = -0.0768.
% Viewed as the essential coordination of the "inauguration" and city "order".
constraint_indexing:constraint_classification(ulysses_rocks_1904, rope, 
    context(agent_power(institutional), 
            time_horizon(generational), 
            exit_options(mobile), 
            spatial_scope(local))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (PITON)
% Extreme Theater Ratio (0.82) indicates a Piton of "punctual salutes" and mummery.
constraint_indexing:constraint_classification(ulysses_rocks_1904, piton,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(ulysses_rocks_1904_tests).

test(perspectival_gap) :-
    % Verify shift from Snare (Citizen) to Rope (Authority).
    constraint_indexing:constraint_classification(ulysses_rocks_1904, snare, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(ulysses_rocks_1904, rope, context(agent_power(institutional), _, _, _)).

test(piton_theater_check) :-
    % Piton classification requires theater_ratio >= 0.70.
    domain_priors:theater_ratio(ulysses_rocks_1904, TR),
    TR >= 0.70.

:- end_tests(ulysses_rocks_1904_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * The Dubliners experience the city's simultaneity as a Tangled Rope—it 
 * coordinates their disparate lives through the "Great Daily Organ" of 
 * shared space, yet it extracts their social deference through the "pomp" 
 * of authority. The high Theater Ratio (0.82) is driven by the 
 * "punctual salutes" of Master Patrick Aloysius Dignam and the "very 
 * reverend" John Conmee's blessings. These performative Ropes 
 * mask the atrophied function of the "becalmed" short circuits 
 * where citizens like the "onelegged sailor" are "pauperized".
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_city_simultaneity,
    "Is the 'shifting' coordination of the city a Rope for social unity or a Snare of surveillance?",
    "Review of the 'blind stripling' vs the 'cavalcade' progress.",
    "Unity confirms a Rope; 'short circuit' surveillance hardens the Snare.",
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

narrative_ontology:interval(ulysses_rocks_1904, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Theater Ratio (Peaking as the viceroy acknowledges salutes through the city)
narrative_ontology:measurement(ur_tr_t0, ulysses_rocks_1904, theater_ratio, 0, 0.65).
narrative_ontology:measurement(ur_tr_t5, ulysses_rocks_1904, theater_ratio, 5, 0.88).
narrative_ontology:measurement(ur_tr_t10, ulysses_rocks_1904, theater_ratio, 10, 0.82).

% Extraction (Increasing as the "short circuit" of urban coincidences accumulates)
narrative_ontology:measurement(ur_ex_t0, ulysses_rocks_1904, base_extractiveness, 0, 0.38).
narrative_ontology:measurement(ur_ex_t5, ulysses_rocks_1904, base_extractiveness, 5, 0.45).
narrative_ontology:measurement(ur_ex_t10, ulysses_rocks_1904, base_extractiveness, 10, 0.48).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: ulysses_sirens_1904
% ============================================================================
% Version: 3.4 (Deferential Realism Core)
% Logic: 3.3 (Indexed Tuple P,T,E,S)
% Generated: 2026-02-06
% ============================================================================

:- module(constraint_ulysses_sirens, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: ulysses_sirens_1904
 * human_readable: The Auditory Lure (Ormond Hotel)
 * domain: social/artistic/biological
 * * SUMMARY:
 * Chapter 11 models the Ormond Hotel bar as a complex auditory system. 
 * The music and the flirtatious "Sirens" act as a Rope of coordination 
 * for the bar patrons, while for Leopold Bloom, they form a Snare 
 * of "longindying" calls and psychological extraction as he dwells 
 * on his loneliness and Molly's infidelity.
 * * KEY AGENTS:
 * - Leopold Bloom: Subject (Powerless) - "So lonely blooming" while eating grease. 
 * - Lydia Douce & Mina Kennedy: Beneficiary (Institutional) - The trilling barmaids. 
 * - The Stripling: Auditor (Analytical) - The unseeing presence tapping at the door. 
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds [cite: 12]
domain_priors:base_extractiveness(ulysses_sirens_1904, 0.53). % High psychological cost.
domain_priors:suppression_score(ulysses_sirens_1904, 0.82).   % Auditory seduce-and-suppress.
domain_priors:theater_ratio(ulysses_sirens_1904, 0.89).      % Peak "mummery" of sound.

% Primary keys for classification engine [cite: 12]
narrative_ontology:constraint_metric(ulysses_sirens_1904, extractiveness, 0.53).
narrative_ontology:constraint_metric(ulysses_sirens_1904, suppression_requirement, 0.82).
narrative_ontology:constraint_metric(ulysses_sirens_1904, theater_ratio, 0.89).

% Structural Property Declarations
narrative_ontology:constraint_beneficiary(ulysses_sirens_1904, the_sirens). % Lydia and Mina trilling.
narrative_ontology:constraint_victim(ulysses_sirens_1904, leopold_bloom).   % Trapped in sad blooming.
domain_priors:requires_active_enforcement(ulysses_sirens_1904). % The piano's "War! War!". 

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   ========================================================================== */

% PERSPECTIVE 1: THE LONELY SUBJECT (SNARE)
% Effective Extraction: 0.53 * 1.5 (powerless) * 0.8 (local) = 0.636.
% Bloom perceives the music as a "decoy" and a trap of "lost" notes. 
constraint_indexing:constraint_classification(ulysses_sirens_1904, snare, 
    context(agent_power(powerless), 
            time_horizon(biographical), 
            exit_options(trapped), 
            spatial_scope(local))).

% PERSPECTIVE 2: THE BARMAID (ROPE)
% Effective Extraction: 0.53 * -0.2 (institutional) * 0.8 = -0.0848.
% Viewed as the "clinking" coordination of service and "peepofgold". 
constraint_indexing:constraint_classification(ulysses_sirens_1904, rope, 
    context(agent_power(institutional), 
            time_horizon(generational), 
            exit_options(mobile), 
            spatial_scope(local))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (PITON)
% Extreme Theater Ratio (0.89) indicates a Piton of atrophied social function.
constraint_indexing:constraint_classification(ulysses_sirens_1904, piton,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(ulysses_sirens_1904_tests).

test(perspectival_gap) :-
    % Verify shift from Snare (Bloom) to Rope (Sirens). [cite: 13]
    constraint_indexing:constraint_classification(ulysses_sirens_1904, snare, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(ulysses_sirens_1904, rope, context(agent_power(institutional), _, _, _)).

test(piton_theater_check) :-
    % Piton classification requires theater_ratio >= 0.70. [cite: 13]
    domain_priors:theater_ratio(ulysses_sirens_1904, TR),
    TR >= 0.70.

:- end_tests(ulysses_sirens_1904_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * Leopold Bloom experiences the Ormond bar as an auditory Snare—a site 
 * where the "throb" of the music and the "trilling" of barmaids extracts 
 * his emotional equilibrium. The high Theater Ratio (0.89) is the 
 * defining property; the chapter is a "fugue" of onomatopoeia 
 * ("Imperthnthn thnthnthn") that creates a spectacular performance  
 * masking the atrophied function of genuine human connection.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_auditory_entrapment,
    "Is the 'pure, long and throbbing' call a Rope for beauty or a Snare for the soul?",
    "Analysis of the 'decoy' effect vs the 'last rose of summer' resolution.",
    "Beauty confirms a Rope; 'alluring' entrapment hardens the Snare.",
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

narrative_ontology:interval(ulysses_sirens_1904, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Theater Ratio (Peaking as the music and trilling intensify toward the end) [cite: 12]
narrative_ontology:measurement(us_tr_t0, ulysses_sirens_1904, theater_ratio, 0, 0.75).
narrative_ontology:measurement(us_tr_t5, ulysses_sirens_1904, theater_ratio, 5, 0.92).
narrative_ontology:measurement(us_tr_t10, ulysses_sirens_1904, theater_ratio, 10, 0.89).

% Extraction (Bloom's psychological fatigue accumulating with the piano chords) [cite: 12]
narrative_ontology:measurement(us_ex_t0, ulysses_sirens_1904, base_extractiveness, 0, 0.40).
narrative_ontology:measurement(us_ex_t5, ulysses_sirens_1904, base_extractiveness, 5, 0.48).
narrative_ontology:measurement(us_ex_t10, ulysses_sirens_1904, base_extractiveness, 10, 0.53).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: ulysses_cyclops_1904
% ============================================================================
% Version: 3.4 (Deferential Realism Core)
% Logic: 3.3 (Indexed Tuple P,T,E,S)
% Generated: 2026-02-06
% ============================================================================

:- module(constraint_ulysses_cyclops, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: ulysses_cyclops_1904
 * human_readable: The Cyclopean Snare (Barney Kiernan's Pub)
 * domain: social/political/nationalist
 * * SUMMARY:
 * Leopold Bloom enters Barney Kiernan's pub, a site of fierce nationalist 
 * fervor led by "The Citizen." The social environment functions as a Rope 
 * of coordination for the "true men," but becomes a Snare of xenophobic 
 * extraction for Bloom, culminating in a literal assault with a biscuit 
 * tin. The narrative is defined by "Gigantism"—hyperbolic parodies that 
 * create a peak Theater Ratio.
 * * KEY AGENTS:
 * - Leopold Bloom: Subject (Powerless) - The "walking jew" in the lion's den.
 * - The Citizen: Beneficiary (Institutional) - The "huge asphodel" of Irish nationalism.
 * - The Nameless Narrator: Auditor (Analytical) - The cynical debt collector 
 * observing the "bloody big foxy thief."
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(ulysses_cyclops_1904, 0.54). % Highest extraction via physical threat.
domain_priors:suppression_score(ulysses_cyclops_1904, 0.88).   % Mono-vision (Cyclops) of nationalism.
domain_priors:theater_ratio(ulysses_cyclops_1904, 0.92).      % Peak "Gigantism" and parodic theater.

% Primary keys for classification engine
narrative_ontology:constraint_metric(ulysses_cyclops_1904, extractiveness, 0.54).
narrative_ontology:constraint_metric(ulysses_cyclops_1904, suppression_requirement, 0.88).
narrative_ontology:constraint_metric(ulysses_cyclops_1904, theater_ratio, 0.92).

% Structural Property Declarations
narrative_ontology:constraint_beneficiary(ulysses_cyclops_1904, irish_nationalism).
narrative_ontology:constraint_victim(ulysses_cyclops_1904, leopold_bloom).
domain_priors:requires_active_enforcement(ulysses_cyclops_1904). % The Citizen's shouting and Garryowen's growling.

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   ========================================================================== */

% PERSPECTIVE 1: LEOPOLD BLOOM (SNARE)
% Effective Extraction: 0.54 * 1.5 (powerless) * 0.8 (local) = 0.648.
% Perceived as a predatory trap of "malediction" and the "shouts of the mob."
constraint_indexing:constraint_classification(ulysses_cyclops_1904, snare, 
    context(agent_power(powerless), 
            time_horizon(biographical), 
            exit_options(trapped), 
            spatial_scope(local))).

% PERSPECTIVE 2: THE CITIZEN (ROPE)
% Effective Extraction: 0.54 * -0.2 (institutional) * 0.8 = -0.0864.
% Viewed as the essential coordination of "Sinn Fein" and "Ireland for the Irish."
constraint_indexing:constraint_classification(ulysses_cyclops_1904, rope, 
    context(agent_power(institutional), 
            time_horizon(generational), 
            exit_options(mobile), 
            spatial_scope(local))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (PITON)
% Extreme Theater Ratio (0.92) indicates a Piton of "epic" mummery.
constraint_indexing:constraint_classification(ulysses_cyclops_1904, piton,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(ulysses_cyclops_1904_tests).

test(perspectival_gap) :-
    % Verify shift from Snare (Bloom) to Rope (Nationalists).
    constraint_indexing:constraint_classification(ulysses_cyclops_1904, snare, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(ulysses_cyclops_1904, rope, context(agent_power(institutional), _, _, _)).

test(piton_theater_check) :-
    % Piton classification requires theater_ratio >= 0.70.
    domain_priors:theater_ratio(ulysses_cyclops_1904, TR),
    TR >= 0.70.

:- end_tests(ulysses_cyclops_1904_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * Leopold Bloom experiences the pub as a violent Snare—a site where his 
 * identity extracts physical and social safety. The high Theater Ratio 
 * (0.92) is the defining property of the "Cyclops" mode; the chapter is 
 * interrupted by massive, parodic interpolations of legal, scientific, 
 * and medieval styles that create a spectacular performance masking 
 * the atrophied function of the drunken "heroes." The Citizen’s 
 * biscuit tin assault is the final "Rope" of exclusionary 
 * coordination that forces Bloom’s "Elijah-like" exit.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_elijah_transfiguration,
    "Is Bloom's exit a Rope of spiritual transcendence or a Snare of panicked flight?",
    "Review of the 'great brightness' vs the 'furious driving' of the jarvey.",
    "Transcendence confirms a Rope; flight hardens the Snare.",
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

narrative_ontology:interval(ulysses_cyclops_1904, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Theater Ratio (Peaking during the 'Gigantism' lists and the final transfiguration)
narrative_ontology:measurement(uc_tr_t0, ulysses_cyclops_1904, theater_ratio, 0, 0.70).
narrative_ontology:measurement(uc_tr_t5, ulysses_cyclops_1904, theater_ratio, 5, 0.95).
narrative_ontology:measurement(uc_tr_t10, ulysses_cyclops_1904, theater_ratio, 10, 0.92).

% Extraction (Increasing as the nationalist rhetoric turns toward physical threat)
narrative_ontology:measurement(uc_ex_t0, ulysses_cyclops_1904, base_extractiveness, 0, 0.40).
narrative_ontology:measurement(uc_ex_t5, ulysses_cyclops_1904, base_extractiveness, 5, 0.50).
narrative_ontology:measurement(uc_ex_t10, ulysses_cyclops_1904, base_extractiveness, 10, 0.54).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: ulysses_nausicaa_1904
% ============================================================================
% Version: 3.4 (Deferential Realism Core)
% Logic: 3.3 (Indexed Tuple P,T,E,S)
% Generated: 2026-02-06
% ============================================================================

:- module(constraint_ulysses_nausicaa, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: ulysses_nausicaa_1904
 * human_readable: The Sentimental Snare (Sandymount Shore)
 * domain: social/artistic/psychological
 * * SUMMARY:
 * Chapter 13 models the encounter between Gerty MacDowell and Leopold Bloom 
 * on Sandymount Strand. For Gerty, the social requirement of "maidenly 
 * grace" and romantic sentimentality functions as a Snare, extracting 
 * her self-worth through cheap novelette ideals. For Bloom, the 
 * scene is a Piton of voyeuristic mummery, ending with the mocking 
 * "Cuckoo" of a clock that marks his cuckoldry.
 * * KEY AGENTS:
 * - Gerty MacDowell: Subject (Powerless) - Trapped in her "limp" and romantic "dream"[cite: 7013, 7015].
 * - Leopold Bloom: Auditor (Analytical) - The "foreign gentleman" watching from the rocks[cite: 7013, 7015].
 * - The Church: Beneficiary (Institutional) - The "Star of the Sea" providing a background of "pure radiance".
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(ulysses_nausicaa_1904, 0.49). % High emotional extraction/delusion.
domain_priors:suppression_score(ulysses_nausicaa_1904, 0.75).   % Social mores and Gerty's physical "secret".
domain_priors:theater_ratio(ulysses_nausicaa_1904, 0.88).      % Peak sentimentality: "mysterious embrace" and "lovingly".

% Primary keys for classification engine
narrative_ontology:constraint_metric(ulysses_nausicaa_1904, extractiveness, 0.49).
narrative_ontology:constraint_metric(ulysses_nausicaa_1904, suppression_requirement, 0.75).
narrative_ontology:constraint_metric(ulysses_nausicaa_1904, theater_ratio, 0.88).

% Structural Property Declarations
narrative_ontology:constraint_beneficiary(ulysses_nausicaa_1904, sentimental_press). % Novelettes and magazines.
narrative_ontology:constraint_victim(ulysses_nausicaa_1904, gerty_macdowell).        % The "girl friend" in the "favourite nook".
domain_priors:requires_active_enforcement(ulysses_nausicaa_1904). % The "cuckoo" clock and social shame.

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   ========================================================================== */

% PERSPECTIVE 1: GERTY MACDOWELL (SNARE)
% Effective Extraction: 0.49 * 1.5 (powerless) * 0.8 (local) = 0.588.
% Perceived as a "mysterious embrace" that is actually a trap of physical and social limitation.
constraint_indexing:constraint_classification(ulysses_nausicaa_1904, snare, 
    context(agent_power(powerless), 
            time_horizon(biographical), 
            exit_options(trapped), 
            spatial_scope(local))).

% PERSPECTIVE 2: THE CHURCH/ST. MARY'S (ROPE)
% Effective Extraction: 0.49 * -0.2 (institutional) * 0.8 = -0.0784.
% Viewed as the essential coordination of "the voice of prayer" and a "beacon" for man.
constraint_indexing:constraint_classification(ulysses_nausicaa_1904, rope, 
    context(agent_power(institutional), 
            time_horizon(generational), 
            exit_options(mobile), 
            spatial_scope(local))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (PITON)
% Extreme Theater Ratio (0.88) indicates a Piton of atrophied romantic function.
constraint_indexing:constraint_classification(ulysses_nausicaa_1904, piton,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(ulysses_nausicaa_1904_tests).

test(perspectival_gap) :-
    % Verify the shift from Gerty's Snare to the Church's Rope.
    constraint_indexing:constraint_classification(ulysses_nausicaa_1904, snare, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(ulysses_nausicaa_1904, rope, context(agent_power(institutional), _, _, _)).

test(piton_theater_validation) :-
    % Piton classification requires theater_ratio >= 0.70.
    domain_priors:theater_ratio(ulysses_nausicaa_1904, TR),
    TR >= 0.70.

:- end_tests(ulysses_nausicaa_1904_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * Gerty MacDowell experiences the shore as a Sentimental Snare—a site 
 * where the "mysterious embrace" of the evening masks her social and physical 
 * "trapped" status[cite: 7013, 7015]. The high Theater Ratio (0.88) is 
 * driven by the first half of the chapter's "mummery" of flowery prose, which 
 * mimics the novelettes Gerty reads. The final "Cuckoo" of the 
 * clock  serves as the Piton's chime, signaling the atrophied 
 * reality of Bloom's marriage and Gerty's romantic hopes.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_sentimental_truth,
    "Is Gerty's 'dream' a Rope for social hope or a Snare of self-deception?",
    "Review of the 'foreign gentleman's' gaze vs her physical 'limp'.",
    "Hope-coordination confirms a Rope; deception hardens the Snare.",
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

narrative_ontology:interval(ulysses_nausicaa_1904, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Theater Ratio (Peaking during Gerty's internal monologue and the fireworks)
narrative_ontology:measurement(un_tr_t0, ulysses_nausicaa_1904, theater_ratio, 0, 0.65).
narrative_ontology:measurement(un_tr_t5, ulysses_nausicaa_1904, theater_ratio, 5, 0.90).
narrative_ontology:measurement(un_tr_t10, ulysses_nausicaa_1904, theater_ratio, 10, 0.88).

% Extraction (Increasing as the "sentimentality" gives way to Bloom's earthier reality)
narrative_ontology:measurement(un_ex_t0, ulysses_nausicaa_1904, base_extractiveness, 0, 0.35).
narrative_ontology:measurement(un_ex_t5, ulysses_nausicaa_1904, base_extractiveness, 5, 0.45).
narrative_ontology:measurement(un_ex_t10, ulysses_nausicaa_1904, base_extractiveness, 10, 0.49).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: ulysses_oxen_1904
% ============================================================================
% Version: 3.4 (Deferential Realism Core)
% Logic: 3.3 (Indexed Tuple P,T,E,S)
% Generated: 2026-02-06
% ============================================================================

:- module(constraint_ulysses_oxen, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: ulysses_oxen_1904
 * human_readable: The Gestation Mountain (Holles Street)
 * domain: biological/linguistic/medical
 * * SUMMARY:
 * Chapter 14 models the "proliferent continuance" of life at the National 
 * Maternity Hospital. The nine-month term 
 * of gestation acts as an irreducible biological Mountain, while the 
 * evolution of the English language—parodied from Anglo-Saxon to modern 
 * slang—functions as a high-theater Piton of cultural history 
 *.
 * * KEY AGENTS:
 * - Mina Purefoy: Subject (Powerless) - Enduring the "original" evil of 
 * labor.
 * - The Medical Institution: Beneficiary (Institutional) - Coordinating 
 * the "tribute of its solicitude".
 * - The Wombfruit: Auditor (Analytical) - The "bright one, light one" 
 * moving toward birth.
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(ulysses_oxen_1904, 0.55). % High physical and spiritual labor.
domain_priors:suppression_score(ulysses_oxen_1904, 0.95).   % Biological necessity of the term.
domain_priors:theater_ratio(ulysses_oxen_1904, 0.98).      % Peak linguistic mummery.

% Primary keys for classification engine
narrative_ontology:constraint_metric(ulysses_oxen_1904, extractiveness, 0.55).
narrative_ontology:constraint_metric(ulysses_oxen_1904, suppression_requirement, 0.95).
narrative_ontology:constraint_metric(ulysses_oxen_1904, theater_ratio, 0.98).

% Structural Property Declarations
narrative_ontology:constraint_beneficiary(ulysses_oxen_1904, biological_continuance).
narrative_ontology:constraint_victim(ulysses_oxen_1904, mina_purefoy).
domain_priors:requires_active_enforcement(ulysses_oxen_1904). % The "Horhorn" quickening.

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   ========================================================================== */

% PERSPECTIVE 1: THE LABORING MOTHER (SNARE)
% Effective Extraction: 0.55 * 1.5 (powerless) * 0.8 (local) = 0.66.
% Perceived as a "lutulent reality" of pain and "downwardtending" force 
% .
constraint_indexing:constraint_classification(ulysses_oxen_1904, snare, 
    context(agent_power(powerless), 
            time_horizon(biographical), 
            exit_options(trapped), 
            spatial_scope(local))).

% PERSPECTIVE 2: THE BIOLOGICAL LAW (MOUNTAIN)
% Effective Extraction: 0.55 * -0.2 (institutional) * 1.0 = -0.11.
% The "omnipollent nature’s incorrupted benefaction" functions as a 
% structural floor.
constraint_indexing:constraint_classification(ulysses_oxen_1904, mountain, 
    context(agent_power(institutional), 
            time_horizon(civilizational), 
            exit_options(mobile), 
            spatial_scope(universal))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (PITON)
% Extreme Theater Ratio (0.98) indicates a Piton of "exterior splendour" 
% masking "lutulent reality".
constraint_indexing:constraint_classification(ulysses_oxen_1904, piton,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(ulysses_oxen_1904_tests).

test(perspectival_gap) :-
    % Verify shift from Snare (Mina) to Mountain (Biological Law).
    constraint_indexing:constraint_classification(ulysses_oxen_1904, snare, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(ulysses_oxen_1904, mountain, context(agent_power(institutional), _, _, _)).

test(piton_theater_check) :-
    % Piton classification requires theater_ratio >= 0.70.
    domain_priors:theater_ratio(ulysses_oxen_1904, TR),
    TR >= 0.70.

:- end_tests(ulysses_oxen_1904_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * The "Oxen of the Sun" models the intersection of biological and 
 * linguistic evolution. While gestation is a Mountain—an irreducible 
 * "Fixed Point" of coordination for the species—the chapter's parodic 
 * style creates a peak Theater Ratio (0.98). This "mummery" of 
 * prose masks the "original evil" of physical pain, acting as a 
 * cultural Piton where the function of language is atrophied 
 * through imitation.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_linguistic_gestation,
    "Is the evolution of the English language a Rope for human sapience or a Snare of historical repetition?",
    "Review of the 'lutulent reality' vs the 'exterior splendour' of the parodies.",
    "Sapience confirms a Rope; 'downwardtending' repetition hardens the Snare.",
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

narrative_ontology:interval(ulysses_oxen_1904, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Theater Ratio (Peaking as the parodies move from medieval to 19th-century styles)
narrative_ontology:measurement(uo_tr_t0, ulysses_oxen_1904, theater_ratio, 0, 0.85).
narrative_ontology:measurement(uo_tr_t5, ulysses_oxen_1904, theater_ratio, 5, 0.99).
narrative_ontology:measurement(uo_tr_t10, ulysses_oxen_1904, theater_ratio, 10, 0.98).

% Extraction (Accumulating with the biological progress of labor and the drunken revelry)
narrative_ontology:measurement(uo_ex_t0, ulysses_oxen_1904, base_extractiveness, 0, 0.45).
narrative_ontology:measurement(uo_ex_t5, ulysses_oxen_1904, base_extractiveness, 5, 0.52).
narrative_ontology:measurement(uo_ex_t10, ulysses_oxen_1904, base_extractiveness, 10, 0.55).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: ulysses_circe_1904
% ============================================================================
% Version: 3.4 (Deferential Realism Core)
% Logic: 3.3 (Indexed Tuple P,T,E,S)
% Generated: 2026-02-06
% ============================================================================

:- module(constraint_ulysses_circe, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: ulysses_circe_1904
 * human_readable: The Nighttown Phantasmagoria (Circe)
 * domain: social/psychological/religious
 * * SUMMARY:
 * Chapter 15 models the "Nighttown" red-light district as a site of extreme 
 * hallucinatory extraction. The environment functions as a predatory Snare 
 * where the guilt and desires of Bloom and Stephen are externalized into a 
 * "mummery" of shifting forms. Amidst 
 * this theater, Bloom’s vision of his dead son, Rudy, acts as an 
 * irreducible psychological Mountain.
 * * KEY AGENTS:
 * - Leopold Bloom: Subject (Powerless) - Standing "on guard" as a 
 * "secret master".
 * - Stephen Dedalus: Subject (Powerless) - Trembling at his "soul's cry" 
 *.
 * - The Nighttown Inhabitants: Beneficiary (Institutional) - Managing the 
 * "grimy houses" and "ice gondolas".
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(ulysses_circe_1904, 0.58). % Extreme spiritual and moral extraction.
domain_priors:suppression_score(ulysses_circe_1904, 0.90).   % The hallucinatory "entombing" of the subjects.
domain_priors:theater_ratio(ulysses_circe_1904, 0.99).      % Maximal mummery: the entire chapter is a play script.

% Primary keys for classification engine
narrative_ontology:constraint_metric(ulysses_circe_1904, extractiveness, 0.58).
narrative_ontology:constraint_metric(ulysses_circe_1904, suppression_requirement, 0.90).
narrative_ontology:constraint_metric(ulysses_circe_1904, theater_ratio, 0.99).

% Structural Property Declarations
narrative_ontology:constraint_beneficiary(ulysses_circe_1904, nighttown_economy). % Prostitution and "ice gondolas".
narrative_ontology:constraint_victim(ulysses_circe_1904, leopold_bloom).          % Subject to hallucinations and mockery.
domain_priors:requires_active_enforcement(ulysses_circe_1904). % Whistles, calls, and answers.

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   ========================================================================== */

% PERSPECTIVE 1: THE HALLUCINATING SUBJECT (SNARE)
% Effective Extraction: 0.58 * 1.5 (powerless) * 0.8 (local) = 0.696.
% Perceived as a trap of "skeleton tracks" and "danger signals".
constraint_indexing:constraint_classification(ulysses_circe_1904, snare, 
    context(agent_power(powerless), 
            time_horizon(biographical), 
            exit_options(trapped), 
            spatial_scope(local))).

% PERSPECTIVE 2: THE PARENTAL BOND (MOUNTAIN)
% Effective Extraction: 0.58 * -0.2 (institutional/fixed) * 1.2 = -0.139.
% χ < 0.05 check: The vision of Rudy is an irreducible fixed point of 
% the psychological landscape.
constraint_indexing:constraint_classification(ulysses_circe_1904, mountain, 
    context(agent_power(institutional), 
            time_horizon(civilizational), 
            exit_options(mobile), 
            spatial_scope(universal))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (PITON)
% Extreme Theater Ratio (0.99) indicates a Piton of maximal mummery 
% and atrophied narrative reality.
constraint_indexing:constraint_classification(ulysses_circe_1904, piton,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(ulysses_circe_1904_tests).

test(perspectival_gap) :-
    % Verify shift from the Snare of the district to the Mountain of Rudy.
    constraint_indexing:constraint_classification(ulysses_circe_1904, snare, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(ulysses_circe_1904, mountain, context(agent_power(institutional), _, _, _)).

test(piton_theater_validation) :-
    % Piton classification requires theater_ratio >= 0.70.
    domain_priors:theater_ratio(ulysses_circe_1904, TR),
    TR >= 0.70.

:- end_tests(ulysses_circe_1904_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * The "Circe" chapter represents the ultimate "Theater" of the novel. 
 * While the setting is a social Snare of predatory extraction, the 
 * hallucinatory style creates a near-total Theater Ratio (0.99), 
 * rendering the narrative a Piton—a structure where direct function 
 * is replaced by "mummery". 
 * MANDATROPHY ANALYSIS:
 * The "Rudy" vision at the end resolves the Mandatrophy of the 
 * chapter; the chaos of Nighttown collapses into the irreducible 
 * Mountain of Bloom's paternal love and grief.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_nighttown_reality,
    "Is the phantasmagoria a Rope for psychological catharsis or a Snare for the soul?",
    "Review of the 'Rudy' vision vs the 'ghoul' hallucinations.",
    "Catharsis confirms a Rope; persistent entrapment hardens the Snare.",
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

narrative_ontology:interval(ulysses_circe_1904, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Theater Ratio (Escalating as the hallucinations become more complex and surreal)
narrative_ontology:measurement(uc_tr_t0, ulysses_circe_1904, theater_ratio, 0, 0.85).
narrative_ontology:measurement(uc_tr_t5, ulysses_circe_1904, theater_ratio, 5, 0.95).
narrative_ontology:measurement(uc_tr_t10, ulysses_circe_1904, theater_ratio, 10, 0.99).

% Extraction (Accumulating with the subjects' fatigue, drunkenness, and spiritual labor)
narrative_ontology:measurement(uc_ex_t0, ulysses_circe_1904, base_extractiveness, 0, 0.48).
narrative_ontology:measurement(uc_ex_t5, ulysses_circe_1904, base_extractiveness, 5, 0.55).
narrative_ontology:measurement(uc_ex_t10, ulysses_circe_1904, base_extractiveness, 10, 0.58).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: ulysses_eumaeus_1904
% ============================================================================
% Version: 3.4 (Deferential Realism Core)
% Logic: 3.3 (Indexed Tuple P,T,E,S)
% Generated: 2026-02-06
% ============================================================================

:- module(constraint_ulysses_eumaeus, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: ulysses_eumaeus_1904
 * human_readable: The Exhausted Coordination (Cabman's Shelter)
 * domain: social/economic/linguistic
 * * SUMMARY:
 * Leopold Bloom and Stephen Dedalus seek refuge in a cabman's shelter near 
 * Butt bridge. The social environment 
 * functions as a Rope of "orthodox Samaritan fashion" coordination, 
 * providing beverage and rest for the "e.d.ed" Stephen. 
 * However, the narrative style acts as a Piton of atrophied function, 
 * where clichés and circumlocution create an immense Theater Ratio.
 * * KEY AGENTS:
 * - Stephen Dedalus: Subject (Powerless) - "Mind... a bit unsteady" and 
 * physically exhausted.
 * - Leopold Bloom: Beneficiary (Institutional) - Coordinating the "conveyance" 
 * and "propriety" of the shelter.
 * - The Shelter Inhabitants: Auditor (Analytical) - Watching the two 
 * figures "both black" walk toward the bridge.
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(ulysses_eumaeus_1904, 0.47). % High due to extreme fatigue and social "rub".
domain_priors:suppression_score(ulysses_eumaeus_1904, 0.70).   % The inertia of the late night hour.
domain_priors:theater_ratio(ulysses_eumaeus_1904, 0.85).      % High circumlocution and "orthodoxy".

% Primary keys for classification engine
narrative_ontology:constraint_metric(ulysses_eumaeus_1904, extractiveness, 0.47).
narrative_ontology:constraint_metric(ulysses_eumaeus_1904, suppression_requirement, 0.70).
narrative_ontology:constraint_metric(ulysses_eumaeus_1904, theater_ratio, 0.85).

% Structural Property Declarations
narrative_ontology:constraint_beneficiary(ulysses_eumaeus_1904, social_charity).
narrative_ontology:constraint_victim(ulysses_eumaeus_1904, stephen_dedalus).
domain_priors:requires_active_enforcement(ulysses_eumaeus_1904). % Bloom's "duty" to take measures.

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   ========================================================================== */

% PERSPECTIVE 1: STEPHEN DEDALUS (SNARE)
% Effective Extraction: 0.47 * 1.5 (powerless) * 0.8 (local) = 0.564.
% Perceived as a trap of "unsteady" mind and the "rub" of finding beverage.
constraint_indexing:constraint_classification(ulysses_eumaeus_1904, snare, 
    context(agent_power(powerless), 
            time_horizon(biographical), 
            exit_options(trapped), 
            spatial_scope(local))).

% PERSPECTIVE 2: LEOPOLD BLOOM (ROPE)
% Effective Extraction: 0.47 * -0.2 (institutional) * 0.8 = -0.0752.
% Viewed as the essential coordination of "suitable ways and means".
constraint_indexing:constraint_classification(ulysses_eumaeus_1904, rope, 
    context(agent_power(institutional), 
            time_horizon(generational), 
            exit_options(mobile), 
            spatial_scope(local))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (PITON)
% Extreme Theater Ratio (0.85) indicates a Piton of "preparatory" mummery.
constraint_indexing:constraint_classification(ulysses_eumaeus_1904, piton,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(ulysses_eumaeus_1904_tests).

test(perspectival_gap) :-
    % Verify shift from the Snare of Stephen's fatigue to the Rope of Bloom's coordination.
    constraint_indexing:constraint_classification(ulysses_eumaeus_1904, snare, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(ulysses_eumaeus_1904, rope, context(agent_power(institutional), _, _, _)).

test(piton_theater_check) :-
    % Piton classification requires theater_ratio >= 0.70.
    domain_priors:theater_ratio(ulysses_eumaeus_1904, TR),
    TR >= 0.70.

:- end_tests(ulysses_eumaeus_1904_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * The "Eumaeus" chapter models the fatigue of late-night coordination. 
 * While the cabman's shelter serves as a Rope—a "Samaritan" structure 
 * providing safety—Stephen perceives it as a Snare of spiritual and physical 
 * exhaustion. The high Theater Ratio (0.85) 
 * is the chapter's defining feature; the circumlocutory style acts as a 
 * Piton, where the function of direct storytelling is atrophied into a 
 * "mummery" of clichés and "orthodox" preliminaries.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_samaritan_intent,
    "Is Bloom's 'orthodox Samaritan' coordination a Rope for recovery or a Snare of patronization?",
    "Analysis of the 'expedient' vs the 'unsteady' response of the subject.",
    "Recovery confirms a Rope; patronization hardens the Snare.",
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

narrative_ontology:interval(ulysses_eumaeus_1904, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Theater Ratio (Peaking as the circumlocutory style intensifies through the walk)
narrative_ontology:measurement(ue_tr_t0, ulysses_eumaeus_1904, theater_ratio, 0, 0.70).
narrative_ontology:measurement(ue_tr_t5, ulysses_eumaeus_1904, theater_ratio, 5, 0.88).
narrative_ontology:measurement(ue_tr_t10, ulysses_eumaeus_1904, theater_ratio, 10, 0.85).

% Extraction (Accumulating with the subjects' profound fatigue and the "rub" of the hour)
narrative_ontology:measurement(ue_ex_t0, ulysses_eumaeus_1904, base_extractiveness, 0, 0.38).
narrative_ontology:measurement(ue_ex_t5, ulysses_eumaeus_1904, base_extractiveness, 5, 0.44).
narrative_ontology:measurement(ue_ex_t10, ulysses_eumaeus_1904, base_extractiveness, 10, 0.47).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: ulysses_ithaca_1904
% ============================================================================
% Version: 3.4 (Deferential Realism Core)
% Logic: 3.3 (Indexed Tuple P,T,E,S)
% Generated: 2026-02-06
% ============================================================================

:- module(constraint_ulysses_ithaca, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: ulysses_ithaca_1904
 * human_readable: The Mathematical Catechism (7 Eccles Street)
 * domain: technological/scientific/social
 * * SUMMARY:
 * Chapter 17 models the return of Bloom and Stephen to a state of "rest" 
 * through a cold, scientific catechism. 
 * Human experience is reduced to "parallel courses" and the "perpetual 
 * motion of the earth," creating an immutable biological and physical 
 * Mountain. The domestic coordination 
 * of the "duumvirate" functions as a Rope, while the clinical style 
 * acts as a Piton of atrophied emotion.
 * * KEY AGENTS:
 * - Stephen Dedalus: Subject (Powerless) - The "childman weary".
 * - Leopold Bloom: Beneficiary (Institutional) - Coordinating the "itinerary" 
 * and "budget".
 * - The Physical Universe: Auditor (Analytical) - Enforcing "everchanging 
 * tracks of neverchanging space".
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(ulysses_ithaca_1904, 0.46). % High due to the "weary" labor of the long day.
domain_priors:suppression_score(ulysses_ithaca_1904, 0.95).   % Determinism of physics and geometry.
domain_priors:theater_ratio(ulysses_ithaca_1904, 0.95).      % Maximal "catechism" theater.

% Primary keys for classification engine
narrative_ontology:constraint_metric(ulysses_ithaca_1904, extractiveness, 0.46).
narrative_ontology:constraint_metric(ulysses_ithaca_1904, suppression_requirement, 0.95).
narrative_ontology:constraint_metric(ulysses_ithaca_1904, theater_ratio, 0.95).

% Structural Property Declarations
narrative_ontology:constraint_beneficiary(ulysses_ithaca_1904, scientific_determinism).
narrative_ontology:constraint_victim(ulysses_ithaca_1904, human_emotion).
domain_priors:requires_active_enforcement(ulysses_ithaca_1904). % The "proper perpetual motion of the earth".

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   ========================================================================== */

% PERSPECTIVE 1: THE WEARY SUBJECT (SNARE)
% Effective Extraction: 0.46 * 1.5 (powerless) * 1.2 (global/universal) = 0.828.
% Perceived as a trap of "everchanging tracks" and "neverchanging space".
constraint_indexing:constraint_classification(ulysses_ithaca_1904, snare, 
    context(agent_power(powerless), 
            time_horizon(biographical), 
            exit_options(trapped), 
            spatial_scope(global))).

% PERSPECTIVE 2: THE DOMESTIC DUUMVIRATE (ROPE)
% Effective Extraction: 0.46 * -0.2 (institutional) * 1.2 = -0.11.
% Viewed as the essential "united" coordination of "parallel courses".
constraint_indexing:constraint_classification(ulysses_ithaca_1904, rope, 
    context(agent_power(institutional), 
            time_horizon(generational), 
            exit_options(mobile), 
            spatial_scope(global))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (PITON)
% Extreme Theater Ratio (0.95) indicates a Piton of "mathematical" mummery.
constraint_indexing:constraint_classification(ulysses_ithaca_1904, piton,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(universal))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(ulysses_ithaca_1904_tests).

test(perspectival_gap) :-
    % Verify shift from the Snare of the weary subject to the Rope of domestic rest.
    constraint_indexing:constraint_classification(ulysses_ithaca_1904, snare, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(ulysses_ithaca_1904, rope, context(agent_power(institutional), _, _, _)).

test(piton_theater_validation) :-
    % Piton classification requires theater_ratio >= 0.70.
    domain_priors:theater_ratio(ulysses_ithaca_1904, TR),
    TR >= 0.70.

:- end_tests(ulysses_ithaca_1904_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * The "Ithaca" chapter represents the final "Rest" of the novel. While 
 * the setting is a domestic Rope—a site of shared "parallel courses" and 
 * cocoa—the clinical, catechistic style creates a near-total Theater 
 * Ratio (0.95). This "mummery" of 
 * mathematical precision masks the atrophied function of human narrative, 
 * rendering the chapter a Piton for the analytical observer.
 * MANDATROPHY ANALYSIS:
 * The "state of rest" at the end resolves the Mandatrophy of the long day; 
 * the characters collapse into the irreducible Mountain of the earth's 
 * "proper perpetual motion".
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_ithacan_rest,
    "Is the 'state of rest' a Rope for recovery or a Snare of spiritual exhaustion?",
    "Review of the 'manchild in the womb' vs 'childman weary'.",
    "Recovery confirms a Rope; persistent inertia hardens the Snare.",
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

% Required for external script parsing
narrative_ontology:interval(ulysses_ithaca_1904, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Theater Ratio (Escalating as the questions and answers become more abstract and clinical)
narrative_ontology:measurement(ui_tr_t0, ulysses_ithaca_1904, theater_ratio, 0, 0.70).
narrative_ontology:measurement(ui_tr_t5, ulysses_ithaca_1904, theater_ratio, 5, 0.85).
narrative_ontology:measurement(ui_tr_t10, ulysses_ithaca_1904, theater_ratio, 10, 0.95).

% Extraction (Accumulating with the profound weariness and the "perpetual motion" of the day)
narrative_ontology:measurement(ui_ex_t0, ulysses_ithaca_1904, base_extractiveness, 0, 0.35).
narrative_ontology:measurement(ui_ex_t5, ulysses_ithaca_1904, base_extractiveness, 5, 0.42).
narrative_ontology:measurement(ui_ex_t10, ulysses_ithaca_1904, base_extractiveness, 10, 0.46).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: ulysses_penelope_1904
% ============================================================================
% Version: 3.4 (Deferential Realism Core)
% Logic: 3.3 (Indexed Tuple P,T,E,S)
% Generated: 2026-02-06
% ============================================================================

:- module(constraint_ulysses_penelope, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: ulysses_penelope_1904
 * human_readable: The Penelopean Affirmation (7 Eccles Street)
 * domain: social/psychological/biological
 * * SUMMARY:
 * Chapter 18 models the "stream of consciousness" of Molly Bloom as she lies 
 * in bed, unpunctuated and flowing toward a final "Yes". 
 * While her domestic labor and Leopold’s requests act as a Snare, her 
 * connection to the "flower of the mountain" and the earth’s fertility 
 * functions as an irreducible biological Mountain.
 * * KEY AGENTS:
 * - Molly Bloom: Subject (Powerless) - Lying in bed, "thinking of so many 
 * things".
 * - Leopold Bloom: Beneficiary (Institutional) - Asking for "breakfast in 
 * bed with a couple of eggs".
 * - The Universe (Gea-Tellus): Auditor (Analytical) - Witnessing the 
 * "yes I said yes I will Yes".
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(ulysses_penelope_1904, 0.50). % High emotional and physical labor of "yes".
domain_priors:suppression_score(ulysses_penelope_1904, 0.96).   % The ineluctable flow of the monologue.
domain_priors:theater_ratio(ulysses_penelope_1904, 0.97).      % Peak linguistic mummery: no punctuation.

% Primary keys for classification engine
narrative_ontology:constraint_metric(ulysses_penelope_1904, extractiveness, 0.50).
narrative_ontology:constraint_metric(ulysses_penelope_1904, suppression_requirement, 0.96).
narrative_ontology:constraint_metric(ulysses_penelope_1904, theater_ratio, 0.97).

% Structural Property Declarations
narrative_ontology:constraint_beneficiary(ulysses_penelope_1904, biological_affirmation).
narrative_ontology:constraint_victim(ulysses_penelope_1904, molly_bloom).
domain_priors:requires_active_enforcement(ulysses_penelope_1904). % The "throb" and "mad" heart.

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   ========================================================================== */

% PERSPECTIVE 1: THE DOMESTIC SUBJECT (SNARE)
% Effective Extraction: 0.50 * 1.5 (powerless) * 0.8 (local) = 0.60.
% Perceived as a trap of "breakfast in bed" and "sick voice" pretenses 
% .
constraint_indexing:constraint_classification(ulysses_penelope_1904, snare, 
    context(agent_power(powerless), 
            time_horizon(biographical), 
            exit_options(trapped), 
            spatial_scope(local))).

% PERSPECTIVE 2: GEA-TELLUS (MOUNTAIN)
% Effective Extraction: 0.50 * -0.2 (institutional) * 1.2 (universal) = -0.12.
% χ < 0.05 check: The "flower of the mountain" is a fixed topological floor 
% .
constraint_indexing:constraint_classification(ulysses_penelope_1904, mountain, 
    context(agent_power(institutional), 
            time_horizon(civilizational), 
            exit_options(mobile), 
            spatial_scope(universal))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (PITON)
% Extreme Theater Ratio (0.97) indicates a Piton of "unpunctuated" mummery 
% .
constraint_indexing:constraint_classification(ulysses_penelope_1904, piton,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(ulysses_penelope_1904_tests).

test(perspectival_gap) :-
    % Verify shift from the Snare of domestic labor to the Mountain of "Yes".
    constraint_indexing:constraint_classification(ulysses_penelope_1904, snare, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(ulysses_penelope_1904, mountain, context(agent_power(institutional), _, _, _)).

test(piton_theater_check) :-
    % Piton classification requires theater_ratio >= 0.70.
    domain_priors:theater_ratio(ulysses_penelope_1904, TR),
    TR >= 0.70.

:- end_tests(ulysses_penelope_1904_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * The "Penelope" chapter models the final "Affirmation" of the novel. 
 * While Molly's reality is a domestic Snare—extracting her labor and 
 * patience—her interiority creates a peak Theater Ratio (0.97) through its 
 * unpunctuated stream. This stylistic 
 * "mummery" masks the atrophied function of linear narrative, rendering the 
 * chapter a Piton for the observer.
 * MANDATROPHY ANALYSIS:
 * The final "Yes" resolves the Mandatrophy of the day; all "short circuits" 
 * collapse into the irreducible Mountain of life’s "crimson" and 
 * "glorious" suns.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_penelopean_affirmation,
    "Is the 'Yes' a Rope for human connection or a Snare of cyclical repetition?",
    "Review of the 'flower of the mountain' vs the 'breakfast in bed' labor.",
    "Affirmation confirms a Rope; repetition hardens the Snare.",
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

narrative_ontology:interval(ulysses_penelope_1904, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Theater Ratio (Peaking as the stream of consciousness reaches its final unpunctuated flow)
narrative_ontology:measurement(up_tr_t0, ulysses_penelope_1904, theater_ratio, 0, 0.80).
narrative_ontology:measurement(up_tr_t5, ulysses_penelope_1904, theater_ratio, 5, 0.95).
narrative_ontology:measurement(up_tr_t10, ulysses_penelope_1904, theater_ratio, 10, 0.97).

% Extraction (Accumulating with Molly's long night of memory and Bloom's requests)
narrative_ontology:measurement(up_ex_t0, ulysses_penelope_1904, base_extractiveness, 0, 0.42).
narrative_ontology:measurement(up_ex_t5, ulysses_penelope_1904, base_extractiveness, 5, 0.48).
narrative_ontology:measurement(up_ex_t10, ulysses_penelope_1904, base_extractiveness, 10, 0.50).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: unclos_2026
% ============================================================================
% Generated: 2026-01-19
% Model: Gemini 2.0 Flash
% Source: UNCLOS 1982; BBNJ Treaty (2026); South China Sea Award (2016-2026)
% ============================================================================

:- module(constraint_unclos_2026, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks ---
:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:constraint_metric/3,
    constraint_indexing:constraint_classification/3,
    constraint_indexing:extractiveness_for_agent/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: unclos_2026
 * human_readable: UN Convention on the Law of the Sea (2026 Context)
 * domain: legal/geopolitical/environmental
 * temporal_scope: 1982 - Present (2026 BBNJ integration)
 * spatial_scope: Global Oceans
 * * SUMMARY:
 * UNCLOS, often called the "Constitution of the Oceans," establishes a 
 * comprehensive legal framework for all maritime activities. In 2026, 
 * this constraint is revitalized by the entry into force of the BBNJ Treaty 
 * (High Seas Treaty) on January 17, 2026, which creates the first legally 
 * binding rules for biodiversity in international waters.
 * * KEY AGENTS:
 * - Coastal States (e.g., Philippines): Rely on UNCLOS to defend sovereign rights 
 * within 200nm Exclusive Economic Zones (EEZ).
 * - Hegemonic Dissents (e.g., China, USA): Challenge specific parts of the 
 * regime (e.g., seabed mining or compulsory arbitration) as coercive.
 * - International Seabed Authority (ISA): Institutional enforcer of mining rules.
 * * NARRATIVE ARC:
 * UNCLOS transitions from a "Rope" of functional cooperation to a "Mountain" of 
 * customary law for most. However, for powers claiming "historic rights" 
 * outside the Convention, it is treated as a "Snare" to be rejected.
 */

/* ==========================================================================
   2. CORE SYSTEM INTEGRATION
   ========================================================================== */

% Structural Anchor for Audit Suite
narrative_ontology:interval(unclos_era, 1982, 2026).
narrative_ontology:constraint_claim(unclos_2026, rope).

% Base extractiveness: 0.3
% Rationale: While largely fair, it "extracts" absolute freedom of navigation 
% and resource exploitation from states to provide a stable order.
domain_priors:base_extractiveness(unclos_2026, 0.3).

% Suppression score: 0.2
% Rationale: It suppresses unilateral maritime claims (like the "cannon-shot rule" 
% or "nine-dash line") in favor of a zone-based framework.
domain_priors:suppression_score(unclos_2026, 0.2).

% Constraint metric facts (bridge for classification engine)
narrative_ontology:constraint_metric(unclos_2026, extractiveness, 0.3).
narrative_ontology:constraint_metric(unclos_2026, suppression_requirement, 0.2).

% Enforcement: Requires active maintenance (e.g., ISA meetings, arbitral tribunals).
domain_priors:requires_active_enforcement(unclos_2026).

% Beneficiaries & Victims
constraint_beneficiary(unclos_2026, land_locked_states). % Access to sea.
constraint_beneficiary(unclos_2026, coastal_middle_powers). % Stability of EEZ.
constraint_victim(unclos_2026, maritime_unilateralists). % Powers seeking "historic" titles.

% Metrics
/* ==========================================================================
   3. INDEXED CLASSIFICATIONS
   ========================================================================== */

/* --------------------------------------------------------------------------
   PERSPECTIVE 1: SMALL COASTAL STATE (e.g., Philippines) - Mountain
   --------------------------------------------------------------------------
   WHO: powerless - Relatively weaker militarily against superpowers.
   WHEN: biographical - Sovereign survival depends on these "fixed" rules.
   WHERE: trapped - Bound by the geography of their coastline.
   SCOPE: national - Focused on protecting local fishing and resources.
   
   WHY THIS CLASSIFICATION:
   For states relying on the "rules-based order" for survival, UNCLOS and the 
   2016 Arbitral Award are treated as unchangeable natural laws (Mountain) 
   that bind all parties.
   -------------------------------------------------------------------------- */



constraint_indexing:constraint_classification(
    unclos_2026,
    mountain,
    context(
        agent_power(powerless),
        time_horizon(biographical),
        exit_options(trapped),
        spatial_scope(national)
    )
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 2: THE UN SECRETARIAT / EU - Rope
   --------------------------------------------------------------------------
   WHO: institutional - Rule-making and coordinating body.
   WHEN: civilizational - Looking at long-term ocean health (BBNJ).
   WHERE: mobile - Can negotiate and add treaties/annexes.
   SCOPE: global - Worldwide ocean governance.
   
   WHY THIS CLASSIFICATION:
   For the architects of the BBNJ treaty, UNCLOS is a functional "Constitution" 
   (Rope)—a tool to be refined to share benefits fairly and create protected 
   areas in the high seas.
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    unclos_2026,
    rope,
    context(
        agent_power(institutional),
        time_horizon(civilizational),
        exit_options(mobile),
        spatial_scope(global)
    )
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 3: MARITIME SUPERPOWER (e.g., China/USA) - Snare
   --------------------------------------------------------------------------
   WHO: powerful - Significant influence; can act unilaterally.
   WHEN: immediate - Focused on current tactical/resource advantages (mining/islands).
   WHERE: arbitrage - Claims "not bound" by specific rules while using others.
   SCOPE: global/regional - Ambitions spanning entire oceans.
   
   WHY THIS CLASSIFICATION:
   For powers like China, the 2016 Award is a "Snare" that attempts to 
   asymmetrically restrict their perceived "historic rights". For 
   the US, Part XI (seabed mining) is viewed as an extractive limit on 
   economic/security interests.
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    unclos_2026,
    snare,
    context(
        agent_power(powerful),
        time_horizon(immediate),
        exit_options(arbitrage),
        spatial_scope(global)
    )
) :- !.

/* ==========================================================================
   4. TESTS
   ========================================================================== */

:- begin_tests(unclos_2026_tests).

test(multi_perspective_variance) :-
    constraint_indexing:constraint_classification(unclos_2026, Type1, context(agent_power(powerless), time_horizon(biographical), exit_options(trapped), spatial_scope(national))),
    constraint_indexing:constraint_classification(unclos_2026, Type2, context(agent_power(institutional), time_horizon(civilizational), exit_options(mobile), spatial_scope(global))),
    Type1 = mountain,
    Type2 = rope.

test(hegemonic_snare_perception) :-
    % Powerful agents see it as a Snare when it restricts "historic" titles.
    constraint_indexing:constraint_classification(unclos_2026, snare, context(agent_power(powerful), time_horizon(immediate), exit_options(arbitrage), spatial_scope(global))).

test(bbnj_rope_dynamic) :-
    % BBNJ Treaty (High Seas) entry into force 2026 marks a Rope expansion.
    narrative_ontology:interval(unclos_era, _, 2026).

:- end_tests(unclos_2026_tests).

/* ==========================================================================
   5. MODEL INTERPRETATION
   ========================================================================== */

/**
 * LLM GENERATION NOTES
 * * Model: Gemini 2.0 Flash
 * * KEY DECISIONS:
 * 1. PERSPECTIVE GAPS: Highlighted the gap between the "Mountain" of law for 
 * smaller states and the "Snare" of restriction for dissenting superpowers.
 * 2. 2026 CONTEXT: Integrated the BBNJ treaty (Jan 2026) as proof of UNCLOS's 
 * nature as a "living" Rope for institutional actors.
 * 3. EXTRACTIVENESS: Set at 0.3. It is not purely extractive, but powerful 
 * states perceive it as such when it "locks" resources they could otherwise 
 * seize.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω)
   ========================================================================== */

omega_variable(
    us_seabed_unilateralism,
    "Will U.S. Executive Order 14285 create a permanent split in the seabed mining regime?",
    resolution_mechanism("Monitor the conflict between NOAA-issued licenses and ISA contracts in 2026-2027."),
    impact("If Yes: UNCLOS becomes a failing Rope. If No: It solidifies as a Mountain."),
    confidence_without_resolution(medium)
).

omega_variable(
    scs_finality,
    "Does international pressure suffice to enforce the 'final' status of the 2016 Award in 2026?",
    resolution_mechanism("Observe the shift in 'Arbitration Support' from neutral to fully supporting countries."),
    impact("If High Support: Mountain. If Low: It remains a contestable Snare for China."),
    confidence_without_resolution(low)
).

/* ==========================================================================
   7. ALTERNATIVE ANALYSIS
   ========================================================================== */

/**
 * VIABLE ALTERNATIVES
 * * ALTERNATIVE 1: Unilateral "Cannon-Shot" or "Historic Rights" Claims
 * Viability: Historically practiced; China's "nine-dash line" is a modern 
 * version.
 * Suppression: Explicitly invalidated by the 2016 Arbitral Tribunal.
 * * ALTERNATIVE 2: Regional Bilateral Agreements
 * Viability: Beijing's preferred method for South China Sea.
 * Suppression: Small states prefer the "Universal" Rope of UNCLOS to balance power.
 * * CONCLUSION:
 * The shift from "Historic Rights" (Mountain-like natural title) to UNCLOS 
 * zones (Institutional Rope) is the core of 2026 maritime tension.
 */

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: union_protection_underperformance
% ============================================================================
% Version: 5.2 (Deferential Realism Core + Boltzmann + Purity + Network)
% Logic: 5.2 (Indexed Tuple P,T,E,S + Coupling + Purity + Network Drift)
% Generated: 2024-07-16
% ============================================================================

:- module(constraint_union_protection_underperformance, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    narrative_ontology:constraint_claim/2,
    narrative_ontology:affects_constraint/2,
    narrative_ontology:coordination_type/2,
    narrative_ontology:boltzmann_floor_override/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: union_protection_underperformance
 * human_readable: "Just Cause" Protection for Underperforming Union Employees
 * domain: economic
 * * SUMMARY:
 * This constraint models the "Just Cause" and due process provisions in
 * collective bargaining agreements that make it difficult to terminate
 * employees for sub-par performance without exhaustive documentation and
 * remediation attempts. While designed to prevent arbitrary firing (a
 * coordination function), it often results in the retention of chronic
 * underperformers, extracting productivity from the organization and morale
 * from high-performing peers.
 * * KEY AGENTS:
 * - Front-line Supervisor: Subject (Powerless); must navigate a high
 *   bureaucratic burden of proof to manage performance.
 * - The Union: Beneficiary (Institutional); enforces the rules to ensure
 *   procedural fidelity and protect all members.
 * - High-Performing Coworkers: Victims; must often cover productivity gaps.
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(union_protection_underperformance, 0.60). % Extraction from the organization (wages for low output) and peers (covering slack).
domain_priors:suppression_score(union_protection_underperformance, 0.50).   % Alternatives (at-will employment) are suppressed by the legal force of the contract.
domain_priors:theater_ratio(union_protection_underperformance, 0.15).       % The system is highly functional, not theatrical.

% Constraint metric facts — primary keys used by the classification engine.
narrative_ontology:constraint_metric(union_protection_underperformance, extractiveness, 0.60).
narrative_ontology:constraint_metric(union_protection_underperformance, suppression_requirement, 0.50).
narrative_ontology:constraint_metric(union_protection_underperformance, theater_ratio, 0.15).

% Constraint self-claim (what does the constraint claim to be?)
narrative_ontology:constraint_claim(union_protection_underperformance, coordination).

% Binary flags
domain_priors:requires_active_enforcement(union_protection_underperformance). % Requires grievance procedures, arbitration, etc.

% Structural property derivation hooks:
narrative_ontology:constraint_beneficiary(union_protection_underperformance, union_members_seeking_security).
narrative_ontology:constraint_victim(union_protection_underperformance, organizational_efficiency).
narrative_ontology:constraint_victim(union_protection_underperformance, high_performing_coworkers).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   ========================================================================== */

% PERSPECTIVE 1: THE SUBJECT (FRONT-LINE SUPERVISOR)
% The supervisor is powerless, trapped by rules that create a high coercive
% burden (document everything) and extract productivity. This feels like a Snare.
constraint_indexing:constraint_classification(union_protection_underperformance, snare,
    context(agent_power(powerless),
            time_horizon(biographical),
            exit_options(trapped),
            spatial_scope(local))).

% PERSPECTIVE 2: THE BENEFICIARY (THE UNION)
% The union, as an institutional actor, sees this as a pure coordination
% mechanism (Rope) that provides stability and prevents arbitrary management action.
constraint_indexing:constraint_classification(union_protection_underperformance, rope,
    context(agent_power(institutional),
            time_horizon(generational),
            exit_options(mobile),
            spatial_scope(national))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER
% The analyst sees both the coordination function (beneficiaries exist) and the
% asymmetric extraction (victims exist), enforced actively. This is a canonical
% Tangled Rope.
constraint_indexing:constraint_classification(union_protection_underperformance, tangled_rope,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(union_protection_underperformance_tests).

test(perspectival_gap) :-
    % Verify the gap between the supervisor (Snare) and the union (Rope).
    constraint_indexing:constraint_classification(union_protection_underperformance, TypePowerless,
        context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(union_protection_underperformance, TypeInstitutional,
        context(agent_power(institutional), _, _, _)),
    assertion(TypePowerless == snare),
    assertion(TypeInstitutional == rope),
    TypePowerless \= TypeInstitutional.

test(analytical_classification_is_tangled_rope) :-
    % Verify the analytical observer correctly identifies the hybrid nature.
    constraint_indexing:constraint_classification(union_protection_underperformance, tangled_rope,
        context(agent_power(analytical), _, _, _)).

test(tangled_rope_structural_requirements_met) :-
    % Verify all three conditions for Tangled Rope are present.
    narrative_ontology:constraint_beneficiary(union_protection_underperformance, _), % -> has_coordination_function
    narrative_ontology:constraint_victim(union_protection_underperformance, _),     % -> has_asymmetric_extraction
    domain_priors:requires_active_enforcement(union_protection_underperformance).

:- end_tests(union_protection_underperformance_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * The base extractiveness of 0.60 reflects the significant cost imposed on the
 * organization and high-performing peers, who subsidize the wages and
 * productivity gaps of underperformers. The suppression score of 0.50 reflects
 * that while merit-based alternatives exist, they are legally and culturally
 * suppressed within the unionized context.
 *
 * The key Perspectival Gap is between the supervisor and the union. The
 * supervisor, despite their title, is powerless against the contract's rules,
 * experiencing the system as a Snare that extracts their time and their team's
 * productivity. The union, an institutional power, sees the same rules as a
 * Rope, a necessary tool for coordinating fair labor practices and protecting
 * all members from arbitrary dismissal.
 *
 * * MANDATROPHY ANALYSIS: [RESOLVED MANDATROPHY]
 * The Tangled Rope classification is critical here. A naive analysis might
 * label this a pure Snare (focusing only on the victims) or a pure Rope
 * (focusing only on the beneficiaries). Tangled Rope correctly identifies that
 * the constraint has a genuine, non-trivial coordination function (preventing
 * arbitrary firings) that is structurally coupled with significant, asymmetric
 * extraction (protecting underperformers at others' expense).
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_union_protection,
    "Is 'underperformance' an objective, measurable deficit, or a subjective management label used to undermine worker protections?",
    "Analysis of grievance arbitration outcomes, comparing cases with quantitative performance data vs. those with qualitative assessments.",
    "If primarily objective, the system is a flawed but functional Tangled Rope. If primarily subjective, it's a necessary Rope protecting against a management Snare.",
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

narrative_ontology:interval(union_protection_underperformance, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% This constraint has high extraction (0.60 > 0.46), requiring temporal data.
% We model a slow increase in extraction over time as contracts become more
% rigid and procedural burdens accumulate. Theater ratio remains low.

% Theater ratio over time:
narrative_ontology:measurement(up_tr_t0, union_protection_underperformance, theater_ratio, 0, 0.10).
narrative_ontology:measurement(up_tr_t5, union_protection_underperformance, theater_ratio, 5, 0.12).
narrative_ontology:measurement(up_tr_t10, union_protection_underperformance, theater_ratio, 10, 0.15).

% Extraction over time:
narrative_ontology:measurement(up_ex_t0, union_protection_underperformance, base_extractiveness, 0, 0.55).
narrative_ontology:measurement(up_ex_t5, union_protection_underperformance, base_extractiveness, 5, 0.58).
narrative_ontology:measurement(up_ex_t10, union_protection_underperformance, base_extractiveness, 10, 0.60).

/* ==========================================================================
   9. BOLTZMANN & NETWORK DATA (v5.0-5.2)
   ========================================================================== */

% The constraint's function is based on enforcing a contract via grievance
% procedures, making it an enforcement mechanism.
narrative_ontology:coordination_type(union_protection_underperformance, enforcement_mechanism).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */% ============================================================================
% CONSTRAINT STORY: universal_mathematics_communication
% ============================================================================
% Generated: January 20, 2026
% Model: Gemini 2.0 Flash
% Source: bee_communication.pdf
% ============================================================================

:- module(constraint_universal_mathematics_communication, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
domain_priors:base_extractiveness/2,
domain_priors:suppression_score/2,
domain_priors:requires_active_enforcement/1,
narrative_ontology:constraint_metric/3,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================

1. NARRATIVE CONTEXT
========================================================================== */

/**

* CONSTRAINT IDENTIFICATION
* * constraint_id: universal_mathematics_communication


* human_readable: Mathematics as a Universal Communication Constraint
* domain: technological/scientific
* temporal_scope: 17th Century to Civilizational Future
* spatial_scope: Global to Interstellar
* * SUMMARY:


* This constraint posits that mathematics is not a human invention but a
* fundamental "language of the universe". It acts as a bridge for


* communication between species with "alien" minds—such as humans and bees,
* or humans and extraterrestrials—by providing a shared framework of logic
* and quantity.


* * KEY AGENTS:


* * Human Scientists: Researchers seeking to establish contact with alien life using binary or mathematical signals.




* * Honeybees: "Insectoid alien models" that have independently evolved the capacity for simple arithmetic and symbolic learning.




* * Extraterrestrials: Hypothetical intelligent entities whose ability to communicate with Earth depends on the universality of mathematical laws.




* * NARRATIVE ARC:


* Starting with Galileo's observation of nature's mathematical "language," the narrative moves through
* human efforts like the Arecibo message and Voyager's Golden Record. It then grounds


* this in empirical biology, showing that honeybees—diverged from humans for 600 million years—can
* still "calculate," suggesting mathematics is a Mountain-like constraint of intelligence itself.
*/



/* ==========================================================================
2. CORE SYSTEM INTEGRATION (The "Reality" Layer)
========================================================================== */

% Required for [STEP 1] and [STEP 2] of the DR-Audit Suite
narrative_ontology:interval(scientific_consensus_period, 0, 10).
narrative_ontology:constraint_claim(universal_mathematics_communication, mountain).

% Base extractiveness score (0.0 = no extraction, 1.0 = full extraction)
% Rationale: Mathematics is non-extractive; it is a shared discovery that
% enables cooperation rather than exploitation.
domain_priors:base_extractiveness(universal_mathematics_communication, 0.1).

% Suppression score (0.0 = no suppression, 1.0 = full suppression)
% Rationale: While mathematical truths are "enforced" by logic, alternative
% "dialects" or formulations of math are considered possible.
domain_priors:suppression_score(universal_mathematics_communication, 0.2).

% Constraint metric facts (bridge for classification engine)
narrative_ontology:constraint_metric(universal_mathematics_communication, extractiveness, 0.1).
narrative_ontology:constraint_metric(universal_mathematics_communication, suppression_requirement, 0.2).

% Enforcement requirements
% Emerges naturally as a consequence of intelligence and physical reality.
domain_priors:emerges_naturally(universal_mathematics_communication).

% Metrics required for Section 1 of the Executive Summary
/* ==========================================================================
3. INDEXED CLASSIFICATIONS (Perspectival Truth)
========================================================================== */

/* --------------------------------------------------------------------------
PERSPECTIVE 1: HONEYBEE (Powerless Subject) - Mountain

WHO: powerless - Subjects in human-led experiments.
WHEN: immediate - Focused on the "now" of the reward (sugar water).
WHERE: trapped - Bound by the physical and neurological limits of their "miniature brains".
SCOPE: local - Immediate environment of the test.

WHY THIS CLASSIFICATION:
For the bee, the logic of addition and subtraction is an immutable feature
of the world they must navigate to survive (or get sugar). They cannot change
the rules of "odd/even" or the existence of "zero"; they can only discover
and adapt to them.

NARRATIVE EVIDENCE:
"Bees showed evidence of solving simple addition and subtraction... including
an understanding of 'zero'".
-------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
universal_mathematics_communication,
mountain,
context(
agent_power(powerless),
time_horizon(immediate),
exit_options(trapped),
constraint_beneficiary(universal_mathematics_communication, honeybee),
constraint_victim(universal_mathematics_communication, none),
spatial_scope(local)
)
) :-
domain_priors:emerges_naturally(universal_mathematics_communication),
domain_priors:suppression_score(universal_mathematics_communication, S),
S < 0.3,
!.

/* --------------------------------------------------------------------------
PERSPECTIVE 2: NASA/SETI SCIENTIST (Institutional) - Rope

WHO: institutional - Backed by state/academic power to send interstellar signals.
WHEN: historical - Communication spanning decades or centuries.
WHERE: mobile - Actively choosing which mathematical "symbols" or "binary" to use.
SCOPE: global - Designing messages for the entire planet/species.

WHY THIS CLASSIFICATION:
For institutions, mathematics is a coordination mechanism (Rope). It is
functional and changeable in its *expression* (e.g., binary vs. prime sequences)
to facilitate the goal of interstellar conversation.

NARRATIVE EVIDENCE:
"Researchers developed a binary language designed to introduce
extraterrestrials to human mathematics".
-------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
universal_mathematics_communication,
rope,
context(
agent_power(institutional),
time_horizon(historical),
exit_options(mobile),
constraint_beneficiary(universal_mathematics_communication, humanity),
constraint_victim(universal_mathematics_communication, none),
spatial_scope(global)
)
) :-
domain_priors:base_extractiveness(universal_mathematics_communication, E),
E < 0.3,
!.

/* --------------------------------------------------------------------------
PERSPECTIVE 3: ANALYTICAL PHILOSOPHER - Rope/Mountain Hybrid

WHO: analytical - Observer questioning the nature of reality.
WHEN: civilizational - Considering the long-term divergence of species.
WHERE: analytical - Viewing math from a conceptual distance.
SCOPE: global - Applying findings across biological domains.

WHY THIS CLASSIFICATION:
The observer sees math as a Rope because different species may develop
"different approaches... akin to dialects," but ultimately it is a Mountain
if it is an unavoidable "consequence of intelligence".

NARRATIVE EVIDENCE:
"Question of whether mathematics is an entirely human construction, or if
it is a consequence of intelligence and thus, universal".
-------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
universal_mathematics_communication,
rope,
context(
agent_power(analytical),
time_horizon(civilizational),
exit_options(analytical),
constraint_beneficiary(universal_mathematics_communication, intelligent_life),
constraint_victim(universal_mathematics_communication, none),
spatial_scope(global)
)
) :-
domain_priors:suppression_score(universal_mathematics_communication, S),
S < 0.3,
!.

/* ==========================================================================
4. TESTS (What We Learn About Constraints)
========================================================================== */

:- begin_tests(universal_mathematics_tests).

/**

* TEST 1: Multi-perspective variance
* Demonstrates that the Bee sees a Mountain (nature) while the Scientist sees a Rope (tool).
*/
test(multi_perspective_utilization) :-
constraint_indexing:constraint_classification(
universal_mathematics_communication,
mountain,
context(powerless, immediate, trapped, _, _, local)
),
constraint_indexing:constraint_classification(
universal_mathematics_communication,
rope,
context(institutional, historical, mobile, _, _, global)
).

/**

* TEST 2: Extraction check
* Confirms that Universal Math is categorized as non-extractive (not a Snare).
*/
test(non_extractive_nature) :-
domain_priors:base_extractiveness(universal_mathematics_communication, E),
E < 0.3.

/**

* TEST 3: Time-horizon mutability
* Short horizons perceive math as fixed; long horizons allow for "dialect" shifts.
*/
test(time_immutability_scaling) :-
% Immediate/Biographical + trapped tends to perceive Mountain
constraint_indexing:constraint_classification(universal_mathematics_communication, mountain, context(_, immediate, trapped, _, _, _)).

:- end_tests(universal_mathematics_tests).

/* ==========================================================================
5. MODEL INTERPRETATION (Commentary)
========================================================================== */

/**

* LLM GENERATION NOTES
* * Model: Gemini 2.0 Flash


* * KEY DECISIONS MADE BY MODEL:


* * 1. BASE EXTRACTIVENESS (0.1):




* Reasoning: Mathematics is presented as a neutral or beneficial "universal
* language." There is no evidence of it being used to extract value from
* bees; rather, humans provide sugar to bees to study it.


* * 2. PERSPECTIVE SELECTION:




* * Honeybee: Chosen to represent the "powerless" subject and show that math


* works even for brains with 600m years of separation.


* * Scientist/NASA: Chosen to represent the institutional "Rope" view—using


* math to bridge gaps.


* * 3. CLASSIFICATION RATIONALE:




* * Bee → Mountain: Because a bee cannot "renegotiate" addition; it is an


* innate constraint of intelligence.


* * Scientist → Rope: Because humans *choose* which mathematical markers


* (primes, binary, symbols) to use as coordination tools.


* * 4. AMBIGUITIES IN SOURCE MATERIAL:




* * The source admits we don't know if math is a human construction or a


* universal truth. This is formalized as an Omega.


* 5. OMEGAS


* omega_variable(math_ontological_status,
* "Is mathematics a human construct (Rope/Scaffold) or a universal consequence of intelligence (Mountain)?",
*	resolution_mechanism("Comparison with verified extraterrestrial mathematical systems "),


* impact("If Mountain: Interstellar communication is guaranteed. If Rope: Contact may be impossible without shared culture."),
* confidence_without_resolution(medium)
* ).
*/

/* ==========================================================================
6. ALTERNATIVE ANALYSIS
========================================================================== */

/**

* VIABLE ALTERNATIVES
* * Does this constraint have alternatives?

* * ALTERNATIVE 1: Biological/Pheromonal Communication

* Viability: The "waggle dance" used by bees.

* Suppression: Not suppressed, but limited in range; cannot reach the stars.
* * ALTERNATIVE 2: Linguistic/Cultural Translation

* Viability: Human languages.

* Suppression: Rejected for interstellar use because there is "no shared language"
* with aliens.

* * CONCLUSION:
* The presence of alternatives for local communication (waggle dance) makes
* local communication a Rope, but for interstellar distances, Math is treated
* as the only viable "Mountain" we can rely on.
*/

/* ==========================================================================
7. INTEGRATION HOOKS
========================================================================== */

/**

* TO USE THIS CONSTRAINT:
* 1. Load: ?- [universal_mathematics_communication].

* 2. Run multi-perspective analysis: ?- multi_index_report(universal_mathematics_communication).

* 3. Run tests: ?- run_tests(universal_mathematics_tests).
*/

/* ==========================================================================
END OF CONSTRAINT STORY
========================================================================== */
% ============================================================================
% CONSTRAINT STORY: us_iran_drone_conflict
% ============================================================================
% Version: 3.4 (Deferential Realism Core)
% Logic: 3.3 (Indexed Tuple P,T,E,S)
% Generated: 2024-02-29
% ============================================================================

:- module(constraint_us_iran_drone_conflict, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: us_iran_drone_conflict
 * human_readable: US-Iran Drone Conflict and Escalation
 * domain: political
 * * SUMMARY:
 * The US military claims to have shot down an Iranian drone that approached a US base in Syria. This incident reflects the ongoing tension and conflict between the US and Iran in the region, with potential for escalation. The constraint is the cycle of actions and reactions between the two countries, limiting options for both sides.
 * * KEY AGENTS:
 * - Iran: Subject (Powerless/Constrained)
 * - US Military: Beneficiary (Institutional)
 * - International Observers: Auditor (Analytical)
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(us_iran_drone_conflict, 0.6). % Mountain suppression <= 0.05, Rope extraction <= 0.15, Snare extraction >= 0.46
domain_priors:suppression_score(us_iran_drone_conflict, 0.7).   % Structural property (raw, unscaled). Only extractiveness is scaled (by power and scope).
domain_priors:theater_ratio(us_iran_drone_conflict, 0.2).       % Piton detection (>= 0.70)

% Constraint metric facts — primary keys used by the classification engine.
% These mirror domain_priors values using the metric key names from config.pl.
narrative_ontology:constraint_metric(us_iran_drone_conflict, extractiveness, 0.6).
narrative_ontology:constraint_metric(us_iran_drone_conflict, suppression_requirement, 0.7).
narrative_ontology:constraint_metric(us_iran_drone_conflict, theater_ratio, 0.2).

% Binary flags
% narrative_ontology:has_sunset_clause(us_iran_drone_conflict).      % Mandatory if Scaffold
domain_priors:requires_active_enforcement(us_iran_drone_conflict). % Required for Tangled Rope

% Structural property derivation hooks:
%   has_coordination_function/1 is DERIVED from constraint_beneficiary/2
%   has_asymmetric_extraction/1 is DERIVED from constraint_victim/2
% Both are required for Tangled Rope. Coordination is also required for Scaffold.
narrative_ontology:constraint_beneficiary(us_iran_drone_conflict, us_military).
narrative_ontology:constraint_victim(us_iran_drone_conflict, iran).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   Power (P) and Scope (S) both affect effective extraction.
   Scope modifiers: local=0.8, regional=0.9, national=1.0,
                    continental=1.1, global=1.2, universal=1.0.
   ========================================================================== */

% PERSPECTIVE 1: THE SUBJECT (SNARE/MOUNTAIN)
% High extraction felt as an immutable limit or predatory trap.
% NOTE: This may be upgraded to 'organized' power if a critical mass of victims exists.
%
% UNIFORM-TYPE EXCEPTION: For natural law constraints (mountain-only) or pure
% coordination constraints (rope-only), perspectives 1 and 2 may use any power
% atoms — the classification is the same from all perspectives.  Include at
% least 2-3 perspectives to demonstrate the invariance.
constraint_indexing:constraint_classification(us_iran_drone_conflict, snare,
    context(agent_power(powerless),
            time_horizon(biographical),
            exit_options(trapped),
            spatial_scope(regional))).

% PERSPECTIVE 2: THE BENEFICIARY (ROPE)
% Viewed as essential infrastructure or coordination.
constraint_indexing:constraint_classification(us_iran_drone_conflict, rope,
    context(agent_power(institutional),
            time_horizon(generational),
            exit_options(mobile),
            spatial_scope(regional))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER
% Default analytical context (civilizational/analytical/global).
% This perspective is used by the bridge to derive constraint_claim.
% Type should reflect what the metrics compute: mountain, rope, tangled_rope, snare, scaffold, or piton.
constraint_indexing:constraint_classification(us_iran_drone_conflict, tangled_rope,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

% PERSPECTIVE 4: (ORGANIZED POWER)
% Demonstrating change when a coalition forms among victims.
constraint_indexing:constraint_classification(us_iran_drone_conflict, tangled_rope,
    context(agent_power(organized),
            time_horizon(generational),
            exit_options(constrained),
            spatial_scope(regional))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(us_iran_drone_conflict_tests).

test(perspectival_gap) :-
    % Verify there is a perspectival gap between powerless and institutional.
    constraint_indexing:constraint_classification(us_iran_drone_conflict, TypePowerless, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(us_iran_drone_conflict, TypeInstitutional, context(agent_power(institutional), _, _, _)),
    TypePowerless \= TypeInstitutional.

test(threshold_validation) :-
    config:param(extractiveness_metric_name, ExtMetricName),
    narrative_ontology:constraint_metric(us_iran_drone_conflict, ExtMetricName, E),
    (E =< 0.05 -> true ; E >= 0.46). % Ensures it's either a Mountain or high-extraction Snare/Tangled.

:- end_tests(us_iran_drone_conflict_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * I assigned a base extractiveness of 0.6 and a suppression score of 0.7 due to the clear limitations placed on Iran's actions and the potential for further escalation. The Perspectival Gap exists because the US military views its actions as defensive and necessary for regional stability, while Iran perceives them as aggressive and suppressive of its interests. This framing leads to differing classifications: the US as maintaining a "rope" of regional order (however coercive) while Iran is caught in a "snare" of imposed limitations. From a broader analytical perspective, the situation is a tangled rope: both sides are entangled in a cycle of actions and reactions, extracting resources and strategic advantages from the other, while also coordinating to avoid full-scale war (however imperfectly).
 * * MANDATROPHY ANALYSIS:
 * The Tangled Rope classification prevents the system from mislabeling coordination as pure extraction by acknowledging the element of coordination. Both sides engage in actions that influence the other's behavior, signaling intentions and red lines, thereby shaping the parameters of the conflict. While the extraction and suppression are real, they coexist with a degree of (often adversarial) coordination.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

% omega_variable(ID, Question, Resolution_Mechanism, Impact, Confidence).
omega_variable(
    omega_us_iran_drone_conflict,
    'Is the US military presence in Syria primarily a deterrent force or an interventionist one?',
    'Detailed historical analysis of US foreign policy objectives and military actions in the region, combined with classified intelligence assessments.',
    'If Deterrent: conflict may de-escalate; if Interventionist: conflict likely to escalate.',
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

% Required for external script parsing
narrative_ontology:interval(us_iran_drone_conflict, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Temporal data enables drift detection (metric_substitution,
% extraction_accumulation) by providing measurements at multiple time points.
% Model how the constraint intensified or changed across the interval.
%
% Required for high-extraction constraints (base_extractiveness > 0.46).
% Use at least 3 time points (T=0, midpoint, T=end) for each tracked metric.
%
% Theater ratio over time (triggers metric_substitution detection):
narrative_ontology:measurement(us_iran_drone_conflict_tr_t0, us_iran_drone_conflict, theater_ratio, 0, 0.1).
narrative_ontology:measurement(us_iran_drone_conflict_tr_t5, us_iran_drone_conflict, theater_ratio, 5, 0.2).
narrative_ontology:measurement(us_iran_drone_conflict_tr_t10, us_iran_drone_conflict, theater_ratio, 10, 0.2).

% Extraction over time (triggers extraction_accumulation detection):
narrative_ontology:measurement(us_iran_drone_conflict_ex_t0, us_iran_drone_conflict, base_extractiveness, 0, 0.5).
narrative_ontology:measurement(us_iran_drone_conflict_ex_t5, us_iran_drone_conflict, base_extractiveness, 5, 0.6).
narrative_ontology:measurement(us_iran_drone_conflict_ex_t10, us_iran_drone_conflict, base_extractiveness, 10, 0.6).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */% ============================================================================
% CONSTRAINT STORY: us_suburban_zoning_2025
% ============================================================================
% Version: 5.2 (Deferential Realism Core + Boltzmann + Purity + Network)
% Logic: 5.2 (Indexed Tuple P,T,E,S + Coupling + Purity + Network Drift)
% Generated: 2024-07-28
% ============================================================================

:- module(constraint_us_suburban_zoning_2025, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    narrative_ontology:constraint_claim/2,
    narrative_ontology:affects_constraint/2,
    narrative_ontology:coordination_type/2,
    narrative_ontology:boltzmann_floor_override/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: us_suburban_zoning_2025
 * human_readable: Single-Family Suburban Zoning Codes
 * domain: political/legal/economic
 * * SUMMARY:
 * Local zoning codes in the United States restrict large swaths of metropolitan land to low-density,
 * single-family homes. This legal constraint effectively bans apartment buildings and other forms of
 * dense housing, creating a severe mismatch between existing housing stock and modern demographic needs,
 * which drives up housing costs and exacerbates inequality.
 * * KEY AGENTS:
 * - Middle-Income Renters: Subjects of the housing shortage, facing high costs and limited options (Powerless).
 * - Established Homeowners: Beneficiaries of artificially inflated property values and protected neighborhood character (Institutional).
 * - Urban Planners/Policy Analysts: Observers studying the systemic effects of zoning policy (Analytical).
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(us_suburban_zoning_2025, 0.70). % High asymmetry; homeowners gain value while renters face shortages.
domain_priors:suppression_score(us_suburban_zoning_2025, 0.65).   % Alternatives like apartment buildings are legally banned in many areas.
domain_priors:theater_ratio(us_suburban_zoning_2025, 0.15).       % Enforcement is functional (permits, inspections), not theatrical.

% Constraint metric facts — primary keys used by the classification engine.
narrative_ontology:constraint_metric(us_suburban_zoning_2025, extractiveness, 0.70).
narrative_ontology:constraint_metric(us_suburban_zoning_2025, suppression_requirement, 0.65).
narrative_ontology:constraint_metric(us_suburban_zoning_2025, theater_ratio, 0.15).

% Constraint self-claim: Zoning laws claim to be a coordination mechanism for orderly development.
narrative_ontology:constraint_claim(us_suburban_zoning_2025, coordination).

% Binary flags: Requires active enforcement via municipal planning boards, permits, and inspections.
domain_priors:requires_active_enforcement(us_suburban_zoning_2025).

% Structural property derivation hooks for Tangled Rope classification.
narrative_ontology:constraint_beneficiary(us_suburban_zoning_2025, established_homeowners).
narrative_ontology:constraint_victim(us_suburban_zoning_2025, middle_income_renters).
narrative_ontology:constraint_victim(us_suburban_zoning_2025, multifamily_developers).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   ========================================================================== */

% PERSPECTIVE 1: THE SUBJECT (RENTER)
% For those priced out of the market, zoning is a coercive trap that limits
% their housing options and extracts significant portions of their income.
% χ = 0.70 (ε) * 1.5 (π(powerless)) * 0.9 (σ(regional)) = 0.945. High extraction.
constraint_indexing:constraint_classification(us_suburban_zoning_2025, snare,
    context(agent_power(powerless),
            time_horizon(biographical),
            exit_options(trapped),
            spatial_scope(regional))).

% PERSPECTIVE 2: THE BENEFICIARY (HOMEOWNER)
% For established homeowners, zoning is a beneficial coordination tool that
% protects property values and maintains neighborhood character.
% χ = 0.70 (ε) * -0.2 (π(institutional)) * 1.0 (σ(national)) = -0.14. Perceived as pure benefit.
constraint_indexing:constraint_classification(us_suburban_zoning_2025, rope,
    context(agent_power(institutional),
            time_horizon(generational),
            exit_options(mobile),
            spatial_scope(national))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER
% An analyst sees both the coordination function (organizing land use) and the
% severe asymmetric extraction. Combined with active enforcement, this is a
% canonical Tangled Rope.
% χ = 0.70 (ε) * 1.15 (π(analytical)) * 1.2 (σ(global)) = 0.966.
constraint_indexing:constraint_classification(us_suburban_zoning_2025, tangled_rope,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(us_suburban_zoning_2025_tests).

test(perspectival_gap) :-
    constraint_indexing:constraint_classification(us_suburban_zoning_2025, TypePowerless, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(us_suburban_zoning_2025, TypeInstitutional, context(agent_power(institutional), _, _, _)),
    assertion(TypePowerless == snare),
    assertion(TypeInstitutional == rope),
    assertion(TypePowerless \= TypeInstitutional).

test(analytical_observer_classification) :-
    constraint_indexing:constraint_classification(us_suburban_zoning_2025, TypeAnalytical, context(agent_power(analytical), _, _, _)),
    assertion(TypeAnalytical == tangled_rope).

test(tangled_rope_structural_properties) :-
    narrative_ontology:constraint_beneficiary(us_suburban_zoning_2025, _), % -> has_coordination_function
    narrative_ontology:constraint_victim(us_suburban_zoning_2025, _),     % -> has_asymmetric_extraction
    domain_priors:requires_active_enforcement(us_suburban_zoning_2025).

test(high_extraction_threshold) :-
    narrative_ontology:constraint_metric(us_suburban_zoning_2025, extractiveness, E),
    assertion(E >= 0.46).

:- end_tests(us_suburban_zoning_2025_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * The base scores reflect a system with a stated coordination goal (orderly development)
 * that now functions primarily as an extractive mechanism. Extractiveness (0.70) is high
 * due to the wealth transfer from renters to landowners via artificial scarcity. Suppression
 * (0.65) is high because denser housing types are legally prohibited.
 *
 * The PERSPECTIVAL GAP is stark:
 * - For a RENTER (powerless), the system is a 'Snare'. It's a coercive trap with no easy exit,
 *   driving up costs and limiting life choices.
 * - For a HOMEOWNER (institutional), it's a 'Rope'. It coordinates behavior to protect their
 *   largest asset, appearing as a purely beneficial rule set.
 * - For an ANALYST, it's a 'Tangled Rope'. The system possesses a genuine (if outdated)
 *   coordination function but has been captured to serve an extractive purpose, requiring
 *   active legal enforcement to maintain the asymmetry.
 *
 * MANDATROPHY ANALYSIS: [RESOLVED MANDATROPHY]
 * A simple Snare classification would miss the fact that zoning does perform a real
 * coordination function that beneficiaries value. A Rope classification would ignore the
 * immense negative externalities and coercive extraction imposed on victims. The
 * 'Tangled Rope' classification correctly identifies this dual nature, preventing the
 * system from mislabeling a complex, contested system as either pure coordination or
 * pure extraction. It captures the essence of a mandate that has drifted from its
 * original purpose.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_zoning_1,
    'Will state-level legislative overrides (e.g., California ADU laws) successfully dismantle local zoning power, or will NIMBY resistance render them ineffective?',
    'Measure the net change in housing unit density in single-family zones in states with pre-emption laws over a 10-year period.',
    'If overrides are effective, the constraint may evolve towards a Rope. If they fail, it remains a potent Tangled Rope/Snare.',
    confidence_without_resolution(medium)
).

omega_variable(
    omega_zoning_2,
    'Is the primary driver of homeowner opposition economic (protecting property values) or cultural (preserving neighborhood character)?',
    'Survey data correlating opposition to upzoning with homeowner financial leverage vs. stated cultural concerns.',
    'If economic, financial incentives could resolve the conflict. If cultural, the constraint is more deeply entrenched and resistant to change.',
    confidence_without_resolution(low)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

% Interval represents the period from the rise of modern zoning to the present.
narrative_ontology:interval(us_suburban_zoning_2025, 0, 55). % Approx 1970-2025

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Temporal data shows how zoning's extractive nature grew as housing demand
% outpaced the supply model it enforces.
% T=0 (c. 1970), T=27 (c. 1997), T=55 (c. 2025).

% Theater ratio over time (remains low and functional):
narrative_ontology:measurement(us_suburban_zoning_2025_tr_t0, us_suburban_zoning_2025, theater_ratio, 0, 0.10).
narrative_ontology:measurement(us_suburban_zoning_2025_tr_t27, us_suburban_zoning_2025, theater_ratio, 27, 0.12).
narrative_ontology:measurement(us_suburban_zoning_2025_tr_t55, us_suburban_zoning_2025, theater_ratio, 55, 0.15).

% Extraction over time (grows significantly):
narrative_ontology:measurement(us_suburban_zoning_2025_ex_t0, us_suburban_zoning_2025, base_extractiveness, 0, 0.20).
narrative_ontology:measurement(us_suburban_zoning_2025_ex_t27, us_suburban_zoning_2025, base_extractiveness, 27, 0.45).
narrative_ontology:measurement(us_suburban_zoning_2025_ex_t55, us_suburban_zoning_2025, base_extractiveness, 55, 0.70).

/* ==========================================================================
   9. BOLTZMANN & NETWORK DATA (v5.0-5.2)
   ========================================================================== */

% Coordination type: Zoning is a classic example of a resource allocation mechanism (for land).
narrative_ontology:coordination_type(us_suburban_zoning_2025, resource_allocation).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */% ============================================================================
% CONSTRAINT STORY: us_two_party_duopoly
% ============================================================================
% Version: 5.2 (Deferential Realism Core + Boltzmann + Purity + Network)
% Logic: 5.2 (Indexed Tuple P,T,E,S + Coupling + Purity + Network Drift)
% Generated: 2024-07-16
% ============================================================================

:- module(constraint_us_two_party_duopoly, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    narrative_ontology:constraint_claim/2,
    narrative_ontology:coordination_type/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: us_two_party_duopoly
 * human_readable: The U.S. Two-Party Political Duopoly
 * domain: political
 * * SUMMARY:
 * The U.S. electoral landscape is structurally locked into a two-party system
 * via "winner-take-all" mechanics, high ballot access barriers, and campaign
 * finance laws. While it provides a mechanism for stable governance (a coordination
 * function), it extracts political representation from a significant portion of
 * the electorate who desire more options, creating a structural trap for
 * alternative political movements.
 * * KEY AGENTS:
 * - Independent/Third-Party Voters: Subject (Powerless)
 * - Major Party Leadership/Strategists: Beneficiary (Institutional)
 * - Political Scientists/Systems Analysts: Auditor (Analytical)
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Base extractiveness (0.75): Captures the vast majority of political power and
% representation, despite significant voter dissatisfaction with the binary choice.
domain_priors:base_extractiveness(us_two_party_duopoly, 0.75).

% Suppression (0.80): High ballot access barriers, restrictive debate inclusion
% criteria (e.g., 15% polling threshold), and campaign finance structures
% actively suppress viable alternatives.
domain_priors:suppression_score(us_two_party_duopoly, 0.80).

% Theater Ratio (0.15): While political theater is high, the core functions of
% governance and power consolidation are very real. The ratio of performative
% to functional activity is relatively low.
domain_priors:theater_ratio(us_two_party_duopoly, 0.15).

% Constraint metric facts — primary keys used by the classification engine.
narrative_ontology:constraint_metric(us_two_party_duopoly, extractiveness, 0.75).
narrative_ontology:constraint_metric(us_two_party_duopoly, suppression_requirement, 0.80).
narrative_ontology:constraint_metric(us_two_party_duopoly, theater_ratio, 0.15).

% Constraint self-claim: The system is presented as a necessary mechanism for
% stable governance and preventing fragmentation.
narrative_ontology:constraint_claim(us_two_party_duopoly, coordination).

% Binary flags
domain_priors:requires_active_enforcement(us_two_party_duopoly). % Ballot access laws, FEC regulations.

% Structural property derivation hooks:
narrative_ontology:constraint_beneficiary(us_two_party_duopoly, major_political_parties).
narrative_ontology:constraint_victim(us_two_party_duopoly, independent_voters).
narrative_ontology:constraint_victim(us_two_party_duopoly, third_party_movements).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   ========================================================================== */

% PERSPECTIVE 1: THE DISILLUSIONED VOTER (SNARE)
% From the perspective of a voter desiring alternative representation, the
% system is a trap. Their vote feels wasted or forced into a "lesser of two
% evils" choice, with high effective extraction of their political agency.
% χ = 0.75 * 1.5 (powerless) * 1.0 (national) = 1.125
constraint_indexing:constraint_classification(us_two_party_duopoly, snare,
    context(agent_power(powerless),
            time_horizon(biographical),
            exit_options(trapped),
            spatial_scope(national))).

% PERSPECTIVE 2: THE PARTY STRATEGIST (ROPE)
% For an institutional actor within one of the major parties, the system is a
% pure coordination mechanism. It simplifies the political landscape, channels
% resources efficiently, and provides a stable path to power.
% χ = 0.75 * -0.2 (institutional) * 1.0 (national) = -0.15
constraint_indexing:constraint_classification(us_two_party_duopoly, rope,
    context(agent_power(institutional),
            time_horizon(generational),
            exit_options(mobile),
            spatial_scope(national))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (TANGLED ROPE)
% The analyst sees both functions simultaneously. The system coordinates
% governance (Rope aspect) but does so via coercive suppression of alternatives,
% leading to asymmetric extraction of political capital (Snare aspect).
% χ = 0.75 * 1.15 (analytical) * 1.2 (global) = 1.035
constraint_indexing:constraint_classification(us_two_party_duopoly, tangled_rope,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(us_two_party_duopoly_tests).

test(perspectival_gap_voter_vs_strategist) :-
    constraint_indexing:constraint_classification(us_two_party_duopoly, TypePowerless,
        context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(us_two_party_duopoly, TypeInstitutional,
        context(agent_power(institutional), _, _, _)),
    assertion(TypePowerless == snare),
    assertion(TypeInstitutional == rope),
    assertion(TypePowerless \= TypeInstitutional).

test(analytical_observer_sees_tangled_rope) :-
    constraint_indexing:constraint_classification(us_two_party_duopoly, TypeAnalytical,
        context(agent_power(analytical), _, _, _)),
    assertion(TypeAnalytical == tangled_rope).

test(threshold_validation_high_extraction) :-
    narrative_ontology:constraint_metric(us_two_party_duopoly, extractiveness, E),
    assertion(E >= 0.46).

:- end_tests(us_two_party_duopoly_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * The U.S. two-party system is a canonical example of a Tangled Rope. Its
 * scores reflect a high degree of functional extraction (0.75) and active
 * suppression of alternatives (0.80).
 *
 * The Perspectival Gap is stark:
 * - For the powerless voter, the system is a Snare, extracting their
 *   representative will by making alternative choices non-viable.
 * - For the institutional party member, it's a Rope, a tool for coordinating
 *   power and ensuring stability.
 * - The analytical view, which requires acknowledging both the coordination
 *   function and the asymmetric extraction, correctly identifies it as a
 *   Tangled Rope.
 *
 * MANDATROPHY ANALYSIS:
 * This constraint is marked as having [RESOLVED MANDATROPHY] because the
 * Tangled Rope classification itself is the resolution. It prevents the system
 * from making a binary choice between "it's all coordination" (the institutional
 * view) and "it's all extraction" (the powerless view). The classification
 * forces an acknowledgment that both are true simultaneously, which is the
 * core insight.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_us_two_party_duopoly,
    'Will systemic reforms like Ranked Choice Voting (RCV) or the abolition of the Electoral College fundamentally reduce the duopoly''s extractive power?',
    'Monitor state-level adoption of RCV and federal electoral reform bills over the next decade. Track changes in third-party vote share and candidate viability in reformed jurisdictions.',
    'If reforms are effective, base_extractiveness and suppression_score would decrease, potentially shifting the analytical classification from Tangled Rope to Rope. If ineffective, the constraint remains a Tangled Rope.',
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

narrative_ontology:interval(us_two_party_duopoly, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% The duopoly has become more entrenched and extractive over time due to
% increasing polarization and legal fortifications.
%
% Theater ratio over time:
narrative_ontology:measurement(us_two_party_duopoly_tr_t0, us_two_party_duopoly, theater_ratio, 0, 0.10).
narrative_ontology:measurement(us_two_party_duopoly_tr_t5, us_two_party_duopoly, theater_ratio, 5, 0.12).
narrative_ontology:measurement(us_two_party_duopoly_tr_t10, us_two_party_duopoly, theater_ratio, 10, 0.15).

% Extraction over time:
narrative_ontology:measurement(us_two_party_duopoly_ex_t0, us_two_party_duopoly, base_extractiveness, 0, 0.65).
narrative_ontology:measurement(us_two_party_duopoly_ex_t5, us_two_party_duopoly, base_extractiveness, 5, 0.70).
narrative_ontology:measurement(us_two_party_duopoly_ex_t10, us_two_party_duopoly, base_extractiveness, 10, 0.75).

/* ==========================================================================
   9. BOLTZMANN & NETWORK DATA (v5.0-5.2)
   ========================================================================== */

% The duopoly functions as a mechanism to enforce a specific political structure.
narrative_ontology:coordination_type(us_two_party_duopoly, enforcement_mechanism).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */% ============================================================================
% CONSTRAINT STORY: usc_26_469_passive_loss
% ============================================================================
% Version: 5.2 (Deferential Realism Core + Boltzmann + Purity + Network)
% Logic: 5.2 (Indexed Tuple P,T,E,S + Coupling + Purity + Network Drift)
% Generated: 2024-07-27
% ============================================================================

:- module(constraint_usc_26_469_passive_loss, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    narrative_ontology:constraint_claim/2,
    narrative_ontology:affects_constraint/2,
    narrative_ontology:coordination_type/2,
    narrative_ontology:boltzmann_floor_override/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: usc_26_469_passive_loss
 * human_readable: Passive Activity Loss (PAL) Rules
 * domain: economic/legal
 * * SUMMARY:
 * Established by the Tax Reform Act of 1986, Section 469 prohibits taxpayers
 * from using losses from "passive activities" (rental properties or businesses
 * without material participation) to offset active income (wages) or portfolio
 * income. It creates a "walled garden" for losses that can only be exited
 * upon the total disposition of the activity.
 * * KEY AGENTS:
 * - Small-scale Landlord / Passive Investor: Subject (Powerless). Trapped by suspended losses.
 * - Internal Revenue Service / US Treasury: Beneficiary (Institutional). Protects tax base
 * against "tax shelters."
 * - Tax Auditor / Policy Analyst: Auditor (Analytical). Tracks the drift from policy intent
 * to administrative complexity.
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% High extraction (0.58) because losses are effectively "confiscated" by deferral
% until a future, undetermined date of sale, creating a significant time-value
% cost.
domain_priors:base_extractiveness(usc_26_469_passive_loss, 0.58).

% High suppression (0.85); no legal alternative exists for the taxpayer to
% recognize these economic losses against other income within the US jurisdiction.
domain_priors:suppression_score(usc_26_469_passive_loss, 0.85).

% Low-moderate theater ratio; the law is highly functional but contains
% "performative" complexity in "Material Participation" testing.
domain_priors:theater_ratio(usc_26_469_passive_loss, 0.25).

% Constraint metric facts — primary keys used by the classification engine.
narrative_ontology:constraint_metric(usc_26_469_passive_loss, extractiveness, 0.58).
narrative_ontology:constraint_metric(usc_26_469_passive_loss, suppression_requirement, 0.85).
narrative_ontology:constraint_metric(usc_26_469_passive_loss, theater_ratio, 0.25).

% The law claims to be a coordination mechanism to ensure tax fairness.
narrative_ontology:constraint_claim(usc_26_469_passive_loss, coordination).

% Binary flags and structural properties for Tangled Rope classification.
domain_priors:requires_active_enforcement(usc_26_469_passive_loss).
narrative_ontology:constraint_beneficiary(usc_26_469_passive_loss, us_treasury).
narrative_ontology:constraint_victim(usc_26_469_passive_loss, passive_activity_investors).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   ========================================================================== */

% PERSPECTIVE 1: THE SUBJECT (SNARE)
% The individual investor perceives the disallowance as a predatory trap.
% Losses are real cash-out-the-door, but the deduction is "snared" by the code.
constraint_indexing:constraint_classification(usc_26_469_passive_loss, snare,
    context(agent_power(powerless),
            time_horizon(biographical),
            exit_options(trapped),
            spatial_scope(national))).

% PERSPECTIVE 2: THE BENEFICIARY (ROPE)
% From the IRS perspective, Section 469 is essential coordination. It prevents
% a "race to the bottom" where the wealthy use artificial paper losses to
% zero out their tax liability, ensuring the "Rope" of the tax base holds.
constraint_indexing:constraint_classification(usc_26_469_passive_loss, rope,
    context(agent_power(institutional),
            time_horizon(generational),
            exit_options(mobile),
            spatial_scope(national))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (TANGLED ROPE)
% The auditor recognizes that while it solves the "tax shelter" problem (Coordination),
% it also extracts high compliance costs and penalizes legitimate
% small-business failures (Asymmetric Extraction).
constraint_indexing:constraint_classification(usc_26_469_passive_loss, tangled_rope,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(usc_26_469_passive_loss_tests).

test(perspectival_gap) :-
    % Verify there is a perspectival gap between powerless and institutional.
    constraint_indexing:constraint_classification(usc_26_469_passive_loss, TypePowerless, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(usc_26_469_passive_loss, TypeInstitutional, context(agent_power(institutional), _, _, _)),
    TypePowerless \= TypeInstitutional,
    TypePowerless == snare,
    TypeInstitutional == rope.

test(analytical_classification_is_tangled_rope) :-
    % Verify the analytical observer correctly identifies the hybrid nature.
    constraint_indexing:constraint_classification(usc_26_469_passive_loss, tangled_rope, context(agent_power(analytical), _, _, _)).

test(extraction_threshold_for_high_extraction_rules) :-
    narrative_ontology:constraint_metric(usc_26_469_passive_loss, extractiveness, E),
    E >= 0.46.

:- end_tests(usc_26_469_passive_loss_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * The Perspectival Gap is stark. For the Subject, money is fungible, so the
 * "walling off" of losses feels like an arbitrary Snare confiscating a real
 * economic loss. For the Beneficiary (the state), this wall is a necessary
 * Rope to prevent systemic extraction of public funds by private tax-arbitrageurs
 * creating artificial losses. The Tangled Rope classification is essential
 * because the constraint possesses both a genuine, system-preserving coordination
 * function AND a clear, asymmetrically extractive effect on a specific class
 * of investor.
 *
 * [RESOLVED MANDATROPHY]
 * The high extraction (0.58) is not a result of "atrophy" but of a
 * deliberate legislative choice to prioritize systemic tax base stability over
 * individual investor liquidity. The system functions as designed, albeit harshly.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_469_participation,
    'Is the 750-hour "Material Participation" threshold a functional filter for active business engagement or a theatrical barrier designed to be difficult to meet?',
    'Analysis of audit outcomes vs. actual business success in the Real Estate Professional category.',
    'If theatrical: Section 469 drifts toward Piton, as its exceptions become performative. If functional: it remains a Tangled Rope.',
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

narrative_ontology:interval(usc_26_469_passive_loss, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Theater ratio over time (Goodhart drift from simple rule to complex "Participation" games)
narrative_ontology:measurement(usc_469_tr_t0, usc_26_469_passive_loss, theater_ratio, 0, 0.10).
narrative_ontology:measurement(usc_469_tr_t5, usc_26_469_passive_loss, theater_ratio, 5, 0.18).
narrative_ontology:measurement(usc_469_tr_t10, usc_26_469_passive_loss, theater_ratio, 10, 0.25).

% Extraction over time (Increased accumulation of suspended losses in the economy)
narrative_ontology:measurement(usc_469_ex_t0, usc_26_469_passive_loss, base_extractiveness, 0, 0.48).
narrative_ontology:measurement(usc_469_ex_t5, usc_26_469_passive_loss, base_extractiveness, 5, 0.52).
narrative_ontology:measurement(usc_469_ex_t10, usc_26_469_passive_loss, base_extractiveness, 10, 0.58).

/* ==========================================================================
   9. BOLTZMANN & NETWORK DATA (v5.0-5.2)
   ========================================================================== */

% This law is a core part of the tax code's enforcement apparatus.
narrative_ontology:coordination_type(usc_26_469_passive_loss, enforcement_mechanism).

% The disposition of a passive activity, which releases suspended losses,
% is often a capital transaction, structurally linking this rule to capital gains.
narrative_ontology:affects_constraint(usc_26_469_passive_loss, capital_gains_taxation).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */% ============================================================================
% CONSTRAINT STORY: utopia_apocalypse_fragility
% ============================================================================
% Version: 5.2 (Deferential Realism Core + Boltzmann + Purity + Network)
% Logic: 5.2 (Indexed Tuple P,T,E,S + Coupling + Purity + Network Drift)
% Generated: 2024-07-15
% ============================================================================

:- module(constraint_utopia_apocalypse_fragility, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    narrative_ontology:constraint_claim/2,
    narrative_ontology:coordination_type/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: utopia_apocalypse_fragility
 * human_readable: The Utopia-Apocalypse Cliff-Edge
 * domain: social/political/philosophical
 * * SUMMARY:
 * This constraint describes the inherent fragility of social order (Utopia), which rests on
 * a "cliff-edge" and can transition into Apocalypse through slight shifts in structure,
 * personnel, or culture. It posits that life is a stochastic migration
 * from safety to catastrophe. The maintenance of "Utopia" requires active enforcement of
 * norms and structures to prevent this slide.
 * * KEY AGENTS:
 * - The Utopian Strategist: Institutional rule-shaper using coordination and science to manage the cliff.
 * - The Moderate Citizen: A citizen who benefits from Utopia but is vulnerable to the cliff's extraction.
 * - The Victim of Calamity: The individual pushed from safety into horror by systemic shifts.
 * - The Existential Realist: The observer who recognizes the secondary nature of truth to stories.
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(utopia_apocalypse_fragility, 0.7). % Snare extraction >= 0.46
domain_priors:suppression_score(utopia_apocalypse_fragility, 0.6).
domain_priors:theater_ratio(utopia_apocalypse_fragility, 0.1).

% Constraint metric facts — primary keys used by the classification engine.
narrative_ontology:constraint_metric(utopia_apocalypse_fragility, extractiveness, 0.7).
narrative_ontology:constraint_metric(utopia_apocalypse_fragility, suppression_requirement, 0.6).
narrative_ontology:constraint_metric(utopia_apocalypse_fragility, theater_ratio, 0.1).

% Constraint self-claim (what does the constraint claim to be?)
% Analytically, the stochastic nature of existence is claimed as an unchangeable law.
narrative_ontology:constraint_claim(utopia_apocalypse_fragility, natural_law).

% Binary flags
% The maintenance of "Utopia" requires constant, active effort to prevent the slide.
domain_priors:requires_active_enforcement(utopia_apocalypse_fragility).

% Structural property derivation hooks:
% Systemic transformation benefits from the destruction of the old state.
narrative_ontology:constraint_beneficiary(utopia_apocalypse_fragility, systemic_transformation).
% Individual human agency is systematically victimized by catastrophic shifts.
narrative_ontology:constraint_victim(utopia_apocalypse_fragility, individual_human_agency).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   ========================================================================== */

% PERSPECTIVE 1: THE VICTIM OF CALAMITY (SNARE)
% The shift to horror is felt as a totalizing, predatory trap.
constraint_indexing:constraint_classification(utopia_apocalypse_fragility, snare,
    context(agent_power(powerless),
            time_horizon(immediate),
            exit_options(trapped),
            spatial_scope(local))).

% PERSPECTIVE 2: THE UTOPIAN STRATEGIST (ROPE)
% Views the system as a necessary coordination mechanism to manage fragility.
constraint_indexing:constraint_classification(utopia_apocalypse_fragility, rope,
    context(agent_power(institutional),
            time_horizon(generational),
            exit_options(mobile),
            spatial_scope(global))).

% PERSPECTIVE 3: THE MODERATE CITIZEN (TANGLED ROPE)
% Experiences the system as both beneficial coordination and a source of existential risk.
constraint_indexing:constraint_classification(utopia_apocalypse_fragility, tangled_rope,
    context(agent_power(moderate),
            time_horizon(biographical),
            exit_options(constrained),
            spatial_scope(national))).

% PERSPECTIVE 4: THE EXISTENTIAL REALIST (MOUNTAIN)
% Views the underlying fragility as an unchangeable, natural law of complex systems.
constraint_indexing:constraint_classification(utopia_apocalypse_fragility, mountain,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(utopia_apocalypse_fragility_tests).

test(perspectival_gap) :-
    % Verify the gap between the victim (Snare) and the strategist (Rope).
    constraint_indexing:constraint_classification(utopia_apocalypse_fragility, TypePowerless, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(utopia_apocalypse_fragility, TypeInstitutional, context(agent_power(institutional), _, _, _)),
    assertion(TypePowerless == snare),
    assertion(TypeInstitutional == rope),
    TypePowerless \= TypeInstitutional.

test(tangled_rope_emergence) :-
    % Verify that a moderate agent perceives the mixed nature of the constraint.
    constraint_indexing:constraint_classification(utopia_apocalypse_fragility, tangled_rope, context(agent_power(moderate), _, _, _)).

test(threshold_validation) :-
    % High extraction is required for Snare/Tangled Rope classifications.
    narrative_ontology:constraint_metric(utopia_apocalypse_fragility, extractiveness, E),
    assertion(E >= 0.46).

:- end_tests(utopia_apocalypse_fragility_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE: [RESOLVED MANDATROPHY]
 * The high extraction score (0.7) reflects the total loss of safety and agency for a victim
 * of systemic collapse. This triggers the Mandatrophy gate. The resolution is perspectival:
 * what is a catastrophic Snare for the victim is a necessary Rope of coordination for the
 * institutional strategist managing the system's fragility. The Tangled Rope classification
 * for the moderate citizen captures this duality, acknowledging both the coordination benefit
 * and the asymmetric extraction risk. The addition of `requires_active_enforcement` is critical,
 * as it grounds the Tangled Rope classification in the reality that "Utopia" is not a passive
 * state but one that requires continuous effort to maintain against stochastic decay.
 * The temporal data models this decay, showing extraction (fragility) increasing over time.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    utopia_apocalypse_fragility_omega1,
    'Is the shift from safety to calamity a functional necessity of stochastic systems or a predatory result of human failure?',
    'Audit of cultural shifts preceding the "fell wind" arrival',
    'If necessity: Mountain. If predatory choice: Snare.',
    confidence_without_resolution(medium)
).

omega_variable(
    utopia_apocalypse_fragility_omega2,
    'Can the strength of individual belief influence the underlying stochastic structure of the cliff-edge?',
    'Long-term tracking of social outcomes based on belief-strength metrics in fragile systems',
    'If potent: The cliff-edge is a manipulable Rope. If impotent: It is a fixed Mountain.',
    confidence_without_resolution(low)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

% Required for external script parsing
narrative_ontology:interval(utopia_apocalypse_fragility, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% This constraint's fragility (extraction) is modeled as increasing over time,
% representing systemic decay or entropy. This data is required because base_extractiveness > 0.46.

% Theater ratio over time (slight increase in performative management):
narrative_ontology:measurement(uaf_tr_t0, utopia_apocalypse_fragility, theater_ratio, 0, 0.0).
narrative_ontology:measurement(uaf_tr_t5, utopia_apocalypse_fragility, theater_ratio, 5, 0.05).
narrative_ontology:measurement(uaf_tr_t10, utopia_apocalypse_fragility, theater_ratio, 10, 0.1).

% Extraction over time (increasing fragility/risk):
narrative_ontology:measurement(uaf_ex_t0, utopia_apocalypse_fragility, base_extractiveness, 0, 0.5).
narrative_ontology:measurement(uaf_ex_t5, utopia_apocalypse_fragility, base_extractiveness, 5, 0.6).
narrative_ontology:measurement(uaf_ex_t10, utopia_apocalypse_fragility, base_extractiveness, 10, 0.7).

/* ==========================================================================
   9. BOLTZMANN & NETWORK DATA (v5.0-5.2)
   ========================================================================== */

% The management of the "cliff-edge" is a form of societal rule-setting.
narrative_ontology:coordination_type(utopia_apocalypse_fragility, enforcement_mechanism).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */