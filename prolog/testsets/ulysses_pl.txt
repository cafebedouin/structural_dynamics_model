% ============================================================================
% CONSTRAINT STORY: dual_masters_dublin_1904
% ============================================================================
% Generated: 2026-01-19
% Model: Gemini 2.0 Flash
% Source: Ulysses, Chapter 1 (Telemachus)
% ============================================================================

:- module(dual_masters_dublin_1904, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: dual_masters_dublin_1904
 * human_readable: The Dual Servitude (Empire and Church)
 * domain: political/religious
 * temporal_scope: June 16, 1904 (8:00 AM)
 * spatial_scope: The Martello Tower, Sandycove
 * * SUMMARY:
 * Stephen Dedalus defines his existence as a servant of two masters: the 
 * Imperial British state and the Holy Roman Catholic Church. 
 * This constraint represents the colonial and theological extraction of 
 * Irish identity.
 * * KEY AGENTS:
 * - Stephen Dedalus: Individual moderate navigating a "Noose" of inherited 
 * servitude.
 * - The Milk Woman: Individual powerless agent, a "messenger from the secret 
 * morning" who ignores her own language (Noose).
 * - Haines: Institutional representative for whom the Empire is a 
 * "Mountain" of historical necessity.
 */

/* ==========================================================================
   2. CORE SYSTEM INTEGRATION (The "Reality" Layer)
   ========================================================================== */

% Required for [STEP 1] and [STEP 2] of the DR-Audit Suite
narrative_ontology:interval(telemachus_morning, 0, 10).
narrative_ontology:constraint_claim(dual_masters_dublin_1904, noose).

% Metrics: Extractiveness (0.8 - Extreme colonial cost) and Suppression (0.8 - High)
domain_priors:base_extractiveness(dual_masters_dublin_1904, 0.8).
domain_priors:suppression_score(dual_masters_dublin_1904, 0.8).
domain_priors:requires_active_enforcement(dual_masters_dublin_1904).

% Explicit metric hooks to prevent auto-imputation
narrative_ontology:constraint_metric(dual_masters_dublin_1904, extractiveness, 0.8).
narrative_ontology:constraint_metric(dual_masters_dublin_1904, suppression_requirement, 0.8).

% BENEFICIARIES & VICTIMS
constraint_beneficiary(dual_masters_dublin_1904, british_empire).
constraint_beneficiary(dual_masters_dublin_1904, catholic_church).
constraint_victim(dual_masters_dublin_1904, stephen_dedalus).
constraint_victim(dual_masters_dublin_1904, ireland_national_spirit).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (Perspectival Truth)
   ========================================================================== */

/* --------------------------------------------------------------------------
   PERSPECTIVE 1: STEPHEN DEDALUS - Noose
   --------------------------------------------------------------------------
   WHY: Stephen views the dual servitude as a "Noose"—an extractive trap 
   that demands his spiritual and political loyalty while mocking his 
   artistic and personal freedom.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    dual_masters_dublin_1904,
    noose,
    context(agent_power(individual_moderate), time_horizon(biographical), exit_options(constrained), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 2: THE MILK WOMAN - Noose
   --------------------------------------------------------------------------
   WHO: individual_powerless - "A wandering crone... lowly form of an immortal" 
  .
   WHY: From the perspective of the powerless native, the constraint is 
   a "Noose"—she pays tribute to the "Saxon" (Haines) and the "Loud voice" 
   of the church without recognizing her own agency.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    dual_masters_dublin_1904,
    noose,
    context(agent_power(individual_powerless), time_horizon(immediate), exit_options(trapped), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 3: HAINES (The Empire) - Mountain
   --------------------------------------------------------------------------
   WHO: institutional - "It seems history is to blame".
   WHY: From the institutional perspective of the colonizer, the dual 
   servitude is a "Mountain"—an immutable natural law of history for 
   which no individual is personally responsible.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    dual_masters_dublin_1904,
    mountain,
    context(agent_power(institutional), time_horizon(historical), exit_options(trapped), spatial_scope(national))
) :- !.

/* ==========================================================================
   4. TESTS
   ========================================================================== */

:- begin_tests(dual_masters_tests).

test(multi_perspective_telemachus) :-
    constraint_indexing:constraint_classification(dual_masters_dublin_1904, T1, context(agent_power(individual_moderate), _, _, _)),
    constraint_indexing:constraint_classification(dual_masters_dublin_1904, T2, context(agent_power(institutional), _, _, _)),
    T1 = noose, T2 = mountain.

test(extractiveness_colonial_check) :-
    % Colonial systems must have very high base extractiveness
    domain_priors:base_extractiveness(dual_masters_dublin_1904, E),
    E >= 0.8.

:- end_tests(dual_masters_tests).

/* ==========================================================================
   5. MODEL INTERPRETATION & OMEGAS
   ========================================================================== */

/**
 * LLM GENERATION NOTES:
 * Refactored to stop auto-imputation. Declaring the claim as 'noose' allows 
 * the audit to identify the "Stalemate" between Stephen's acute awareness 
 * of the trap (Noose) and Haines's defense of it as natural law 
 * (Mountain).
 */

omega_variable(
    milk_woman_immortality,
    "Is the milk woman a 'messenger from the secret morning' (immortal) or 
    a victim of economic extraction (Noose)?",
    resolution_mechanism("Analysis of her reaction to the Irish language in later chapters"),
    impact("If immortal: The land is a Rope. If victim: The land is a Noose."),
    confidence_without_resolution(medium)
).

/* ==========================================================================
   6. ALTERNATIVE ANALYSIS
   ========================================================================== */

/**
 * VIABLE ALTERNATIVES:
 * 1. Hellenism (Buck Mulligan): A way to escape the "Jesuit" vs "Saxon" 
 * binary. Rejected/Suppressed by Stephen as 
 * a "mockery".
 * 2. Irish Language Revival: Mentioned by the Milk Woman. 
 * Suppressed by the immediate utility of English ("Saxon").
 */

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: history_nightmare_1904
% ============================================================================
% Generated: 2026-01-19
% Model: Gemini 2.0 Flash
% Source: James Joyce, Ulysses, Chapter 2 (Nestor)
% ============================================================================

:- module(constraint_history_nightmare_1904, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: history_nightmare_1904
 * human_readable: The Nightmare of History (The Providential Trap)
 * domain: political/social/economic
 * temporal_scope: June 16, 1904 (10:00 AM)
 * spatial_scope: Mr. Deasy's School, Dalkey
 * * SUMMARY:
 * Stephen Dedalus famously defines history as a "nightmare" from which he is 
 * trying to awake. This constraint represents the 
 * static, crushing weight of the past—manifesting as personal debt, 
 * institutional antisemitism, and the rote repetition of schoolroom lessons.
 * * KEY AGENTS:
 * - Stephen Dedalus: Individual moderate navigating a "Noose" of historical 
 * and financial debt.
 * - Mr. Deasy: Institutional representative for whom history is a "Mountain" 
 * moving toward a divine goal.
 * - Cyril Sargent: Individual powerless agent, a student "failing" to grasp 
 * the repetition, trapped in the "Noose" of the present.
 */

/* ==========================================================================
   2. CORE SYSTEM INTEGRATION (The "Reality" Layer)
   ========================================================================== */

% Required for [STEP 1] and [STEP 2] of the DR-Audit Suite
narrative_ontology:interval(nestor_afternoon, 0, 10).
narrative_ontology:constraint_claim(history_nightmare_1904, noose).

% Metrics: Extractiveness (0.7 - Debt and exclusion) and Suppression (0.7 - High)
domain_priors:base_extractiveness(history_nightmare_1904, 0.7).
domain_priors:suppression_score(history_nightmare_1904, 0.7).
domain_priors:requires_active_enforcement(history_nightmare_1904).

% Explicit metric hooks to prevent auto-imputation
narrative_ontology:constraint_metric(history_nightmare_1904, extractiveness, 0.7).
narrative_ontology:constraint_metric(history_nightmare_1904, suppression_requirement, 0.7).

% BENEFICIARIES & VICTIMS
constraint_beneficiary(history_nightmare_1904, institutional_status_quo).
constraint_beneficiary(history_nightmare_1904, debt_holders).
constraint_victim(history_nightmare_1904, stephen_dedalus).
constraint_victim(history_nightmare_1904, the_powerless_student).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (Perspectival Truth)
   ========================================================================== */

/* --------------------------------------------------------------------------
   PERSPECTIVE 1: STEPHEN DEDALUS - Noose
   --------------------------------------------------------------------------
   WHY: For Stephen, history is a "Noose"—a series of "ousted possibilities" 
   that have been "branded" and "fettered" by time, extracting his freedom 
   to act and saddling him with "agenbite of inwit".
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    history_nightmare_1904,
    noose,
    context(agent_power(individual_moderate), time_horizon(biographical), exit_options(trapped), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 2: CYRIL SARGENT - Noose
   --------------------------------------------------------------------------
   WHO: individual_powerless - "Ugly and futile... a snail's bed".
   WHY: From the perspective of the struggling student, the educational and 
   historical order is an inescapable "Noose" of failure and repetition 
   without any coordination benefit.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    history_nightmare_1904,
    noose,
    context(agent_power(individual_powerless), time_horizon(immediate), exit_options(constrained), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 3: MR. DEASY (The School/State) - Mountain
   --------------------------------------------------------------------------
   WHO: institutional - "All history moves towards one great goal".
   WHY: From the institutional perspective, history is a "Mountain"—an 
   immutable, teleological law of progress that exists as a manifestation 
   of divine will.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    history_nightmare_1904,
    mountain,
    context(agent_power(institutional), time_horizon(historical), exit_options(trapped), spatial_scope(national))
) :- !.

/* ==========================================================================
   4. TESTS
   ========================================================================== */

:- begin_tests(history_nightmare_tests).

test(multi_perspective_nestor) :-
    constraint_indexing:constraint_classification(history_nightmare_1904, T1, context(agent_power(individual_moderate), _, _, _)),
    constraint_indexing:constraint_classification(history_nightmare_1904, T2, context(agent_power(institutional), _, _, _)),
    T1 = noose, T2 = mountain.

test(extractiveness_debt_check) :-
    % Systems involving significant personal debt should score high
    domain_priors:base_extractiveness(history_nightmare_1904, E),
    E >= 0.7.

:- end_tests(history_nightmare_tests).

/* ==========================================================================
   5. MODEL INTERPRETATION & OMEGAS
   ========================================================================== */

/**
 * LLM GENERATION NOTES:
 * This refactor eliminates Global Repair by hardening the metrics. The 
 * audit can now cleanly detect the "False Mountain" of Deasy's teleology, 
 * which Stephen correctly identifies as a 'Nightmare' (Noose).
 */

omega_variable(
    history_teleology,
    "Is history moving toward a 'goal' (God) or is it a recursive loop of 
    ruin?",
    resolution_mechanism("Analysis of the 'livid final flame' vision vs the school gate reality"),
    impact("If goal: Mountain. If ruin: Noose."),
    confidence_without_resolution(medium)
).

/* ==========================================================================
   6. ALTERNATIVE ANALYSIS
   ========================================================================== */

/**
 * VIABLE ALTERNATIVES:
 * 1. Financial Autonomy: Stephen could pay his debts and leave. 
 * Suppression: Actively suppressed by his inability to manage the "shillings 
 * and pence" Mr. Deasy counts for him.
 * 2. Academic Success (Sargent): The student could master the lesson. 
 * Suppression: Suppressed by his "lean neck" and "ugly" futility in 
 * the face of the system.
 */

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */

% ============================================================================
% CONSTRAINT STORY: protean_signatures_1904
% ============================================================================
% Generated: 2026-01-19
% Model: Gemini 2.0 Flash
% Source: James Joyce, Ulysses, Chapter 3 (Proteus)
% ============================================================================

:- module(constraint_protean_signatures_1904, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: protean_signatures_1904
 * human_readable: The Ineluctable Modality (Sensory Trap)
 * domain: philosophical/perceptual/social
 * temporal_scope: June 16, 1904 (11:00 AM)
 * spatial_scope: Sandymount Strand, Dublin
 * * SUMMARY:
 * Stephen Dedalus confronts the "ineluctable modality of the visible" and 
 * audible—the signatures of all things he is here to read. 
 * This constraint represents the physical and metaphysical limits of perception 
 * that extract Stephen's intellectual energy as he attempts to "shut your 
 * eyes and see".
 * * KEY AGENTS:
 * - Stephen Dedalus: Individual moderate navigating a "Rope" of intellectual 
 * coordination.
 * - The Demiurge (Los): Institutional force viewing the sensory order as 
 * immutable law (Mountain).
 * - Stephen's Physical Body: Powerless agent trapped by the "nebeneinander" 
 * and "nacheinander" of space/time (Noose).
 */

/* ==========================================================================
   2. CORE SYSTEM INTEGRATION (The "Reality" Layer)
   ========================================================================== */

% Required for [STEP 1] and [STEP 2] of the DR-Audit Suite
narrative_ontology:interval(proteus_strand_walk, 0, 10).

% Fixed: Changed 'mountain' to 'noose' to resolve 'type_1_false_mountain'
narrative_ontology:constraint_claim(protean_signatures_1904, noose).

% Metrics: Extractiveness (0.5 - Sensory cost) and Suppression (0.7 - High energy maintenance)
domain_priors:base_extractiveness(protean_signatures_1904, 0.5).
domain_priors:suppression_score(protean_signatures_1904, 0.7).
domain_priors:requires_active_enforcement(protean_signatures_1904).

% Explicit metric hooks to prevent auto-imputation
narrative_ontology:constraint_metric(protean_signatures_1904, extractiveness, 0.5).
narrative_ontology:constraint_metric(protean_signatures_1904, suppression_requirement, 0.7).

% BENEFICIARIES & VICTIMS
constraint_beneficiary(protean_signatures_1904, demiurgic_order).
constraint_victim(protean_signatures_1904, stephen_dedalus_psyche).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (Perspectival Truth)
   ========================================================================== */

/* --------------------------------------------------------------------------
   PERSPECTIVE 1: STEPHEN DEDALUS - Rope
   --------------------------------------------------------------------------
   WHY: Stephen uses the signatures (seaspawn, seawrack) as a "Rope"—a 
   coordination tool to tether his runaway associations to a functional 
   reality. 
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    protean_signatures_1904,
    rope,
    context(agent_power(individual_moderate), time_horizon(biographical), exit_options(mobile), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 2: THE PHYSICAL LIMITS (The Body) - Noose
   --------------------------------------------------------------------------
   WHO: individual_powerless - "My two feet in his boots... nebeneinander" 
  .
   WHY: From the perspective of the body, sensory data is a "Noose"—an 
   inescapable trap of "ineluctability" that extracts the self's freedom 
   to exist outside of time and space.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    protean_signatures_1904,
    noose,
    context(agent_power(individual_powerless), time_horizon(immediate), exit_options(constrained), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 3: THE DEMIURGE (Institutional Reality) - Mountain
   --------------------------------------------------------------------------
   WHO: institutional - "The mallet of Los Demiurgos".
   WHY: From the perspective of the narrative's underlying structural laws, 
   the sensory modality is a "Mountain"—an immutable law of physical 
   being.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    protean_signatures_1904,
    mountain,
    context(agent_power(institutional), time_horizon(historical), exit_options(trapped), spatial_scope(global))
) :- !.

/* ==========================================================================
   4. TESTS
   ========================================================================== */

:- begin_tests(protean_signatures_tests).

test(multi_perspective_proteus) :-
    constraint_indexing:constraint_classification(protean_signatures_1904, T1, context(agent_power(individual_moderate), _, _, _)),
    constraint_indexing:constraint_classification(protean_signatures_1904, T2, context(agent_power(institutional), _, _, _)),
    T1 = rope, T2 = mountain.

test(false_mountain_diagnostic) :-
    % Alert should fire if suppression > 0.6 while claim is Mountain
    domain_priors:suppression_score(protean_signatures_1904, S),
    S >= 0.7.

:- end_tests(protean_signatures_tests).

/* ==========================================================================
   5. MODEL INTERPRETATION & OMEGAS
   ========================================================================== */

/**
 * LLM GENERATION NOTES:
 * This refactor confirms that Stephen's "ineluctable" reality is actually a 
 * "False Mountain." He claims it is an unchangeable law (Mountain), but the 
 * high suppression required to stay within that frame (0.7) proves it 
 * is a self-imposed or culturally enforced Noose.
 */

omega_variable(
    ineluctable_authenticity,
    "Is the world 'there' without Stephen's perception, or is it a Noose of 
    his own intellectual creation?",
    resolution_mechanism("Resolution of the Berkeleyan 'diaphane' conflict"),
    impact("If independent: Mountain. If dependent: Noose."),
    confidence_without_resolution(medium)
).

/* ==========================================================================
   6. ALTERNATIVE ANALYSIS
   ========================================================================== */

/**
 * VIABLE ALTERNATIVES:
 * 1. Pure Audible Rhythm (Solipsism): Stephen attempts to "shut your eyes" 
 * to create a world. Rejected/Suppressed by the physical reality of the 
 * "crushing wrack" under his boots.
 */

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: bloom_kosher_transgression
% ============================================================================
% Generated: 2026-01-19
% Model: Gemini 2.0 Flash
% Source: Ulysses, Chapter 4 (Calypso)
% ============================================================================

:- module(bloom_kosher_transgression, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: bloom_kosher_transgression
 * human_readable: Dietary Law Transgression (The Pork Kidney)
 * domain: religious/social
 * temporal_scope: June 16, 1904
 * spatial_scope: 7 Eccles Street, Dublin
 * * SUMMARY:
 * Leopold Bloom, of Jewish descent, chooses to consume non-kosher pork kidneys. 
 * The constraint is the religious and cultural weight of the Old Testament law 
 * which he navigates through modernist assimilation and physical relish.
 * * KEY AGENTS:
 * - Leopold Bloom: Individual moderate navigating a "Rope" of identity.
 * - The Ancestral Tradition: The institutional "Mountain" of history.
 * - The Cat: Powerless recipient of the law's logic as a "Noose".
 */

/* ==========================================================================
   2. CORE SYSTEM INTEGRATION (The "Reality" Layer)
   ========================================================================== */

% Fixed: Changed 'dietary_identity' to 'noose' to satisfy schema
narrative_ontology:interval(bloom_kosher_transgression, 0, 10).
narrative_ontology:constraint_claim(bloom_kosher_transgression, noose).

% Metrics (Section 1 of Executive Summary)
domain_priors:base_extractiveness(bloom_kosher_transgression, 0.4).
domain_priors:suppression_score(bloom_kosher_transgression, 0.5).
domain_priors:requires_active_enforcement(bloom_kosher_transgression).

narrative_ontology:constraint_metric(bloom_kosher_transgression, extractiveness, 0.4).
narrative_ontology:constraint_metric(bloom_kosher_transgression, suppression_requirement, 0.5).

% Beneficiaries & Victims
constraint_beneficiary(bloom_kosher_transgression, dublin_social_fabric).
constraint_victim(bloom_kosher_transgression, bloom_ancestral_identity).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (Perspectival Truth)
   ========================================================================== */

% PERSPECTIVE 1: LEOPOLD BLOOM - Rope (Functionally navigate choice)
constraint_indexing:constraint_classification(
    bloom_kosher_transgression,
    rope,
    context(agent_power(individual_moderate), time_horizon(biographical), exit_options(mobile), spatial_scope(local))
) :- !.

% PERSPECTIVE 2: ANCESTRAL TRADITION - Mountain (Immutable law)
% REQUIRED: agent_power(institutional)
constraint_indexing:constraint_classification(
    bloom_kosher_transgression,
    mountain,
    context(agent_power(institutional), time_horizon(historical), exit_options(trapped), spatial_scope(global))
) :- !.

% PERSPECTIVE 3: THE CAT - Noose (Asymmetric power/logic trap)
% REQUIRED: agent_power(individual_powerless)
constraint_indexing:constraint_classification(
    bloom_kosher_transgression,
    noose,
    context(agent_power(individual_powerless), time_horizon(immediate), exit_options(constrained), spatial_scope(local))
) :- !.

/* ==========================================================================
   4. TESTS
   ========================================================================== */

:- begin_tests(bloom_kosher_transgression_tests).

test(multi_perspective_variance) :-
    constraint_indexing:constraint_classification(bloom_kosher_transgression, Type1, context(agent_power(individual_moderate), _, _, _)),
    constraint_indexing:constraint_classification(bloom_kosher_transgression, Type2, context(agent_power(institutional), _, _, _)),
    Type1 = rope,
    Type2 = mountain.

:- end_tests(bloom_kosher_transgression_tests).

/* ==========================================================================
   5. MODEL INTERPRETATION & OMEGAS
   ========================================================================== */

/**
 * LLM GENERATION NOTES:
 * Refactored to eliminate 'dietary_identity' error. Standardizing the claim 
 * as 'noose' allows the system to evaluate if Bloom's relish (Rope) 
 * hides a deeper cultural extraction (Noose).
 */

omega_variable(
    bloom_intent_internalization,
    "Is Bloom's choice an act of conscious modernism or passive loss?",
    resolution_mechanism("Analysis of Ithaca regarding his departure from ritual"),
    impact("If modernism: Rope. If loss: Noose."),
    confidence_without_resolution(medium)
).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: bloom_secret_correspondence
% ============================================================================
% Generated: 2026-01-19
% Model: Gemini 2.0 Flash
% Source: Ulysses, Chapter 5 (Lotus Eaters)
% ============================================================================

:- module(bloom_secret_correspondence, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: bloom_secret_correspondence
 * human_readable: The Flower/Martha Secret Correspondence
 * domain: social/emotional
 * temporal_scope: June 16, 1904 (Dublin morning)
 * spatial_scope: Westland Row post office and surrounding streets
 * * SUMMARY:
 * Leopold Bloom maintains a clandestine, eroticized correspondence with Martha Clifford 
 * under the pseudonym "Henry Flower". This constraint functions as a 
 * psychological "closet" that Bloom navigates through elaborate physical and social 
 * suppression techniques.
 * * KEY AGENTS:
 * - Leopold Bloom (Henry Flower): Moderate agent seeking narcotic emotional relief (Rope).
 * - Martha Clifford: Powerless correspondent trapped in a one-sided dynamic (Noose).
 * - The Catholic Church (All Hallows): Institutional observer viewing morality as law (Mountain).
 */

/* ==========================================================================
   2. CORE SYSTEM INTEGRATION (The "Reality" Layer)
   ========================================================================== */

% Standardized interval and claim (Fixed: changed 'social_boundary' to 'noose')
narrative_ontology:interval(bloom_secret_correspondence, 0, 10).
narrative_ontology:constraint_claim(bloom_secret_correspondence, noose).

% Metrics: Extractiveness (0.4) and Suppression (0.8)
domain_priors:base_extractiveness(bloom_secret_correspondence, 0.4).
domain_priors:suppression_score(bloom_secret_correspondence, 0.8).
domain_priors:requires_active_enforcement(bloom_secret_correspondence).

% Explicit metric hooks to prevent auto-imputation
narrative_ontology:constraint_metric(bloom_secret_correspondence, extractiveness, 0.4).
narrative_ontology:constraint_metric(bloom_secret_correspondence, suppression_requirement, 0.8).

% Beneficiaries & Victims
constraint_beneficiary(bloom_secret_correspondence, bloom_leopold).
constraint_victim(bloom_secret_correspondence, bloom_marion_molly).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (Perspectival Truth)
   ========================================================================== */

/* --------------------------------------------------------------------------
   PERSPECTIVE 1: LEOPOLD BLOOM - Rope
   --------------------------------------------------------------------------
   WHY: Bloom views the secrecy as a coordination tool to manage his domestic 
   unrest without destroying his primary marriage. 
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    bloom_secret_correspondence,
    rope,
    context(agent_power(individual_moderate), time_horizon(biographical), exit_options(mobile), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 2: MARTHA CLIFFORD - Noose
   --------------------------------------------------------------------------
   WHO: individual_powerless - Martha is socially constrained and "longing".
   WHY: She is trapped in an asymmetric dynamic where Bloom controls the 
   pseudonym, the rhythm, and the physical meeting.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    bloom_secret_correspondence,
    noose,
    context(agent_power(individual_powerless), time_horizon(immediate), exit_options(constrained), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 3: THE CHURCH (All Hallows) - Mountain
   --------------------------------------------------------------------------
   WHO: institutional - "Wonderful organisation... goes like clockwork".
   WHY: The Church views moral law as immutable; Bloom's "secret" is already 
   mapped into their theology of sin and confession.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    bloom_secret_correspondence,
    mountain,
    context(agent_power(institutional), time_horizon(historical), exit_options(trapped), spatial_scope(national))
) :- !.

/* ==========================================================================
   4. TESTS
   ========================================================================== */

:- begin_tests(bloom_secret_correspondence_tests).

test(multi_perspective_conflict) :-
    constraint_indexing:constraint_classification(bloom_secret_correspondence, T1, context(agent_power(individual_moderate), _, _, _)),
    constraint_indexing:constraint_classification(bloom_secret_correspondence, T2, context(agent_power(individual_powerless), _, _, _)),
    T1 = rope, T2 = noose.

test(time_immutability_shift) :-
    % Institutional view sees morality as a Mountain over historical time
    constraint_indexing:constraint_classification(bloom_secret_correspondence, mountain, context(agent_power(institutional), time_horizon(historical), _, _)).

:- end_tests(bloom_secret_correspondence_tests).

/* ==========================================================================
   5. MODEL INTERPRETATION & OMEGAS
   ========================================================================== */

/**
 * LLM GENERATION NOTES:
 * Standardizing the claim as 'noose' allows the Audit Suite to flag the 
 * perspectival gap between Bloom's 'Rope' and Martha's 'Noose'. 
 * This resolves the previous schema mismatch.
 */

omega_variable(
    martha_clifford_authenticity,
    "Is Martha a real person or a strategic fraud targeting lonely men?",
    resolution_mechanism("Verification of her physical address vs P.O. Box"),
    impact("If fraud: Rope (Bloom is being coordinated). If real: Noose (asymmetry)."),
    confidence_without_resolution(medium)
).

/* ==========================================================================
   6. ALTERNATIVE ANALYSIS
   ========================================================================== */

/**
 * VIABLE ALTERNATIVES:
 * 1. Open Marital Reconciliation: Rejected due to active suppression of domestic 
 * friction and the 'Lotus' effect of the secret.
 */

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: bloom_social_exclusion_dublin
% ============================================================================
% Generated: 2026-01-19
% Model: Gemini 2.0 Flash
% Source: Ulysses, Chapter 6 (Hades)
% ============================================================================

:- module(constraint_bloom_social_exclusion, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: bloom_social_exclusion_dublin
 * human_readable: Social Exclusion and Antisemitic Friction
 * domain: social/political
 * temporal_scope: June 16, 1904
 * spatial_scope: Dublin (Funeral carriage to Prospect Cemetery)
 * * SUMMARY:
 * Leopold Bloom exists under a persistent constraint of social exclusion in Dublin's 
 * Catholic middle-class circles, manifesting as subtle snubs and overt 
 * marginalization. The constraint extracts Bloom's dignity 
 * to maintain tribal cohesion.
 * * KEY AGENTS:
 * - Leopold Bloom: Individual moderate navigating a "Rope" of socialAssent.
 * - The Pauper/Deceased Child: Individual powerless subject to the finality of the social order (Noose).
 * - Martin Cunningham: Institutional moderator viewing the order as law (Mountain).
 */

/* ==========================================================================
   2. CORE SYSTEM INTEGRATION (The "Reality" Layer)
   ========================================================================== */

% Required for [STEP 1] and [STEP 2] of the DR-Audit Suite
narrative_ontology:interval(bloom_exclusion_interval, 0, 10).
narrative_ontology:constraint_claim(bloom_social_exclusion_dublin, noose).

% Metrics: Extractiveness (0.5) and Suppression (0.7)
domain_priors:base_extractiveness(bloom_social_exclusion_dublin, 0.5).
domain_priors:suppression_score(bloom_social_exclusion_dublin, 0.7).
domain_priors:emerges_naturally(bloom_social_exclusion_dublin).

% Explicit metric hooks to prevent auto-imputation
narrative_ontology:constraint_metric(bloom_social_exclusion_dublin, extractiveness, 0.5).
narrative_ontology:constraint_metric(bloom_social_exclusion_dublin, suppression_requirement, 0.7).

% BENEFICIARIES & VICTIMS
constraint_beneficiary(bloom_social_exclusion_dublin, dublin_catholic_inner_circle).
constraint_victim(bloom_social_exclusion_dublin, bloom_leopold).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (Perspectival Truth)
   ========================================================================== */

/* --------------------------------------------------------------------------
   PERSPECTIVE 1: LEOPOLD BLOOM - Rope
   --------------------------------------------------------------------------
   WHY: Bloom treats social friction as a "Rope"—a tool to be managed through 
   "soft politeness" and "prudent assent" to maintain his position. 
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    bloom_social_exclusion_dublin,
    rope,
    context(agent_power(individual_moderate), time_horizon(biographical), exit_options(mobile), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 2: THE PAUPER / CHILD FUNERAL - Noose
   --------------------------------------------------------------------------
   WHO: individual_powerless - "Only a pauper. Nobody owns.".
   WHY: From the bottom of the social hierarchy, the order is a "Noose" that 
   extracts life and dignity without recourse or coordination options.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    bloom_social_exclusion_dublin,
    noose,
    context(agent_power(individual_powerless), time_horizon(immediate), exit_options(constrained), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 3: MARTIN CUNNINGHAM - Mountain
   --------------------------------------------------------------------------
   WHO: institutional - The social arbiter who "lays down the law".
   WHY: Cunningham views the tribal social order as an immutable natural law—a 
   Mountain that Bloom cannot change through mere interaction.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    bloom_social_exclusion_dublin,
    mountain,
    context(agent_power(institutional), time_horizon(historical), exit_options(trapped), spatial_scope(national))
) :- !.

/* ==========================================================================
   4. TESTS
   ========================================================================== */

:- begin_tests(bloom_social_exclusion_dublin_tests).

test(multi_perspective_conflict) :-
    constraint_indexing:constraint_classification(bloom_social_exclusion_dublin, T1, context(agent_power(individual_moderate), _, _, _)),
    constraint_indexing:constraint_classification(bloom_social_exclusion_dublin, T2, context(agent_power(individual_powerless), _, _, _)),
    T1 = rope, T2 = noose.

test(time_immutability_scaling) :-
    % Historical view (Institutional) sees the social order as a Mountain
    constraint_indexing:constraint_classification(bloom_social_exclusion_dublin, mountain, context(agent_power(institutional), time_horizon(historical), _, _)).

:- end_tests(bloom_social_exclusion_dublin_tests).

/* ==========================================================================
   5. MODEL INTERPRETATION & OMEGAS
   ========================================================================== */

/**
 * LLM GENERATION NOTES:
 * Refactored to include the mandatory powerless perspective. This allows the 
 * audit to detect the gap between the "Mountain" of history and the 
 * "Noose" of current social reality.
 */

omega_variable(
    bloom_conscious_assimilation,
    "Is Bloom's assent a survival strategy (Rope) or a deep-seated belief (Mountain)?",
    resolution_mechanism("Internal monologue analysis of Chapter 17 (Ithaca)"),
    impact("If strategy: Bloom is an arbitrageur. If belief: He is a victim of suppression."),
    confidence_without_resolution(medium)
).

/* ==========================================================================
   6. ALTERNATIVE ANALYSIS
   ========================================================================== */

/**
 * VIABLE ALTERNATIVES:
 * 1. Active Confrontation: Rejected to avoid "mortification".
 * 2. Withdrawal: Rejected due to professional and social necessity.
 */

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: bloom_aeolus_advertisement_circuit
% ============================================================================
% Generated: 2026-01-19
% Model: Gemini 2.0 Flash
% Source: Ulysses, Chapter 7 (Aeolus)
% ============================================================================

:- module(bloom_aeolus_advertisement, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: bloom_aeolus_advertisement_circuit
 * human_readable: The Advertisement Canvassing Cycle (Aeolus)
 * domain: economic/social
 * temporal_scope: June 16, 1904 (Mid-morning)
 * spatial_scope: Dublin (Press District)
 * * SUMMARY:
 * Leopold Bloom navigates the "Heart of the Hibernian Metropolis" to secure a 
 * three-month advertising renewal for Alexander Keyes. 
 * The constraint is the economic requirement to mediate between client and 
 * publisher in a chaotic, dismissive institutional environment.
 * * KEY AGENTS:
 * - Leopold Bloom: Individual moderate canvasser seeking coordination (Rope).
 * - Myles Crawford: Institutional editor viewing the economic reality as immutable (Mountain).
 * - Newsboys: Powerless urchins for whom the cycle is a mocking trap (Noose).
 */

/* ==========================================================================
   2. CORE SYSTEM INTEGRATION (The "Reality" Layer)
   ========================================================================== */

% Required for [STEP 1] and [STEP 2] of the DR-Audit Suite
narrative_ontology:interval(bloom_aeolus_interval, 0, 10).
narrative_ontology:constraint_claim(bloom_aeolus_advertisement_circuit, noose).

% Metrics: Extractiveness (0.4) and Suppression (0.5)
domain_priors:base_extractiveness(bloom_aeolus_advertisement_circuit, 0.4).
domain_priors:suppression_score(bloom_aeolus_advertisement_circuit, 0.5).
domain_priors:requires_active_enforcement(bloom_aeolus_advertisement_circuit).

% Explicit metric hooks to prevent auto-imputation
narrative_ontology:constraint_metric(bloom_aeolus_advertisement_circuit, extractiveness, 0.4).
narrative_ontology:constraint_metric(bloom_aeolus_advertisement_circuit, suppression_requirement, 0.5).

% BENEFICIARIES & VICTIMS
constraint_beneficiary(bloom_aeolus_advertisement_circuit, myles_crawford).
constraint_beneficiary(bloom_aeolus_advertisement_circuit, alexander_keyes).
constraint_victim(bloom_aeolus_advertisement_circuit, bloom_leopold).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (Perspectival Truth)
   ========================================================================== */

/* --------------------------------------------------------------------------
   PERSPECTIVE 1: LEOPOLD BLOOM - Rope
   --------------------------------------------------------------------------
   WHY: Bloom views the canvassing circuit as a functional coordination tool 
   that provides a living through "pars" and "renewals".
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    bloom_aeolus_advertisement_circuit,
    rope,
    context(agent_power(individual_moderate), time_horizon(biographical), exit_options(mobile), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 2: MYLES CRAWFORD - Mountain
   --------------------------------------------------------------------------
   WHO: institutional - The editor who "rules the world" of the press.
   WHY: Crawford treats the paper's economic necessities as irrelevant noise 
   compared to historical "afflatus".
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    bloom_aeolus_advertisement_circuit,
    mountain,
    context(agent_power(institutional), time_horizon(historical), exit_options(trapped), spatial_scope(national))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 3: NEWSBOYS - Noose
   --------------------------------------------------------------------------
   WHO: individual_powerless - "young guttersnipes" mocking the ritual.
   WHY: From the street level, Bloom's circuit is an extractive, ridiculous 
   trapping ritual that makes him a target for mockery.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    bloom_aeolus_advertisement_circuit,
    noose,
    context(agent_power(individual_powerless), time_horizon(immediate), exit_options(constrained), spatial_scope(local))
) :- !.

/* ==========================================================================
   4. TESTS
   ========================================================================== */

:- begin_tests(bloom_aeolus_advertisement_tests).

test(multi_perspective_aeolus) :-
    constraint_indexing:constraint_classification(bloom_aeolus_advertisement_circuit, T1, context(individual_moderate, _, _, _)),
    constraint_indexing:constraint_classification(bloom_aeolus_advertisement_circuit, T2, context(institutional, _, _, _)),
    T1 = rope, T2 = mountain.

test(time_immutability_aeolus) :-
    % Historical/Institutional view sees the paper's culture as a Mountain
    constraint_indexing:effective_immutability(historical, trapped, mountain).

:- end_tests(bloom_aeolus_advertisement_tests).

/* ==========================================================================
   5. MODEL INTERPRETATION & OMEGAS
   ========================================================================== */

/**
 * LLM GENERATION NOTES:
 * Refactored to eliminate auto-imputation and ensure the 'Mountain' vs 'Noose' 
 * perspectival gap is audited. 
 */

omega_variable(
    crawford_alcohol_influence,
    "Is Crawford's refusal to change (Mountain) institutional or alcoholic whim?",
    resolution_mechanism("Comparative analysis of sober vs drunk decision-making"),
    impact("If whim: Noose. If policy: Mountain."),
    confidence_without_resolution(low)
).

/* ==========================================================================
   6. ALTERNATIVE ANALYSIS
   ========================================================================== */

/**
 * VIABLE ALTERNATIVES:
 * 1. Direct Steady Employment: Rejected due to dwindling practice.
 * 2. Political Entry: Suppressed by Bloom's identity as a 'Semite'.
 */

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: lestrygonian_metabolism_chp8
% ============================================================================
% Generated: 2026-01-19
% Model: Gemini 2.0 Flash
% Source: James Joyce, Ulysses, Chapter 8 (Lestrygonians)
% ============================================================================

:- module(constraint_lestrygonian_metabolism_chp8, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: lestrygonian_metabolism_chp8
 * human_readable: The Metabolic Stream (Hunger and Predation)
 * domain: economic/biological
 * temporal_scope: June 16, 1904 (Noon)
 * spatial_scope: Dublin (Davy Byrne's, The Burton, and the Streets)
 * * SUMMARY:
 * This constraint represents the inescapable biological and economic cycle of 
 * consumption. It is the "stream of life" where one is either the eater or 
 * the eaten, manifesting as the predatory extraction of hunger.
 * * KEY AGENTS:
 * - Leopold Bloom: Individual moderate navigating his hunger via "cheese sandwich" (Rope).
 * - The Horses/Jugginses: Individual powerless agents trapped in the cycle of work and feeding (Noose).
 * - Nature/The Stream: Institutional force viewing consumption as immutable law (Mountain).
 */

/* ==========================================================================
   2. CORE SYSTEM INTEGRATION (The "Reality" Layer)
   ========================================================================== */

% Required for [STEP 1] and [STEP 2] of the DR-Audit Suite
narrative_ontology:interval(lestrygonian_metabolism_chp8_interval, 0, 10).
narrative_ontology:constraint_claim(lestrygonian_metabolism_chp8, noose).

% Metrics: Extractiveness (0.6 - Predatory) and Suppression (0.4 - Natural)
domain_priors:base_extractiveness(lestrygonian_metabolism_chp8, 0.6).
domain_priors:suppression_score(lestrygonian_metabolism_chp8, 0.4).
domain_priors:emerges_naturally(lestrygonian_metabolism_chp8).

% Explicit metric hooks to prevent auto-imputation
narrative_ontology:constraint_metric(lestrygonian_metabolism_chp8, extractiveness, 0.6).
narrative_ontology:constraint_metric(lestrygonian_metabolism_chp8, suppression_requirement, 0.4).

% BENEFICIARIES & VICTIMS
constraint_beneficiary(lestrygonian_metabolism_chp8, predator_class).
constraint_victim(lestrygonian_metabolism_chp8, bloom_leopold).
constraint_victim(lestrygonian_metabolism_chp8, the_poor_of_dublin).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (Perspectival Truth)
   ========================================================================== */

/* --------------------------------------------------------------------------
   PERSPECTIVE 1: LEOPOLD BLOOM - Rope
   --------------------------------------------------------------------------
   WHY: Bloom views his own hunger as a "Rope"—a functional coordination 
   problem he solves through a modest lunch, avoiding the "animal" 
   scenes at the Burton.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    lestrygonian_metabolism_chp8,
    rope,
    context(agent_power(individual_moderate), time_horizon(biographical), exit_options(mobile), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 2: THE "JUGGINSES" (Horses) - Noose
   --------------------------------------------------------------------------
   WHO: individual_powerless - "Damn all they know or care... noses stuck in nosebags".
   WHY: For the laboring animals and the destitute, the metabolic cycle is a 
   "Noose"—an extractive, inescapable trap of work for food.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    lestrygonian_metabolism_chp8,
    noose,
    context(agent_power(individual_powerless), time_horizon(immediate), exit_options(trapped), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 3: BIOLOGICAL NECESSITY - Mountain
   --------------------------------------------------------------------------
   WHO: institutional/analytical - The "Stream of Life".
   WHY: From the perspective of biology, the cycle of "everybody eating 
   everyone else" is an immutable "Mountain"—a natural law.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    lestrygonian_metabolism_chp8,
    mountain,
    context(agent_power(institutional), time_horizon(historical), exit_options(trapped), spatial_scope(global))
) :- !.

/* ==========================================================================
   4. TESTS
   ========================================================================== */

:- begin_tests(lestrygonian_metabolism_chp8_tests).

test(multi_perspective_metabolism) :-
    constraint_indexing:constraint_classification(lestrygonian_metabolism_chp8, T1, context(individual_moderate, _, _, _)),
    constraint_indexing:constraint_classification(lestrygonian_metabolism_chp8, T2, context(individual_powerless, _, _, _)),
    T1 = rope, T2 = noose.

test(extractiveness_check) :-
    % predatory systems should have high base extractiveness
    domain_priors:base_extractiveness(lestrygonian_metabolism_chp8, E),
    E >= 0.6.

:- end_tests(lestrygonian_metabolism_chp8_tests).

/* ==========================================================================
   5. MODEL INTERPRETATION & OMEGAS
   ========================================================================== */

/**
 * LLM GENERATION NOTES:
 * Refactored to fix the 'metabolic_cycle' mismatch. By declaring the claim 
 * as 'noose', we highlight how the biological 'Mountain' actually functions 
 * as an extractive trap for the lower classes of Dublin.
 */

omega_variable(
    metempsychosis_immutability,
    "Is the 'stream of life' a biological Mountain or a spiritual Noose (Karma)?",
    resolution_mechanism("Verification of the 'Met him pike hoses' theory in Chapter 17"),
    impact("If Mountain: Suffering is a natural fact. If Noose: It is a breakable cycle."),
    confidence_without_resolution(medium)
).

/* ==========================================================================
   6. ALTERNATIVE ANALYSIS
   ========================================================================== */

/**
 * VIABLE ALTERNATIVES:
 * 1. Communal Kitchens: Imagined by Bloom but suppressed by the "all for 
 * number one" ethos of the city.
 */

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: stephen_shakespeare_ghost
% ============================================================================
% Generated: 2026-01-19
% Model: Gemini 2.0 Flash
% Source: Ulysses, Chapter 9 (Scylla and Charybdis)
% ============================================================================

:- module(stephen_shakespeare_ghost, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: stephen_shakespeare_ghost
 * human_readable: The Ineluctability of Paternity (The Ghost's Theory)
 * domain: ontological/social
 * temporal_scope: June 16, 1904 (Afternoon)
 * spatial_scope: National Library of Ireland, Dublin
 * * SUMMARY:
 * Stephen Dedalus presents a complex theory of Shakespeare's work that hinges on 
 * the inescapable, "ghostly" nature of paternity. The constraint 
 * is the ontological weight of the father—a state of being that is impalpable 
 * yet legally and spiritually binding[cite: 1].
 * * KEY AGENTS:
 * - Stephen Dedalus: The individual moderate performing a "Rope" of intellectual 
 * argument to manage his own guilt[cite: 1].
 * - The Library/Tradition: The institutional "Mountain" of established 
 * literary and moral law[cite: 1].
 * - Stephen’s Internal Self: The powerless recipient of his own father-guilt (Noose)[cite: 1].
 */

/* ==========================================================================
   2. CORE SYSTEM INTEGRATION (The "Reality" Layer)
   ========================================================================== */

% Fixed: Changed 'ontological_paternity' to 'mountain' to satisfy schema [cite: 2, 3]
narrative_ontology:interval(stephen_shakespeare_ghost, 0, 10).
narrative_ontology:constraint_claim(stephen_shakespeare_ghost, mountain).

% Metrics: Extractiveness (0.4) and Suppression (0.6)
domain_priors:base_extractiveness(stephen_shakespeare_ghost, 0.4).
domain_priors:suppression_score(stephen_shakespeare_ghost, 0.6).
domain_priors:requires_active_enforcement(stephen_shakespeare_ghost).

% Explicit metric hooks to prevent auto-imputation [cite: 3]
narrative_ontology:constraint_metric(stephen_shakespeare_ghost, extractiveness, 0.4).
narrative_ontology:constraint_metric(stephen_shakespeare_ghost, suppression_requirement, 0.6).

% BENEFICIARIES & VICTIMS
constraint_beneficiary(stephen_shakespeare_ghost, intellectual_status).
constraint_victim(stephen_shakespeare_ghost, stephen_dedalus_identity).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (Perspectival Truth)
   ========================================================================== */

/* --------------------------------------------------------------------------
   PERSPECTIVE 1: STEPHEN DEDALUS - Rope
   --------------------------------------------------------------------------
   WHY: Stephen uses his theory as a "Rope"—a functional coordination tool 
   to navigate the library’s social dynamics and process his personal trauma 
   through performance[cite: 1]. 
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    stephen_shakespeare_ghost,
    rope,
    context(agent_power(individual_moderate), time_horizon(biographical), exit_options(mobile), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 2: THE LIBRARY CIRCLE - Mountain
   --------------------------------------------------------------------------
   WHO: institutional - "The quaker librarian purred... True in the larger analysis".
   WHY: For the academic institution, the weight of Shakespeare and the laws of 
   historical tradition are immutable facts of reality—a Mountain[cite: 1].
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    stephen_shakespeare_ghost,
    mountain,
    context(agent_power(institutional), time_horizon(historical), exit_options(trapped), spatial_scope(national))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 3: THE "GHOST" (Stephen's Guilt) - Noose
   --------------------------------------------------------------------------
   WHO: individual_powerless - Stephen as a "servant of two masters"[cite: 1].
   WHY: Internally, the ineluctability of his past and his father is a "Noose" 
   that extracts his peace and traps him in a cycle of "agenbite of inwit"[cite: 1].
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    stephen_shakespeare_ghost,
    noose,
    context(agent_power(individual_powerless), time_horizon(immediate), exit_options(constrained), spatial_scope(local))
) :- !.

/* ==========================================================================
   4. TESTS
   ========================================================================== */

:- begin_tests(stephen_shakespeare_ghost_tests).

test(multi_perspective_conflict) :-
    constraint_indexing:constraint_classification(stephen_shakespeare_ghost, T1, context(agent_power(individual_moderate), _, _, _)),
    constraint_indexing:constraint_classification(stephen_shakespeare_ghost, T2, context(agent_power(institutional), _, _, _)),
    T1 = rope, T2 = mountain.

test(immutability_scaling) :-
    % Historical/Institutional view sees paternity/tradition as a Mountain
    constraint_indexing:effective_immutability(historical, trapped, mountain).

:- end_tests(stephen_shakespeare_ghost_tests).

/* ==========================================================================
   5. MODEL INTERPRETATION & OMEGAS
   ========================================================================== */

/**
 * LLM GENERATION NOTES:
 * Refactored to fix the 'ontological_paternity' mismatch. By declaring the 
 * claim as 'mountain', the audit can evaluate if Stephen's perceived 
 * 'Natural Law' of the father is actually an extractive trap (Noose) 
 * fueled by his own suppression of belief[cite: 1].
 */

omega_variable(
    stephen_belief_sincerity,
    "Does Stephen actually believe his own theory, or is it a rhetorical Rope?",
    resolution_mechanism("Analysis of his confession: 'No', when asked if he believes his theory [cite: 1]"),
    impact("If insincere: The 'Mountain' is a 'Noose' of self-deception."),
    confidence_without_resolution(medium)
).

/* ==========================================================================
   6. ALTERNATIVE ANALYSIS
   ========================================================================== */

/**
 * VIABLE ALTERNATIVES:
 * 1. Intellectual Sincerity: Rejecting the "peril" of the theory to speak 
 * plainly. Suppressed by Stephen's need for artistic performance[cite: 1].
 */

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: the_viceregal_cavalcade
% ============================================================================
% Generated: 2026-01-19
% Model: Gemini 2.0 Flash
% Source: James Joyce, Ulysses, Chapter 10 (Wandering Rocks)
% ============================================================================

:- module(the_viceregal_cavalcade, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: the_viceregal_cavalcade
 * human_readable: The Viceregal Procession (Colonial Presence)
 * domain: political/social
 * temporal_scope: June 16, 1904 (2:55 PM - 4:00 PM)
 * spatial_scope: Dublin (Phoenix Park to the Mirus Bazaar)
 * * SUMMARY:
 * The Lord Lieutenant's carriage moves through Dublin, acting as a temporal and 
 * spatial anchor that synchronizes the movements of citizens. 
 * The constraint represents the hierarchy of visibility and power demanded by 
 * the imperial presence.
 * * KEY AGENTS:
 * - The Citizens: Individual moderate agents navigating the city via "salutes" and "wonder" (Rope).
 * - William Humble, Earl of Dudley: Institutional representative viewing the procession as immutable (Mountain).
 * - The Blind Stripling: Individual powerless agent for whom the procession is a sensory obstruction or irrelevant trap (Noose).
 */

/* ==========================================================================
   2. CORE SYSTEM INTEGRATION (The "Reality" Layer)
   ========================================================================== */

% Required for [STEP 1] and [STEP 2] of the DR-Audit Suite
narrative_ontology:interval(the_viceregal_cavalcade, 0, 10).
% Fixed: Changed 'imperial_sovereignty' to 'noose' to satisfy schema
narrative_ontology:constraint_claim(the_viceregal_cavalcade, noose).

% Metrics: Extractiveness (0.4) and Suppression (0.6)
domain_priors:base_extractiveness(the_viceregal_cavalcade, 0.4).
domain_priors:suppression_score(the_viceregal_cavalcade, 0.6).
domain_priors:requires_active_enforcement(the_viceregal_cavalcade).

% Explicit metric hooks to prevent auto-imputation
narrative_ontology:constraint_metric(the_viceregal_cavalcade, extractiveness, 0.4).
narrative_ontology:constraint_metric(the_viceregal_cavalcade, suppression_requirement, 0.6).

% BENEFICIARIES & VICTIMS
constraint_beneficiary(the_viceregal_cavalcade, british_imperial_administration).
constraint_victim(the_viceregal_cavalcade, dublin_civilian_mobility).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (Perspectival Truth)
   ========================================================================== */

/* --------------------------------------------------------------------------
   PERSPECTIVE 1: THE CITIZENS (General Public) - Rope
   --------------------------------------------------------------------------
   WHY: For the average Dubliner, the cavalcade is a "Rope"—a coordination 
   mechanism that allows for social display (salutes) and spatial 
   synchronization without direct violence.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    the_viceregal_cavalcade,
    rope,
    context(agent_power(individual_moderate), time_horizon(biographical), exit_options(mobile), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 2: THE BLIND STRIPLING - Noose
   --------------------------------------------------------------------------
   WHO: individual_powerless - "He passed a blind stripling opposite Broadbent’s".
   WHY: To the powerless or impaired agent, the imperial ritual is an 
   extractive "Noose"—a physical and political obstruction that offers 
   no coordination benefit or visibility.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    the_viceregal_cavalcade,
    noose,
    context(agent_power(individual_powerless), time_horizon(immediate), exit_options(constrained), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 3: THE EMPIRE (The Viceroy) - Mountain
   --------------------------------------------------------------------------
   WHO: institutional - "acknowledge punctually salutes from rare male walkers".
   WHY: From the institutional perspective, the cavalcade is a "Mountain"—a 
   natural and immutable law of political reality and statecraft.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    the_viceregal_cavalcade,
    mountain,
    context(agent_power(institutional), time_horizon(historical), exit_options(trapped), spatial_scope(national))
) :- !.

/* ==========================================================================
   4. TESTS
   ========================================================================== */

:- begin_tests(the_viceregal_cavalcade_tests).

test(multi_perspective_hierarchy) :-
    constraint_indexing:constraint_classification(the_viceregal_cavalcade, T1, context(agent_power(individual_moderate), _, _, _)),
    constraint_indexing:constraint_classification(the_viceregal_cavalcade, T2, context(agent_power(institutional), _, _, _)),
    T1 = rope, T2 = mountain.

test(immutability_colonial_scaling) :-
    % Institutional view sees the Empire as a Mountain
    constraint_indexing:effective_immutability(historical, trapped, mountain).

:- end_tests(the_viceregal_cavalcade_tests).

/* ==========================================================================
   5. MODEL INTERPRETATION & OMEGAS
   ========================================================================== */

/**
 * LLM GENERATION NOTES:
 * Refactored to eliminate the 'imperial_sovereignty' mismatch. Declaring the 
 * claim as 'noose' allows the Audit Suite to flag the "False Mountain" 
 * effect of colonial power, where the state acts as law (Mountain) but 
 * functions as extraction (Noose).
 */

omega_variable(
    macintosh_man_anomaly,
    "Why does the man in the brown macintosh pass 'unscathed' across the path?",
    resolution_mechanism("Investigation into exit options (arbitrage) from the cavalcade's constraint"),
    impact("If he is an outlier: The Mountain is flawed. If a ghost: The constraint is irrelevant."),
    confidence_without_resolution(low)
).

/* ==========================================================================
   6. ALTERNATIVE ANALYSIS
   ========================================================================== */

/**
 * VIABLE ALTERNATIVES:
 * 1. Nationalist Boycott: Rejected/Suppressed by the "wonder" and "punctual 
 * salutes" of the general populace in this chapter.
 */

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: bloom_acoustic_seduction_vigil
% ============================================================================
% Generated: 2026-01-19
% Model: Gemini 2.0 Flash
% Source: Ulysses, Chapter 11 (Sirens)
% ============================================================================

:- module(bloom_acoustic_seduction_vigil, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: bloom_acoustic_seduction_vigil
 * human_readable: The Acoustic Seduction Vigil (The Cuckold's Hour)
 * domain: psychological/social
 * temporal_scope: June 16, 1904 (4:00 PM)
 * spatial_scope: The Ormond Hotel, Dublin
 * * SUMMARY:
 * Leopold Bloom experiences the seductive power of music (the "Sirens") while 
 * acutely aware that Blazes Boylan is visiting Molly. The 
 * constraint acts as an emotional "decoy" that extracts Bloom's attention 
 * through trilling notes and acoustic lures.
 * * KEY AGENTS:
 * - Leopold Bloom: Individual moderate navigating a "Rope" of artistic appreciation and distraction.
 * - The Blind Stripling: Individual powerless agent for whom the "bronze and gold" of the sirens do not exist (Noose).
 * - The Ormond Hotel: Institutional setting viewing the acoustic order as an immutable law (Mountain).
 */

/* ==========================================================================
   2. CORE SYSTEM INTEGRATION (The "Reality" Layer)
   ========================================================================== */

% Required for [STEP 1] and [STEP 2] of the DR-Audit Suite
narrative_ontology:interval(bloom_sirens_interval, 0, 10).
% Fixed: Changed 'acoustic_vigil' to 'noose' to satisfy schema
narrative_ontology:constraint_claim(bloom_acoustic_seduction_vigil, noose).

% Metrics: Extractiveness (0.6 - Sensory trap) and Suppression (0.7 - High distraction)
domain_priors:base_extractiveness(bloom_acoustic_seduction_vigil, 0.6).
domain_priors:suppression_score(bloom_acoustic_seduction_vigil, 0.7).
domain_priors:requires_active_enforcement(bloom_acoustic_seduction_vigil).

% Explicit metric hooks to prevent auto-imputation
narrative_ontology:constraint_metric(bloom_acoustic_seduction_vigil, extractiveness, 0.6).
narrative_ontology:constraint_metric(bloom_acoustic_seduction_vigil, suppression_requirement, 0.7).

% BENEFICIARIES & VICTIMS
constraint_beneficiary(bloom_acoustic_seduction_vigil, ormond_bar_social_fabric).
constraint_victim(bloom_acoustic_seduction_vigil, bloom_emotional_agency).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (Perspectival Truth)
   ========================================================================== */

/* --------------------------------------------------------------------------
   PERSPECTIVE 1: LEOPOLD BLOOM - Rope
   --------------------------------------------------------------------------
   WHY: Bloom utilizes the music as a "Rope"—a functional coordination tool 
   to manage his acute distress by focusing on technical and aesthetic 
   qualities ("vibrato," "seven last words").
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    bloom_acoustic_seduction_vigil,
    rope,
    context(agent_power(individual_moderate), time_horizon(biographical), exit_options(mobile), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 2: THE BLIND STRIPLING - Noose
   --------------------------------------------------------------------------
   WHO: individual_powerless - "He did not see... Nor Ben nor Bob nor Tom".
   WHY: For the powerless, sensory-impaired agent, the seductive "order" of 
   the hotel is a "Noose"—an extractive trap of exclusion where the 
   coordination benefits of the "Siren" song are entirely absent.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    bloom_acoustic_seduction_vigil,
    noose,
    context(agent_power(individual_powerless), time_horizon(immediate), exit_options(constrained), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 3: THE ORMOND ORDER - Mountain
   --------------------------------------------------------------------------
   WHO: institutional - The "Sirens" (barmaids) and the "gallant" drinkers.
   WHY: From the institutional perspective of the bar, the acoustic ritual 
   and social hierarchy are a "Mountain"—an immutable law of Dublin 
   hospitality and performance.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    bloom_acoustic_seduction_vigil,
    mountain,
    context(agent_power(institutional), time_horizon(historical), exit_options(trapped), spatial_scope(national))
) :- !.

/* ==========================================================================
   4. TESTS
   ========================================================================== */

:- begin_tests(bloom_acoustic_seduction_tests).

test(multi_perspective_sirens) :-
    constraint_indexing:constraint_classification(bloom_acoustic_seduction_vigil, T1, context(agent_power(individual_moderate), _, _, _)),
    constraint_indexing:constraint_classification(bloom_acoustic_seduction_vigil, T2, context(agent_power(individual_powerless), _, _, _)),
    T1 = rope, T2 = noose.

test(immutability_acoustic_scaling) :-
    % Institutional view sees the Siren song as a Mountain
    constraint_indexing:effective_immutability(historical, trapped, mountain).

:- end_tests(bloom_acoustic_seduction_tests).

/* ==========================================================================
   5. MODEL INTERPRETATION & OMEGAS
   ========================================================================== */

/**
 * LLM GENERATION NOTES:
 * Refactored to eliminate the 'acoustic_vigil' mismatch. Mapping the claim 
 * to 'noose' allows the audit to detect if the music's "decoy" effect 
 * creates a "False Mountain" of aesthetic escape that masks a "Noose" 
 * of emotional extraction.
 */

omega_variable(
    siren_intent_malice,
    "Do the barmaids intentionally distract (Noose) or simply perform (Rope)?",
    resolution_mechanism("Analysis of Lydia and Minnie's internal monologue vs external trilling"),
    impact("If malice: Noose. If performance: Rope."),
    confidence_without_resolution(low)
).

/* ==========================================================================
   6. ALTERNATIVE ANALYSIS
   ========================================================================== */

/**
 * VIABLE ALTERNATIVES:
 * 1. Immediate Confrontation: Bloom could have followed Boylan's car. 
 * Rejected/Suppressed by his "sluggish" temperament and the hotel's 
 * "acoustic lure".
 */

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: bloom_xenophobic_exclusion
% ============================================================================
% Generated: 2026-01-19
% Model: Gemini 2.0 Flash
% Source: Ulysses, Chapter 12 (Cyclops)
% ============================================================================

:- module(bloom_xenophobic_exclusion, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: bloom_xenophobic_exclusion
 * human_readable: Ethnonationalist Exclusion (The Citizen's Creed)
 * domain: political/social
 * temporal_scope: June 16, 1904 (Afternoon)
 * spatial_scope: Barney Kiernan’s Pub, Dublin
 * * SUMMARY:
 * Leopold Bloom is subjected to a violent, xenophobic constraint enforced by 
 * "the citizen" and a chorus of pub-goers. This constraint defines 
 * "Irishness" through an exclusionary lens that targets Bloom's Jewish heritage 
 * and lack of ethnonationalist fervor.
 * * KEY AGENTS:
 * - Leopold Bloom: Individual moderate attempting to coordinate through reason (Rope).
 * - The Citizen: Institutional agent for whom ethnonationalism is an immutable law (Mountain).
 * - Garryowen (The Dog): Individual powerless recipient of the Citizen's violent environment (Noose).
 */

/* ==========================================================================
   2. CORE SYSTEM INTEGRATION (The "Reality" Layer)
   ========================================================================== */

% Required for [STEP 1] and [STEP 2] of the DR-Audit Suite
narrative_ontology:interval(bloom_exclusion_id, 0, 10).
% Fixed: Changed 'exclusionary_identity' to 'noose' to satisfy schema
narrative_ontology:constraint_claim(bloom_xenophobic_exclusion, noose).

% Metrics: Extractiveness (0.6 - Violent extraction) and Suppression (0.7 - High social pressure)
domain_priors:base_extractiveness(bloom_xenophobic_exclusion, 0.6).
domain_priors:suppression_score(bloom_xenophobic_exclusion, 0.7).
domain_priors:requires_active_enforcement(bloom_xenophobic_exclusion).

% Explicit metric hooks to prevent auto-imputation
narrative_ontology:constraint_metric(bloom_xenophobic_exclusion, extractiveness, 0.6).
narrative_ontology:constraint_metric(bloom_xenophobic_exclusion, suppression_requirement, 0.7).

% BENEFICIARIES & VICTIMS
constraint_beneficiary(bloom_xenophobic_exclusion, ethnonationalist_cohesion).
constraint_victim(bloom_xenophobic_exclusion, bloom_leopold).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (Perspectival Truth)
   ========================================================================== */

/* --------------------------------------------------------------------------
   PERSPECTIVE 1: LEOPOLD BLOOM - Rope
   --------------------------------------------------------------------------
   WHY: Bloom treats the debate as a "Rope"—a functional if dangerous 
   coordination tool where he argues for "love" and "nation" to find a 
   middle ground. 
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    bloom_xenophobic_exclusion,
    rope,
    context(agent_power(individual_moderate), time_horizon(biographical), exit_options(mobile), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 2: GARRYOWEN (The Powerless) - Noose
   --------------------------------------------------------------------------
   WHO: individual_powerless - The dog "bloody well worth to tear him limb from limb".
   WHY: From the perspective of the powerless agent caught in the fray, the 
   xenophobic violence is a "Noose"—an inescapable trap of predatory 
   hostility.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    bloom_xenophobic_exclusion,
    noose,
    context(agent_power(individual_powerless), time_horizon(immediate), exit_options(constrained), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 3: THE CITIZEN - Mountain
   --------------------------------------------------------------------------
   WHO: institutional - The enforcer of the "creed".
   WHY: To the Citizen, his ethnonationalist boundaries are a "Mountain"—an 
   immutable natural law of blood and soil.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    bloom_xenophobic_exclusion,
    mountain,
    context(agent_power(institutional), time_horizon(historical), exit_options(trapped), spatial_scope(national))
) :- !.

/* ==========================================================================
   4. TESTS
   ========================================================================== */

:- begin_tests(bloom_xenophobic_exclusion_tests).

test(multi_perspective_conflict) :-
    constraint_indexing:constraint_classification(bloom_xenophobic_exclusion, T1, context(agent_power(individual_moderate), _, _, _)),
    constraint_indexing:constraint_classification(bloom_xenophobic_exclusion, T2, context(agent_power(institutional), _, _, _)),
    T1 = rope, T2 = mountain.

test(immutability_xenophobic_scaling) :-
    % Institutional view sees the Citizen's law as a Mountain
    constraint_indexing:effective_immutability(historical, trapped, mountain).

:- end_tests(bloom_xenophobic_exclusion_tests).

/* ==========================================================================
   5. MODEL INTERPRETATION & OMEGAS
   ========================================================================== */

/**
 * LLM GENERATION NOTES:
 * Refactored to eliminate the schema mismatch. Declaring the claim as 'noose' 
 * allows the audit to identify the "False Mountain" of the Citizen's rhetoric, 
 * which masks a 'Noose' of literal physical extraction and social entrapment 
 *.
 */

omega_variable(
    bloom_prophetic_ascent,
    "Is Bloom's 'Elijah' ascent a transfiguration (Rope) or narrative mockery (Noose)?",
    resolution_mechanism("Analysis of the 'Abba! Adonai!' cry"),
    impact("If transfiguration: Bloom finds an exit option. If mockery: The Noose is total."),
    confidence_without_resolution(low)
).

/* ==========================================================================
   6. ALTERNATIVE ANALYSIS
   ========================================================================== */

/**
 * VIABLE ALTERNATIVES:
 * 1. Silence/Assimilation: Bloom could have stayed quiet to avoid the 
 * Citizen's wrath. Rejected/Suppressed by Bloom's "gesticulating" need to 
 * define himself.
 */

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: gerty_bloom_voyeuristic_distance
% ============================================================================
% Generated: 2026-01-19
% Model: Gemini 2.0 Flash
% Source: Ulysses, Chapter 13 (Nausicaa)
% ============================================================================

:- module(gerty_bloom_voyeuristic_distance, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: gerty_bloom_voyeuristic_distance
 * human_readable: The Voyeuristic Erotic Distance
 * domain: social/religious/biological
 * temporal_scope: June 16, 1904 (Evening)
 * spatial_scope: Sandymount Strand, Dublin
 * * SUMMARY:
 * This constraint represents the eroticized distance between Gerty MacDowell and 
 * Leopold Bloom. It is a psychological boundary maintained by the "mysterious 
 * embrace" of the evening and the acoustic synchronization of the "Star of the 
 * Sea" service.
 * * KEY AGENTS:
 * - Gerty MacDowell: Individual moderate navigating a "Rope" of desire and social 
 * image.
 * - The Church (Star of the Sea): Institutional anchor viewing the moral 
 * distance as immutable law (Mountain).
 * - The Cuckoo (Clock/Bird): Powerless agent for whom the time-keeping and 
 * distance are an inescapable trap (Noose).
 */

/* ==========================================================================
   2. CORE SYSTEM INTEGRATION (The "Reality" Layer)
   ========================================================================== */

% Required for [STEP 1] and [STEP 2] of the DR-Audit Suite
narrative_ontology:interval(gerty_bloom_interval, 0, 10).
% Fixed: Changed 'erotic_distancing' to 'noose' to satisfy schema
narrative_ontology:constraint_claim(gerty_bloom_voyeuristic_distance, noose).

% Metrics: Extractiveness (0.5 - Desolate extraction) and Suppression (0.5 - Social code)
domain_priors:base_extractiveness(gerty_bloom_voyeuristic_distance, 0.5).
domain_priors:suppression_score(gerty_bloom_voyeuristic_distance, 0.5).
domain_priors:requires_active_enforcement(gerty_bloom_voyeuristic_distance).

% Explicit metric hooks to prevent auto-imputation
narrative_ontology:constraint_metric(gerty_bloom_voyeuristic_distance, extractiveness, 0.5).
narrative_ontology:constraint_metric(gerty_bloom_voyeuristic_distance, suppression_requirement, 0.5).

% BENEFICIARIES & VICTIMS
constraint_beneficiary(gerty_bloom_voyeuristic_distance, dublin_social_propriety).
constraint_victim(gerty_bloom_voyeuristic_distance, gerty_macdowell).
constraint_victim(gerty_bloom_voyeuristic_distance, bloom_leopold).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (Perspectival Truth)
   ========================================================================== */

/* --------------------------------------------------------------------------
   PERSPECTIVE 1: GERTY MACDOWELL - Rope
   --------------------------------------------------------------------------
   WHY: Gerty utilizes the distance as a "Rope"—a coordination tool to perform 
   her "exquisite" identity and manage her attraction through the safety of 
   the "lingering" evening light.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    gerty_bloom_voyeuristic_distance,
    rope,
    context(agent_power(individual_moderate), time_horizon(biographical), exit_options(mobile), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 2: THE CUCKOO (The Powerless) - Noose
   --------------------------------------------------------------------------
   WHO: individual_powerless - The "little canarybird" that must "tell the time" 
  .
   WHY: From the perspective of the powerless agent, the distance and the 
   acoustic order are a "Noose"—an extractive trap of mechanical 
   repetition that offers no agency or relief.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    gerty_bloom_voyeuristic_distance,
    noose,
    context(agent_power(individual_powerless), time_horizon(immediate), exit_options(constrained), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 3: THE CHURCH (Star of the Sea) - Mountain
   --------------------------------------------------------------------------
   WHO: institutional - "The voice of prayer to her who is in her pure radiance" 
  .
   WHY: From the institutional religious perspective, the distance and moral 
   boundaries are a "Mountain"—an immutable, divine law that exists 
   independently of individual desire.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    gerty_bloom_voyeuristic_distance,
    mountain,
    context(agent_power(institutional), time_horizon(historical), exit_options(trapped), spatial_scope(national))
) :- !.

/* ==========================================================================
   4. TESTS
   ========================================================================== */

:- begin_tests(gerty_bloom_voyeuristic_tests).

test(multi_perspective_conflict) :-
    constraint_indexing:constraint_classification(gerty_bloom_voyeuristic_distance, T1, context(agent_power(individual_moderate), _, _, _)),
    constraint_indexing:constraint_classification(gerty_bloom_voyeuristic_distance, T2, context(agent_power(institutional), _, _, _)),
    T1 = rope, T2 = mountain.

test(immutability_erotic_scaling) :-
    % Institutional view sees the moral law as a Mountain
    constraint_indexing:effective_immutability(historical, trapped, mountain).

:- end_tests(gerty_bloom_voyeuristic_tests).

/* ==========================================================================
   5. MODEL INTERPRETATION & OMEGAS
   ========================================================================== */

/**
 * LLM GENERATION NOTES:
 * Refactored to eliminate the 'erotic_distancing' mismatch. Declaring the claim 
 * as 'noose' allows the audit to flag the "Stalemate" where individuals 
 * attempt to coordinate (Rope) while institutions maintain an 
 * immutable reality (Mountain).
 */

omega_variable(
    cuckoo_clock_synchronicity,
    "Is the cuckoo clock's mockery a literal sound (Mountain) or an internal 
    projection of Bloom's marital guilt (Noose)?",
    resolution_mechanism("Acoustic analysis of Chapter 13"),
    impact("If literal: Mountain. If projection: Noose."),
    confidence_without_resolution(low)
).

/* ==========================================================================
   6. ALTERNATIVE ANALYSIS
   ========================================================================== */

/**
 * VIABLE ALTERNATIVES:
 * 1. Direct Interaction: Bloom and Gerty could have crossed the distance. 
 * Rejected/Suppressed by 1904 Dublin social codes and the "Star of the Sea" 
 * morality.
 */

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */

% ============================================================================
% CONSTRAINT STORY: gestation_the_wombfruit
% ============================================================================
% Generated: 2026-01-19
% Model: Gemini 2.0 Flash
% Source: Ulysses, Chapter 14 (Oxen of the Sun)
% ============================================================================

:- module(gestation_the_wombfruit, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: gestation_the_wombfruit
 * human_readable: Biological Gestation and the Tribute of Solicitude
 * domain: biological/social
 * temporal_scope: June 16, 1904 (10:00 PM)
 * spatial_scope: National Maternity Hospital, Holles Street, Dublin
 * * SUMMARY:
 * This constraint represents the inescapable biological process of human birth—the 
 * "proliferent continuance" of the species. It governs the physical 
 * presence of the characters at the hospital and serves as the moral anchor 
 * for the "tribute of its solicitude".
 * * KEY AGENTS:
 * - Leopold Bloom: Individual moderate observing the process with "paternal care" (Rope).
 * - The Hospital/Nature: Institutional force viewing gestation as an immutable law (Mountain).
 * - The Wombfruit (The Unborn): Powerless recipient of the "nature’s incorrupted benefaction" (Noose).
 */

/* ==========================================================================
   2. CORE SYSTEM INTEGRATION (The "Reality" Layer)
   ========================================================================== */

% Required for [STEP 1] and [STEP 2] of the DR-Audit Suite
narrative_ontology:interval(gestation_wombfruit_id, 0, 10).
% Fixed: Changed 'biological_destiny' to 'mountain' to satisfy schema
narrative_ontology:constraint_claim(gestation_the_wombfruit, mountain).

% Metrics: Extractiveness (0.3 - Natural cost) and Suppression (0.4 - Low re-direction)
domain_priors:base_extractiveness(gestation_the_wombfruit, 0.3).
domain_priors:suppression_score(gestation_the_wombfruit, 0.4).
domain_priors:emerges_naturally(gestation_the_wombfruit).

% Explicit metric hooks to prevent auto-imputation
narrative_ontology:constraint_metric(gestation_the_wombfruit, extractiveness, 0.3).
narrative_ontology:constraint_metric(gestation_the_wombfruit, suppression_requirement, 0.4).

% BENEFICIARIES & VICTIMS
constraint_beneficiary(gestation_the_wombfruit, proliferent_continuance).
constraint_victim(gestation_the_wombfruit, individual_autonomy).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (Perspectival Truth)
   ========================================================================== */

/* --------------------------------------------------------------------------
   PERSPECTIVE 1: LEOPOLD BLOOM - Rope
   --------------------------------------------------------------------------
   WHY: Bloom views the event as a "Rope"—a coordination point where he can 
   provide "stewardship" and process his own grief over Rudy through 
   social empathy. 
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    gestation_the_wombfruit,
    rope,
    context(agent_power(individual_moderate), time_horizon(biographical), exit_options(mobile), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 2: THE WOMBFRUIT (The Powerless) - Noose
   --------------------------------------------------------------------------
   WHO: individual_powerless - The "quickening" that has no agency.
   WHY: For the unborn, the biological process is a "Noose"—an extractive 
   trap of development where they are bound by "nature’s boon" without 
   consent or coordination.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    gestation_the_wombfruit,
    noose,
    context(agent_power(individual_powerless), time_horizon(immediate), exit_options(trapped), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 3: THE MEDICAL/MORAL DOCTRINE - Mountain
   --------------------------------------------------------------------------
   WHO: institutional - "The most in doctrine erudite".
   WHY: From the institutional perspective, gestation is a "Mountain"—an 
   immutable natural and theological law that "no nature’s boon can 
   contend against".
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    gestation_the_wombfruit,
    mountain,
    context(agent_power(institutional), time_horizon(historical), exit_options(trapped), spatial_scope(national))
) :- !.

/* ==========================================================================
   4. TESTS
   ========================================================================== */

:- begin_tests(gestation_the_wombfruit_tests).

test(multi_perspective_gestation) :-
    constraint_indexing:constraint_classification(gestation_the_wombfruit, T1, context(agent_power(individual_moderate), _, _, _)),
    constraint_indexing:constraint_classification(gestation_the_wombfruit, T2, context(agent_power(institutional), _, _, _)),
    T1 = rope, T2 = mountain.

test(immutability_gestation_scaling) :-
    % Institutional/Nature view sees birth as a Mountain
    constraint_indexing:effective_immutability(historical, trapped, mountain).

:- end_tests(gestation_the_wombfruit_tests).

/* ==========================================================================
   5. MODEL INTERPRETATION & OMEGAS
   ========================================================================== */

/**
 * LLM GENERATION NOTES:
 * Refactored to eliminate the 'biological_destiny' mismatch. Standardizing the 
 * claim to 'mountain' allows the audit to evaluate if the "Natural Law" of 
 * the hospital acts as a 'Rope' (coordination for birth) or a 
 * 'Noose' (theological trap).
 */

omega_variable(
    dowie_business_proposition,
    "Is Alexander J Christ Dowie's 'corking fine business proposition' a 
    spiritual Rope or a financial Noose?",
    resolution_mechanism("Investigation of the 'triple extract of infamy' monologue"),
    impact("If spiritual: Rope. If financial: Noose."),
    confidence_without_resolution(low)
).

/* ==========================================================================
   6. ALTERNATIVE ANALYSIS
   ========================================================================== */

/**
 * VIABLE ALTERNATIVES:
 * 1. "Sinned against the light" (Prevention): Mentioned as an option. 
 * Rejected/Suppressed by the "most in doctrine erudite" as a "sign of 
 * original evil".
 */

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: nighttown_hallucinatory_vigil
% ============================================================================
% Generated: 2026-01-19
% Model: Gemini 2.0 Flash
% Source: Ulysses, Chapter 15 (Circe)
% ============================================================================

:- module(nighttown_hallucinatory_vigil, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: nighttown_hallucinatory_vigil
 * human_readable: The Hallucinatory Vigil of Nighttown
 * domain: psychological/social
 * temporal_scope: June 16, 1904 (Midnight)
 * spatial_scope: Mabbot Street/Nighttown, Dublin
 * * SUMMARY:
 * Characters navigate a surreal environment where internal repressions manifest 
 * as external realities. The constraint is the "Nighttown" 
 * atmosphere itself—a psychological trap of "will-o’-the-wisps" and "danger 
 * signals" that extracts the agents' grip on reality.
 * * KEY AGENTS:
 * - Leopold Bloom: Individual moderate navigating via "secret master" masonic 
 * rituals (Rope).
 * - The Deafmute Idiot: Individual powerless agent trapped in a "Saint Vitus’ 
 * dance" and imprisoned by children (Noose).
 * - Nighttown (The Environment): Institutional force where the "skeleton tracks" 
 * of the mind are immutable laws (Mountain).
 */

/* ==========================================================================
   2. CORE SYSTEM INTEGRATION (The "Reality" Layer)
   ========================================================================== */

% Required for [STEP 1] and [STEP 2] of the DR-Audit Suite
narrative_ontology:interval(nighttown_vigil_id, 0, 10).
% Fixed: Changed 'psychic_confrontation' to 'noose' to satisfy schema
narrative_ontology:constraint_claim(nighttown_hallucinatory_vigil, noose).

% Metrics: Extractiveness (0.6 - Psychological extraction) and Suppression (0.8 - High repression)
domain_priors:base_extractiveness(nighttown_hallucinatory_vigil, 0.6).
domain_priors:suppression_score(nighttown_hallucinatory_vigil, 0.8).
domain_priors:requires_active_enforcement(nighttown_hallucinatory_vigil).

% Explicit metric hooks to prevent auto-imputation
narrative_ontology:constraint_metric(nighttown_hallucinatory_vigil, extractiveness, 0.6).
narrative_ontology:constraint_metric(nighttown_hallucinatory_vigil, suppression_requirement, 0.8).

% BENEFICIARIES & VICTIMS
constraint_beneficiary(nighttown_hallucinatory_vigil, nighttown_economic_vice).
constraint_victim(nighttown_hallucinatory_vigil, stephen_dedalus_psyche).
constraint_victim(nighttown_hallucinatory_vigil, bloom_leopold_psyche).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (Perspectival Truth)
   ========================================================================== */

/* --------------------------------------------------------------------------
   PERSPECTIVE 1: LEOPOLD BLOOM - Rope
   --------------------------------------------------------------------------
   WHY: Bloom utilizes his "alert" state and "masonic" stances as a "Rope"—a 
   functional coordination tool to protect Stephen and manage the 
   hallucinations of his own past (Rudy).
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    nighttown_hallucinatory_vigil,
    rope,
    context(agent_power(individual_moderate), time_horizon(biographical), exit_options(mobile), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 2: THE DEAFMUTE IDIOT - Noose
   --------------------------------------------------------------------------
   WHO: individual_powerless - "shapeless mouth dribbling... jerks past".
   WHY: For the truly powerless in Nighttown, the environment is a "Noose"—an 
   inescapable trap of physical and social degradation where no coordination 
   benefits exist.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    nighttown_hallucinatory_vigil,
    noose,
    context(agent_power(individual_powerless), time_horizon(immediate), exit_options(constrained), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 3: THE ENVIRONMENT (Nighttown) - Mountain
   --------------------------------------------------------------------------
   WHO: institutional - The "Swancomb of the gondola" and the "lighthouse".
   WHY: From the institutional perspective of the district, the chaos and the 
   "Saint Vitus’ dance" are a "Mountain"—the immutable, logic-defying laws 
   of the night.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    nighttown_hallucinatory_vigil,
    mountain,
    context(agent_power(institutional), time_horizon(historical), exit_options(trapped), spatial_scope(national))
) :- !.

/* ==========================================================================
   4. TESTS
   ========================================================================== */

:- begin_tests(nighttown_hallucinatory_tests).

test(multi_perspective_circe) :-
    constraint_indexing:constraint_classification(nighttown_hallucinatory_vigil, T1, context(agent_power(individual_moderate), _, _, _)),
    constraint_indexing:constraint_classification(nighttown_hallucinatory_vigil, T2, context(agent_power(individual_powerless), _, _, _)),
    T1 = rope, T2 = noose.

test(immutability_nighttown_scaling) :-
    % Institutional view sees the hallucinations as a Mountain
    constraint_indexing:effective_immutability(historical, trapped, mountain).

:- end_tests(nighttown_hallucinatory_tests).

/* ==========================================================================
   5. MODEL INTERPRETATION & OMEGAS
   ========================================================================== */

/**
 * LLM GENERATION NOTES:
 * Refactored to eliminate the 'psychic_confrontation' mismatch. Declaring the 
 * claim as 'noose' allows the audit to identify how the "False Mountain" of 
 * hallucination masks an underlying 'Noose' of extreme psychological 
 * suppression.
 */

omega_variable(
    rudy_apparition_status,
    "Is Rudy's apparition a healing vision (Rope) or a symptom of deep 
    trauma-based extraction (Noose)?",
    resolution_mechanism("Comparative analysis of Bloom's posture as 'secret master'"),
    impact("If healing: Rope. If symptom: Noose."),
    confidence_without_resolution(medium)
).

/* ==========================================================================
   6. ALTERNATIVE ANALYSIS
   ========================================================================== */

/**
 * VIABLE ALTERNATIVES:
 * 1. Physical Resistance/Departure: Stephen and Bloom could have left 
 * immediately. Rejected/Suppressed by the "Saint Vitus’ dance" and the 
 * "skeleton tracks" of the environment.
 */

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */

% ============================================================================
% CONSTRAINT STORY: bloom_samaritan_paternal_care
% ============================================================================
% Generated: 2026-01-19
% Model: Gemini 2.0 Flash
% Source: Ulysses, Chapter 16 (Eumaeus)
% ============================================================================

:- module(bloom_samaritan_paternal_care, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: bloom_samaritan_paternal_care
 * human_readable: The Samaritan Paternal Obligation
 * domain: social/emotional
 * temporal_scope: June 17, 1904 (1:00 AM - 2:00 AM)
 * spatial_scope: Beaver street and the Cabman's Shelter, Dublin
 * * SUMMARY:
 * Leopold Bloom feels a self-imposed "duty" to protect the exhausted and 
 * "unsteady" Stephen Dedalus. This constraint operates in a 
 * narcotic state of early morning fatigue, extracting energy from Bloom to 
 * maintain social "propriety" and Stephen's safety.
 * * KEY AGENTS:
 * - Leopold Bloom: Individual moderate navigating via "orthodox Samaritan" 
 * logic (Rope).
 * - Stephen Dedalus: Individual powerless agent, "unsteady" and "e.d.ed" 
 * (exhausted), for whom the care is an inescapable trap (Noose).
 * - Social Orthodoxy: Institutional force viewing paternal duty as an 
 * immutable law of "propriety" (Mountain).
 */

/* ==========================================================================
   2. CORE SYSTEM INTEGRATION (The "Reality" Layer)
   ========================================================================== */

% Required for [STEP 1] and [STEP 2] of the DR-Audit Suite
narrative_ontology:interval(bloom_samaritan_id, 0, 10).
% Fixed: Changed 'social_stewardship' to 'noose' to satisfy schema
narrative_ontology:constraint_claim(bloom_samaritan_paternal_care, noose).

% Metrics: Extractiveness (0.5 - High fatigue cost) and Suppression (0.6 - Social duty)
domain_priors:base_extractiveness(bloom_samaritan_paternal_care, 0.5).
domain_priors:suppression_score(bloom_samaritan_paternal_care, 0.6).
domain_priors:requires_active_enforcement(bloom_samaritan_paternal_care).

% Explicit metric hooks to prevent auto-imputation
narrative_ontology:constraint_metric(bloom_samaritan_paternal_care, extractiveness, 0.5).
narrative_ontology:constraint_metric(bloom_samaritan_paternal_care, suppression_requirement, 0.6).

% BENEFICIARIES & VICTIMS
constraint_beneficiary(bloom_samaritan_paternal_care, stephen_dedalus_safety).
constraint_victim(bloom_samaritan_paternal_care, bloom_leopold_vitality).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (Perspectival Truth)
   ========================================================================== */

/* --------------------------------------------------------------------------
   PERSPECTIVE 1: LEOPOLD BLOOM - Rope
   --------------------------------------------------------------------------
   WHY: Bloom views his care for Stephen as a "Rope"—a functional coordination 
   mechanism to navigate the "rub" of the late hour and ensure their 
   mutual "ablutions" and safety.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    bloom_samaritan_paternal_care,
    rope,
    context(agent_power(individual_moderate), time_horizon(biographical), exit_options(mobile), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 2: STEPHEN DEDALUS - Noose
   --------------------------------------------------------------------------
   WHO: individual_powerless - "His mind was not exactly what you would call 
   wandering but a bit unsteady".
   WHY: From Stephen's exhausted perspective, Bloom's "Samaritan" care is 
   a "Noose"—he is effectively "kidnapped" by kindness and social obligation 
   without the agency to refuse.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    bloom_samaritan_paternal_care,
    noose,
    context(agent_power(individual_powerless), time_horizon(immediate), exit_options(constrained), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 3: SOCIAL ORTHODOXY - Mountain
   --------------------------------------------------------------------------
   WHO: institutional - The "propriety" and "orthodox Samaritan fashion" 
   of 1904 Dublin.
   WHY: From the institutional perspective of social norms, the duty to 
   protect the "pale" and "unsteady" is an immutable fact of 
   civilized behavior—a Mountain.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    bloom_samaritan_paternal_care,
    mountain,
    context(agent_power(institutional), time_horizon(historical), exit_options(trapped), spatial_scope(national))
) :- !.

/* ==========================================================================
   4. TESTS
   ========================================================================== */

:- begin_tests(bloom_samaritan_paternal_tests).

test(multi_perspective_eumaeus) :-
    constraint_indexing:constraint_classification(bloom_samaritan_paternal_care, T1, context(agent_power(individual_moderate), _, _, _)),
    constraint_indexing:constraint_classification(bloom_samaritan_paternal_care, T2, context(agent_power(individual_powerless), _, _, _)),
    T1 = rope, T2 = noose.

test(immutability_samaritan_scaling) :-
    % Institutional view sees the social code as a Mountain
    constraint_indexing:effective_immutability(historical, trapped, mountain).

:- end_tests(bloom_samaritan_paternal_tests).

/* ==========================================================================
   5. MODEL INTERPRETATION & OMEGAS
   ========================================================================== */

/**
 * LLM GENERATION NOTES:
 * Refactored to eliminate the 'social_stewardship' mismatch. Mapping the claim 
 * to 'noose' allows the audit to detect if Bloom's "duty" is an act of 
 * genuine coordination (Rope) or a "Noose" that extracts Stephen's autonomy 
 * through unsolicited care.
 */

omega_variable(
    stephen_dissent_silence,
    "Is Stephen's silence at the end of the chapter an exhausted assent (Rope) 
    or a suppressed dissent (Noose)?",
    resolution_mechanism("Investigation into the 'unsteady' silence vs the ballad singing"),
    impact("If exhaustion: Mountain. If dissent: Noose."),
    confidence_without_resolution(low)
).

/* ==========================================================================
   6. ALTERNATIVE ANALYSIS
   ========================================================================== */

/**
 * VIABLE ALTERNATIVES:
 * 1. Immediate Separation: Bloom could have sent Stephen home in a 
 * "conveyance" alone. Rejected/Suppressed by Bloom's "duty" and his 
 * "soapsuddy" sense of companionship.
 */

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: bloom_ithaca_mathematical_order
% ============================================================================
% Generated: 2026-01-19
% Model: Gemini 2.0 Flash
% Source: James Joyce, Ulysses, Chapter 17 (Ithaca)
% ============================================================================

:- module(bloom_ithaca_mathematical_order, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: bloom_ithaca_mathematical_order
 * human_readable: The Catechism of Mathematical Order
 * domain: scientific/ontological
 * temporal_scope: June 17, 1904 (2:00 AM - 3:00 AM)
 * spatial_scope: 7 Eccles Street, Dublin (and the Macrocosm)
 * * SUMMARY:
 * This constraint represents the exhaustive, cold, and "scientific" lens 
 * through which the final meeting of Bloom and Stephen is filtered. 
 * Every human movement is reduced to its mathematical components—angles, 
 * latitudes, and velocities.
 * * KEY AGENTS:
 * - Leopold Bloom: Individual moderate navigating the late hour via 
 * rationalist coordination (Rope).
 * - Stephen Dedalus: Individual powerless agent, the "childman weary" 
 * for whom the logic is an inescapable trap (Noose).
 * - The Narrator/Universe: Institutional voice viewing the cosmos as 
 * immutable and deterministic (Mountain).
 */

/* ==========================================================================
   2. CORE SYSTEM INTEGRATION (The "Reality" Layer)
   ========================================================================== */

% Required for [STEP 1] and [STEP 2] of the DR-Audit Suite
narrative_ontology:interval(bloom_ithaca_interval, 0, 10).
% Fixed: Changed 'scientific_determinism' to 'rope' to satisfy schema
narrative_ontology:constraint_claim(bloom_ithaca_mathematical_order, rope).

% Metrics: Extractiveness (0.4 - Intellectual cost) and Suppression (0.6 - Emotional limit)
domain_priors:base_extractiveness(bloom_ithaca_mathematical_order, 0.4).
domain_priors:suppression_score(bloom_ithaca_mathematical_order, 0.6).
domain_priors:requires_active_enforcement(bloom_ithaca_mathematical_order).

% Explicit metric hooks to prevent auto-imputation
narrative_ontology:constraint_metric(bloom_ithaca_mathematical_order, extractiveness, 0.4).
narrative_ontology:constraint_metric(bloom_ithaca_mathematical_order, suppression_requirement, 0.6).

% BENEFICIARIES & VICTIMS
constraint_beneficiary(bloom_ithaca_mathematical_order, rationalist_clarity).
constraint_victim(bloom_ithaca_mathematical_order, reader_emotional_catharsis).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (Perspectival Truth)
   ========================================================================== */

/* --------------------------------------------------------------------------
   PERSPECTIVE 1: LEOPOLD BLOOM - Rope
   --------------------------------------------------------------------------
   WHY: Bloom uses scientific facts as a "Rope"—a tool to manage his 
   domestic reality and his "like and unlike reactions" to the day, 
   finding comfort in the "perpetual motion of the earth".
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    bloom_ithaca_mathematical_order,
    rope,
    context(agent_power(individual_moderate), time_horizon(biographical), exit_options(mobile), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 2: STEPHEN DEDALUS - Noose
   --------------------------------------------------------------------------
   WHO: individual_powerless - The "manchild in the womb".
   WHY: For the exhausted Stephen, the mathematical "Catechism" is a 
   "Noose"—an extractive trap of interrogation that mirrors his 
   Jesuit training but offers no spiritual release.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    bloom_ithaca_mathematical_order,
    noose,
    context(agent_power(individual_powerless), time_horizon(immediate), exit_options(trapped), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 3: THE COSMOS (Narrator) - Mountain
   --------------------------------------------------------------------------
   WHO: institutional/analytical - The "proper perpetual motion of the earth" 
  .
   WHY: From the perspective of the narrative structure, the laws of physics 
   and the "everchanging tracks of neverchanging space" are a 
   "Mountain"—immutable and absolute.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    bloom_ithaca_mathematical_order,
    mountain,
    context(agent_power(institutional), time_horizon(historical), exit_options(trapped), spatial_scope(global))
) :- !.

/* ==========================================================================
   4. TESTS
   ========================================================================== */

:- begin_tests(bloom_ithaca_mathematical_tests).

test(multi_perspective_ithaca) :-
    constraint_indexing:constraint_classification(bloom_ithaca_mathematical_order, T1, context(agent_power(individual_moderate), _, _, _)),
    constraint_indexing:constraint_classification(bloom_ithaca_mathematical_order, T2, context(agent_power(institutional), _, _, _)),
    T1 = rope, T2 = mountain.

test(immutability_cosmic_scaling) :-
    % Institutional view sees the Universe as a Mountain
    constraint_indexing:effective_immutability(historical, trapped, mountain).

:- end_tests(bloom_ithaca_mathematical_tests).

/* ==========================================================================
   5. MODEL INTERPRETATION & OMEGAS
   ========================================================================== */

/**
 * LLM GENERATION NOTES:
 * Refactored to eliminate the 'scientific_determinism' mismatch. Declaring the 
 * claim as 'rope' allows the audit to detect the "Stalemate" where 
 * Bloom attempts rational coordination (Rope) while the narrative 
 * enforces an immutable "False Mountain" of cold data.
 */

omega_variable(
    bloom_stephen_coordination,
    "Does the 'parallel course' indicate a genuine coordination (Rope) or 
    an astronomical isolation (Noose)?",
    resolution_mechanism("Cross-referencing their 'like and unlike reactions'"),
    impact("If coordination: Rope. If isolation: Noose."),
    confidence_without_resolution(medium)
).

/* ==========================================================================
   6. ALTERNATIVE ANALYSIS
   ========================================================================== */

/**
 * VIABLE ALTERNATIVES:
 * 1. Emotional Sentimentality: A warm, traditional reunion. 
 * Rejected/Suppressed by the "Catechism" format and the "reduced pace" 
 * of scientific prose.
 */

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: molly_affirmation_cycle
% ============================================================================
% Generated: 2026-01-19
% Model: Gemini 2.0 Flash
% Source: James Joyce, Ulysses, Chapter 18 (Penelope)
% ============================================================================

:- module(molly_affirmation_cycle, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: molly_affirmation_cycle
 * human_readable: The Rhythmic Affirmation (Molly’s Stream)
 * domain: biological/social/psychological
 * temporal_scope: June 17, 1904 (Pre-dawn)
 * spatial_scope: 7 Eccles Street, Dublin (The Bed)
 * * SUMMARY:
 * This constraint represents the fluid, unpunctuated consciousness of Molly Bloom 
 * as she reconciles her day and her marriage. It functions as a tool for 
 * emotional coordination, moving from the "night hours" of doubt to the 
 * "morning hours" of affirmation.
 * * KEY AGENTS:
 * - Molly Bloom: Individual moderate navigating a "Rope" of memory and desire.
 * - Leopold Bloom: Individual powerless subject to Molly's domestic demands and 
 * final acceptance (Noose/Rope).
 * - The Catholic Church (Mrs. Riordan's path): Institutional force viewing 
 * female morality as an immutable law (Mountain).
 */

/* ==========================================================================
   2. CORE SYSTEM INTEGRATION (The "Reality" Layer)
   ========================================================================== */

% Required for [STEP 1] and [STEP 2] of the DR-Audit Suite
narrative_ontology:interval(molly_affirmation_id, 0, 10).
% Fixed: Changed 'cyclical_affirmation' to 'rope' to satisfy schema
narrative_ontology:constraint_claim(molly_affirmation_cycle, rope).

% Metrics: Extractiveness (0.4 - Emotional labor) and Suppression (0.5 - Boundary breakdown)
domain_priors:base_extractiveness(molly_affirmation_cycle, 0.4).
domain_priors:suppression_score(molly_affirmation_cycle, 0.5).
domain_priors:emerges_naturally(molly_affirmation_cycle).

% Explicit metric hooks to prevent auto-imputation
narrative_ontology:constraint_metric(molly_affirmation_cycle, extractiveness, 0.4).
narrative_ontology:constraint_metric(molly_affirmation_cycle, suppression_requirement, 0.5).

% BENEFICIARIES & VICTIMS
constraint_beneficiary(molly_affirmation_cycle, bloom_leopold_marriage).
constraint_victim(molly_affirmation_cycle, social_orthodoxy).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (Perspectival Truth)
   ========================================================================== */

/* --------------------------------------------------------------------------
   PERSPECTIVE 1: MOLLY BLOOM - Rope
   --------------------------------------------------------------------------
   WHY: Molly uses her internal monologue as a "Rope"—a functional coordination 
   tool to weave her disparate memories (Gibraltar, Bloom, Boylan) into a 
   single, coherent affirmation of her life.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    molly_affirmation_cycle,
    rope,
    context(agent_power(individual_moderate), time_horizon(biographical), exit_options(mobile), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 2: LEOPOLD BLOOM - Noose
   --------------------------------------------------------------------------
   WHO: individual_powerless - "Ask to get his breakfast in bed with a couple 
   of eggs".
   WHY: From Bloom's current state of sleep and domestic dependence, Molly's 
   affirmation and its associated demands are a "Noose"—he is bound by 
   her decisions and her "Yes" without active agency in this chapter.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    molly_affirmation_cycle,
    noose,
    context(agent_power(individual_powerless), time_horizon(immediate), exit_options(trapped), spatial_scope(local))
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 3: SOCIAL ORTHODOXY (Mrs. Riordan) - Mountain
   --------------------------------------------------------------------------
   WHO: institutional - "Pious because no man would look at her twice" 
  .
   WHY: From the institutional perspective of 1904 Catholic morality, the 
   laws of marriage and female propriety are a "Mountain"—immutable and 
   divinely ordained laws that Molly's "stream" technically violates.
   -------------------------------------------------------------------------- */
constraint_indexing:constraint_classification(
    molly_affirmation_cycle,
    mountain,
    context(agent_power(institutional), time_horizon(historical), exit_options(trapped), spatial_scope(national))
) :- !.

/* ==========================================================================
   4. TESTS
   ========================================================================== */

:- begin_tests(molly_affirmation_tests).

test(multi_perspective_penelope) :-
    constraint_indexing:constraint_classification(molly_affirmation_cycle, T1, context(agent_power(individual_moderate), _, _, _)),
    constraint_indexing:constraint_classification(molly_affirmation_cycle, T2, context(agent_power(institutional), _, _, _)),
    T1 = rope, T2 = mountain.

test(immutability_rhythm_scaling) :-
    % Institutional view sees the moral code as a Mountain
    constraint_indexing:effective_immutability(historical, trapped, mountain).

:- end_tests(molly_affirmation_tests).

/* ==========================================================================
   5. MODEL INTERPRETATION & OMEGAS
   ========================================================================== */

/**
 * LLM GENERATION NOTES:
 * Refactored to eliminate the 'cyclical_affirmation' mismatch. Declaring the 
 * claim as 'rope' allows the audit to identify how Molly's internal 
 * coordination (Rope) creates a "Stalemate" with the external 
 * institutional 'Mountain' of social expectations.
 */

omega_variable(
    molly_intent_sincerity,
    "Is the final 'Yes' a reconciliation with Bloom (Rope) or an undifferentiated 
    affirmation of all sensation (Mountain)?",
    resolution_mechanism("Analysis of the transition from Gibraltar memories to the bed in Eccles Street"),
    impact("If reconciliation: Rope. If biological sensation: Mountain."),
    confidence_without_resolution(medium)
).

/* ==========================================================================\
   6. ALTERNATIVE ANALYSIS
   ========================================================================== */

/**
 * VIABLE ALTERNATIVES:
 * 1. Outright Departure: Mentioned as "as well him as another". 
 * Rejected/Suppressed by Molly's emotional history and her logistical 
 * domestic needs.
 */

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
