% ============================================================================
% CONSTRAINT STORY: magna_carta_liberties
% ============================================================================
% Generated: 2026-01-20
% Model: Gemini 2.0 Flash
% Source: The Magna Carta (1215)
% ============================================================================

:- module(constraint_magna_carta_liberties, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:constraint_metric/3,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: magna_carta_liberties
 * human_readable: The Great Charter of Liberties
 * domain: political/legal
 * temporal_scope: 1215 CE (High Middle Ages)
 * spatial_scope: Kingdom of England
 * * SUMMARY:
 * The Magna Carta is a peace treaty between King John and a group of rebellious 
 * barons. It establishes that the monarch is not above the law and defines specific 
 * liberties regarding due process (Clause 39), church freedom, and limits on 
 * feudal payments ("reliefs"). It introduces a security clause (Clause 61) 
 * empowering a council of twenty-five barons to "distrain and distress" the King 
 * if he fails to uphold the charter.
 * * KEY AGENTS:
 * - King John: The institutional ruler whose absolute power is being curtailed.
 * - The Twenty-Five Barons: The collective organized enforcers of the security clause.
 * - The Free Man: The individual subject who gains specific protections against arbitrary seizure.
 * * NARRATIVE ARC:
 * Born from "discord that has arisen," the Charter moves from absolute royal 
 * prerogative toward a coordinated legal order. It seeks to "allay the discord" 
 * by turning the King's arbitrary power into a "Rope" of shared rules, though 
 * to the King, it is experienced as a "Snare" of coercion.
 */

/* ==========================================================================
   2. CORE SYSTEM INTEGRATION (The "Reality" Layer)
   ========================================================================== */

narrative_ontology:interval(magna_carta_liberties, 0, 10).
narrative_ontology:constraint_claim(magna_carta_liberties, rope).

% Base extractiveness: Moderate (0.4)
% Rationale: While it limits the King's extraction, it codifies standard 
% feudal "reliefs" (100 pounds for a barony) and services[cite: 2, 16].
domain_priors:base_extractiveness(magna_carta_liberties, 0.4).

% Suppression score: High (0.8)
% Rationale: Explicitly abolishes "evil customs" regarding forests and 
% mandates the removal of foreign mercenaries[cite: 48, 51].
domain_priors:suppression_score(magna_carta_liberties, 0.8).

% Constraint metric facts (bridge for classification engine)
narrative_ontology:constraint_metric(magna_carta_liberties, extractiveness, 0.4).
narrative_ontology:constraint_metric(magna_carta_liberties, suppression_requirement, 0.8).

% Enforcement: Requires active monitoring by the 25 barons.
domain_priors:requires_active_enforcement(magna_carta_liberties).

% Metrics for Section 1 of the Executive Summary
% BENEFICIARIES & VICTIMS
constraint_beneficiary(magna_carta_liberties, [the_barons, the_english_church, free_men]).
constraint_victim(magna_carta_liberties, [arbitrary_monarchy, foreign_mercenaries]).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (Perspectival Truth)
   ========================================================================== */

/* --------------------------------------------------------------------------
   PERSPECTIVE 1: THE FREE MAN - Mountain
   --------------------------------------------------------------------------
   
   WHO: powerless - Subject to "the law of the land".
   WHEN: immediate - Experience of arrest or seizure.
   WHERE: trapped - Bound by the jurisdiction of the county courts[cite: 18].
   SCOPE: national - Applies "throughout our whole realm"[cite: 35].
   
   WHY THIS CLASSIFICATION:
   For the individual free man, the Charter's protections (like standard 
   weights and measures or due process) function as an unchangeable 
   "Mountain." He does not have the power to negotiate these rules; 
   they are presented as "confirmed for us and our heirs in perpetuity" 
   [cite: 1].
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    magna_carta_liberties,
    mountain,
    context(
        agent_power(powerless),
        time_horizon(immediate),
        exit_options(trapped),
        constraint_beneficiary(magna_carta_liberties, free_men),
        constraint_victim(magna_carta_liberties, []),
        spatial_scope(national)
    )
) :-
    domain_priors:suppression_score(magna_carta_liberties, S),
    S > 0.7,
    !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 2: THE BARONS - Rope
   --------------------------------------------------------------------------
   
   WHO: collective_organized - The twenty-five barons elected to "keep the peace".
   WHEN: biographical - During their tenure as guardians.
   WHERE: arbitrage - They balance the King's needs against the Charter's violations.
   SCOPE: national - Protecting the "whole community of the land".
   
   WHY THIS CLASSIFICATION:
   To the Barons, the Charter is a "Rope"—a functional coordination mechanism. 
   It provides the specific procedures ("forty days notice," "majority verdict") 
   by which they can manage the King's behavior and their own cooperation 
   [cite: 14, 61].
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    magna_carta_liberties,
    rope,
    context(
        agent_power(collective_organized),
        time_horizon(biographical),
        exit_options(arbitrage),
        constraint_beneficiary(magna_carta_liberties, the_barons),
        constraint_victim(magna_carta_liberties, []),
        spatial_scope(national)
    )
) :-
    !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 3: KING JOHN - Snare
   --------------------------------------------------------------------------
   
   WHO: institutional - The monarch whose will is restricted.
   WHEN: immediate - Under the threat of distraint by the barons.
   WHERE: constrained - Prevented from seizing wood or carts without consent[cite: 30, 31].
   SCOPE: national - His entire executive power is limited.
   
   WHY THIS CLASSIFICATION:
   For King John, the Charter is a "Snare." It is a coercive mechanism 
   imposed by the Barons that extracts his absolute authority and 
   authorizes the community to "assail us in every way possible" if 
   he deviates from the text.
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    magna_carta_liberties,
    snare,
    context(
        agent_power(institutional),
        time_horizon(immediate),
        exit_options(constrained),
        constraint_beneficiary(magna_carta_liberties, the_barons),
        constraint_victim(magna_carta_liberties, arbitrary_monarchy),
        spatial_scope(national)
    )
) :-
    domain_priors:base_extractiveness(magna_carta_liberties, E),
    E > 0.3,
    !.

/* ==========================================================================
   4. TESTS (Validation of Insights)
   ========================================================================== */

:- begin_tests(magna_carta_tests).

test(baronial_coordination) :-
    % Barons see a Rope for coordination
    constraint_indexing:constraint_classification(magna_carta_liberties, rope, context(agent_power(collective_organized), _, _, _, _, _)).

test(monarch_coercion) :-
    % King sees a Snare because of Clause 61 (distraint)
    constraint_indexing:constraint_classification(magna_carta_liberties, snare, context(agent_power(institutional), _, constrained, _, _, _)).

test(due_process_mountain) :-
    % For the powerless, due process is a fixed Mountain of protection
    constraint_indexing:constraint_classification(magna_carta_liberties, mountain, context(agent_power(powerless), _, _, _, _, _)).

:- end_tests(magna_carta_tests).

/* ==========================================================================
   5. MODEL INTERPRETATION (Commentary)
   ========================================================================== */

/**
 * GENERATING MODEL INTERPRETATION:
 * * The Magna Carta presents a classic "Perspectival Gap." 
 * 1. The document is ostensibly a "Rope" for the kingdom, intending to 
 * provide "better ordering"[cite: 1]. 
 * 2. However, Clause 61 (the Security Clause) is the pivot. By authorizing 
 * the barons to seize royal property, it moves the King from a "Rope" 
 * maker to a "Snare" subject. 
 * 3. Interestingly, the document attempts to frame its own "Mountain" 
 * nature by using the term "in perpetuity"[cite: 1], signaling that 
 * these rights are now part of the natural law of England.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    clause_61_viability,
    "Could a council of 25 barons effectively coordinate a seizure of royal assets without devolving into civil war?",
    resolution_mechanism("Historical record of the First Barons' War immediately following 1215."),
    impact("If civil war is inevitable, Clause 61 is a failed coordination mechanism (slack Rope)."),
    confidence_without_resolution(low)
).

omega_variable(
    free_man_definition,
    "To what extent did the 'liberties' apply to unfree villeins vs. landed elite?",
    resolution_mechanism("Analysis of Clause 20 vs. Clause 39 language regarding 'villeins' and 'free men'."),
    impact("If exclusive, the 'Mountain' of rights exists only for the elite, leaving the poor in a Snare of local lords."),
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. ALTERNATIVE ANALYSIS
   ========================================================================== */

/**
 * VIABLE ALTERNATIVES:
 * * ALTERNATIVE 1: Absolute Monarchy (Angevin Kingship)
 * Viability: The status quo established by Henry II and Richard I.
 * Suppression: Rejected by the barons through military rebellion.
 * Evidence: The Preamble notes the "discord that has arisen"[cite: 1].
 * * ALTERNATIVE 2: Papal Supremacy
 * Viability: King John had already made England a papal fief in 1213.
 * Suppression: The Barons ignored the Pope's later annulment of the charter.
 * Evidence: Clause 1 mentions ratification by Pope Innocent III[cite: 1].
 * * CONCLUSION:
 * The rejection of Absolute Monarchy (Alternative 1) is what necessitates 
 * the "Snare" classification from the King's perspective. He is no 
 * longer the source of law but its subject.
 */

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: maha_recovery_2026
% ============================================================================
% Version: 3.4 (Deferential Realism Core)
% Logic: 3.3 (Indexed Tuple P,T,E,S)
% Generated: 2026-02-06
% ============================================================================

:- module(constraint_maha_recovery, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: maha_recovery_2026
 * human_readable: The MAHA Initiative (Great American Recovery)
 * domain: health/agriculture
 * * SUMMARY:
 * A national-scale health and agricultural restructuring agenda led by HHS. 
 * It functions as a Scaffold—imposing temporary systemic costs to transition 
 * the American diet away from ultra-processed dominance toward regenerative 
 * agricultural outputs.
 * * KEY AGENTS:
 * - Citizens: Subject (Powerless) - Facing dietary transition costs.
 * - Cattle Ranchers: Beneficiary (Institutional) - Restored to economic centrality.
 * - HHS/Governors: Auditor (Analytical) - Enforcing the recovery transition.
 * * THEORETICAL MODEL:
 * $$E_{maha} = \frac{C_{transition}}{U_{health}}$$
 * Where $E$ represents extractiveness, $C$ is the cost of systemic transition 
 * (agricultural subsidies/input changes), and $U$ is the perceived long-term 
 * utility of biological recovery.
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(maha_recovery_2026, 0.42). 
domain_priors:suppression_score(maha_recovery_2026, 0.35).   
domain_priors:theater_ratio(maha_recovery_2026, 0.65).       

% Primary keys for classification engine
narrative_ontology:constraint_metric(maha_recovery_2026, extractiveness, 0.42).
narrative_ontology:constraint_metric(maha_recovery_2026, suppression_requirement, 0.35).
narrative_ontology:constraint_metric(maha_recovery_2026, theater_ratio, 0.65).

% Scaffold Classification Requirements
narrative_ontology:has_sunset_clause(maha_recovery_2026).
narrative_ontology:constraint_beneficiary(maha_recovery_2026, cattle_ranchers).
narrative_ontology:constraint_victim(maha_recovery_2026, upf_manufacturers).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   ========================================================================== */

% PERSPECTIVE 1: THE SUBJECT (SNARE)
% Effective Extraction: 0.42 * 1.5 (powerless) * 1.0 (national) = 0.63.
% High extraction felt as a restrictive trap on existing dietary habits.
constraint_indexing:constraint_classification(maha_recovery_2026, snare, 
    context(agent_power(powerless), 
            time_horizon(biographical), 
            exit_options(trapped), 
            spatial_scope(national))).

% PERSPECTIVE 2: THE BENEFICIARY (SCAFFOLD)
% Effective Extraction: 0.42 * -0.2 (institutional) * 1.0 = -0.084.
% Viewed as temporary, essential coordination for biological recovery.
constraint_indexing:constraint_classification(maha_recovery_2026, scaffold, 
    context(agent_power(institutional), 
            time_horizon(generational), 
            exit_options(mobile), 
            spatial_scope(national))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER
% Default context for the system's baseline claim.
constraint_indexing:constraint_classification(maha_recovery_2026, scaffold,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(maha_recovery_2026_tests).

test(perspectival_gap) :-
    % Verify the gap between the citizen (Snare) and the Rancher/HHS (Scaffold).
    constraint_indexing:constraint_classification(maha_recovery_2026, snare, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(maha_recovery_2026, scaffold, context(agent_power(institutional), _, _, _)).

test(scaffold_integrity) :-
    % Ensure Scaffold requirements are present.
    narrative_ontology:has_sunset_clause(maha_recovery_2026),
    narrative_ontology:constraint_beneficiary(maha_recovery_2026, _).

:- end_tests(maha_recovery_2026_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * The "Perspectival Gap" arises because the powerless agent experiences 
 * the 0.42 base extraction scaled by the 1.5 power modifier ($\chi = 0.63$). 
 * This makes the removal of ultra-processed food (UPF) options feel like 
 * a "Snare"—an imposition with high biographical friction. 
 * Conversely, institutional agents see a negative effective extraction, 
 * perceiving the initiative as a net-gain coordination event.
 *
 * MANDATROPHY ANALYSIS:
 * The Scaffold classification prevents this from being labeled a permanent 
 * Snare by anchoring it to a Sunset Clause. The system recognizes it 
 * as coordination that *looks* like extraction to those bearing the 
 * immediate transition costs.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_maha_2026,
    'Will cattle ranching restoration lead to market consolidation?',
    'Review of USDA land ownership and market share data in 2027.',
    'Consolidation turns the Scaffold into a permanent Snare; decentralization preserves the Rope.',
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

narrative_ontology:interval(maha_recovery_2026, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Theater ratio drift (modeling public sentiment normalization)
narrative_ontology:measurement(maha_tr_t0, maha_recovery_2026, theater_ratio, 0, 0.65).
narrative_ontology:measurement(maha_tr_t5, maha_recovery_2026, theater_ratio, 5, 0.55).
narrative_ontology:measurement(maha_tr_t10, maha_recovery_2026, theater_ratio, 10, 0.40).

% Extraction drift (modeling the reduction of transition friction over time)
narrative_ontology:measurement(maha_ex_t0, maha_recovery_2026, base_extractiveness, 0, 0.42).
narrative_ontology:measurement(maha_ex_t5, maha_recovery_2026, base_extractiveness, 5, 0.30).
narrative_ontology:measurement(maha_ex_t10, maha_recovery_2026, base_extractiveness, 10, 0.15).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: mandatrophic_margin_collapse
% ============================================================================
% Version: 5.2 (Deferential Realism Core + Boltzmann + Purity + Network)
% Logic: 5.2 (Indexed Tuple P,T,E,S + Coupling + Purity + Network Drift)
% Generated: 2024-07-27
% ============================================================================

:- module(constraint_mandatrophic_margin_collapse, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    narrative_ontology:constraint_claim/2,
    narrative_ontology:affects_constraint/2,
    narrative_ontology:coordination_type/2,
    narrative_ontology:boltzmann_floor_override/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: mandatrophic_margin_collapse
 * human_readable: Mandatrophy (The Extraction of Margin for Mandate)
 * domain: institutional/technological
 * * SUMMARY:
 * Mandatrophy is the systemic wasting away of resilience caused by the rigid
 * prioritization of a top-down administrative mandate over the organic
 * margins (buffers, redundancies, or "slack") required for survival.
 * As the mandate extracts the margin to achieve "efficiency," the system
 * transitions from a flexible state to a brittle one, vulnerable to collapse.
 * * KEY AGENTS:
 * - The Mandator: Institutional; sets the "KPI" or "Mandate" and views
 * all unused resources (margins) as waste.
 * - The Systemic Operator: Powerless; manages the actual friction of the
 * real world and recognizes the danger of the Snare.
 * - The Stress Event: Analytical; the external disruption that
 * reveals the Mountain of physical reality once the margin is gone.
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(mandatrophic_margin_collapse, 0.85). % Mountain suppression <= 0.05, Rope extraction <= 0.15, Snare extraction >= 0.46
domain_priors:suppression_score(mandatrophic_margin_collapse, 0.70).   % Structural property (raw, unscaled). Only extractiveness is scaled (by power and scope).
domain_priors:theater_ratio(mandatrophic_margin_collapse, 0.40).       % Piton detection (>= 0.70)

% Constraint metric facts — primary keys used by the classification engine.
% These mirror domain_priors values using the metric key names from config.pl.
narrative_ontology:constraint_metric(mandatrophic_margin_collapse, extractiveness, 0.85).
narrative_ontology:constraint_metric(mandatrophic_margin_collapse, suppression_requirement, 0.70).
narrative_ontology:constraint_metric(mandatrophic_margin_collapse, theater_ratio, 0.40).

% Constraint self-claim (what does the constraint claim to be?)
% Values: natural_law, coordination, constructed, enforcement
narrative_ontology:constraint_claim(mandatrophic_margin_collapse, enforcement).

% Binary flags
domain_priors:requires_active_enforcement(mandatrophic_margin_collapse). % Required for Tangled Rope

% Structural property derivation hooks:
%   has_coordination_function/1 is DERIVED from constraint_beneficiary/2
%   has_asymmetric_extraction/1 is DERIVED from constraint_victim/2
narrative_ontology:constraint_beneficiary(mandatrophic_margin_collapse, quarterly_metrics).
narrative_ontology:constraint_beneficiary(mandatrophic_margin_collapse, short_term_efficiency).
narrative_ontology:constraint_victim(mandatrophic_margin_collapse, systemic_resilience).
narrative_ontology:constraint_victim(mandatrophic_margin_collapse, long_term_viability).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   Power (P) and Scope (S) both affect effective extraction.
   Scope modifiers: local=0.8, regional=0.9, national=1.0,
                    continental=1.1, global=1.2, universal=1.0.
   ========================================================================== */

% PERSPECTIVE 1: THE SYSTEMIC OPERATOR (SNARE)
% High extraction felt as a predatory trap that removes the tools for survival.
constraint_indexing:constraint_classification(mandatrophic_margin_collapse, snare,
    context(agent_power(powerless),
            time_horizon(biographical),
            exit_options(trapped),
            spatial_scope(local))).

% PERSPECTIVE 2: THE MANDATOR (ROPE)
% Viewed as an essential coordination mechanism to eliminate waste and improve efficiency.
constraint_indexing:constraint_classification(mandatrophic_margin_collapse, rope,
    context(agent_power(institutional),
            time_horizon(generational),
            exit_options(mobile),
            spatial_scope(national))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (TANGLED ROPE)
% Recognizes both the coordination claim and the severe asymmetric extraction.
% The system is a Tangled Rope: it has a coordination function (beneficiary exists),
% asymmetric extraction (victim exists), and requires active enforcement.
constraint_indexing:constraint_classification(mandatrophic_margin_collapse, tangled_rope,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(mandatrophic_margin_collapse_tests).

test(perspectival_gap) :-
    % Verify there is a perspectival gap between powerless and institutional.
    constraint_indexing:constraint_classification(mandatrophic_margin_collapse, TypePowerless, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(mandatrophic_margin_collapse, TypeInstitutional, context(agent_power(institutional), _, _, _)),
    TypePowerless \= TypeInstitutional,
    TypePowerless == snare,
    TypeInstitutional == rope.

test(analytical_classification_is_tangled_rope) :-
    % The analytical observer should correctly identify the hybrid nature.
    constraint_indexing:constraint_classification(mandatrophic_margin_collapse, tangled_rope, context(agent_power(analytical), _, _, _)).

test(threshold_validation) :-
    % High extraction confirms Snare/Tangled Rope status.
    domain_priors:base_extractiveness(mandatrophic_margin_collapse, E),
    E > 0.46.

:- end_tests(mandatrophic_margin_collapse_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * [RESOLVED MANDATROPHY]
 * The core of this constraint is the perspectival gap between efficiency and resilience.
 * The Mandator (institutional) sees margin as waste, so their mandate to eliminate it
 * appears as a pure coordination 'Rope'. The Operator (powerless), who relies on that
 * margin to handle real-world friction, experiences its removal as an extractive 'Snare'
 * that increases risk and brittleness. The base extractiveness (0.85) is high because
 * the mandate consumes the system's capacity for future survival to meet present targets.
 * Suppression (0.70) is high because concepts like "slack" or "resilience engineering"
 * are actively framed as inefficient and wasteful, suppressing alternatives.
 *
 * * MANDATROPHY ANALYSIS:
 * The Analytical Observer classifies this as a 'Tangled Rope'. This is critical because
 * it prevents the system from simplifying the dynamic into a pure Snare. The Mandator's
 * goal *is* a form of coordination (aligning the system to a metric), which is why
 * `constraint_beneficiary` is declared. However, this coordination is achieved through
 * severe asymmetric extraction from the system's long-term viability, captured by
 * `constraint_victim`. The `requires_active_enforcement` flag confirms that this is not
 * a self-sustaining coordination but one that must be coercively imposed. This hybrid
 * classification correctly identifies that a seemingly rational goal can become a
 * destructive extractive mechanism.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

% omega_variable(ID, Question, Resolution_Mechanism, Impact, Confidence).
omega_variable(
    omega_mandatrophic_margin_collapse,
    "Can 'margin' ever be accurately measured by the Mandator, or is it an irreducible qualitative property only visible to the Operator?",
    "Comparative analysis of quantitative vs. qualitative risk assessments in failed aerospace and infrastructure projects.",
    "If Measurable: The mandate is a flawed Rope. If Irreducible: The mandate is a structural Snare.",
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

% Required for external script parsing
narrative_ontology:interval(mandatrophic_margin_collapse, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Temporal data enables drift detection. This models the mandate starting as a
% genuine, low-extraction coordination effort that intensifies over time,
% extracting more and more systemic resilience.
% Required for high-extraction constraints (base_extractiveness > 0.46).

% Theater ratio over time (mandate becomes more performative as real margin vanishes):
narrative_ontology:measurement(mandatrophic_margin_collapse_tr_t0, mandatrophic_margin_collapse, theater_ratio, 0, 0.10).
narrative_ontology:measurement(mandatrophic_margin_collapse_tr_t5, mandatrophic_margin_collapse, theater_ratio, 5, 0.25).
narrative_ontology:measurement(mandatrophic_margin_collapse_tr_t10, mandatrophic_margin_collapse, theater_ratio, 10, 0.40).

% Extraction over time (the mandate's "bite" increases):
narrative_ontology:measurement(mandatrophic_margin_collapse_ex_t0, mandatrophic_margin_collapse, base_extractiveness, 0, 0.20).
narrative_ontology:measurement(mandatrophic_margin_collapse_ex_t5, mandatrophic_margin_collapse, base_extractiveness, 5, 0.65).
narrative_ontology:measurement(mandatrophic_margin_collapse_ex_t10, mandatrophic_margin_collapse, base_extractiveness, 10, 0.85).

/* ==========================================================================
   9. BOLTZMANN & NETWORK DATA (v5.0-5.2)
   ========================================================================== */

% Coordination type (enables Boltzmann floor + complexity offset)
% The mandate is a mechanism for enforcing a specific behavior or outcome.
narrative_ontology:coordination_type(mandatrophic_margin_collapse, enforcement_mechanism).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */% ============================================================================
% CONSTRAINT STORY: mandatrophy_systemic_collapse
% ============================================================================
% Version: 5.2 (Deferential Realism Core + Boltzmann + Purity + Network)
% Logic: 5.2 (Indexed Tuple P,T,E,S + Coupling + Purity + Network Drift)
% Generated: 2024-07-20
% ============================================================================

:- module(constraint_mandatrophy_systemic_collapse, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    narrative_ontology:constraint_claim/2,
    narrative_ontology:affects_constraint/2,
    narrative_ontology:coordination_type/2,
    narrative_ontology:boltzmann_floor_override/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   [RESOLVED MANDATROPHY]
   MANDATROPHY RESOLUTION: This constraint's extreme extraction (0.9) is resolved
   by classifying it as a Tangled Rope from an analytical perspective. The
   mandate provides a genuine, albeit perverse, coordination function (aligning
   the organization towards a single metric), which is why beneficiaries
   perceive it as a Rope. However, this coordination is achieved by extracting
   the system's resilience and safety margins, creating a Snare for operators.
   The Tangled Rope classification correctly captures this duality, preventing
   the system from being misread as either pure coordination (Rope) or
   pure coercion (Snare). The catastrophic failure endpoint is correctly
   indexed as a Mountain for the ultimate victims, representing the point where
   administrative fiction collides with physical reality.
   ========================================================================== */

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: mandatrophy_systemic_collapse
 * human_readable: Mandatrophy (Systemic Resilience Wasting)
 * domain: institutional/technological
 * * SUMMARY:
 * Mandatrophy is the "invisible" extraction of a system's resilience (its "margin")
 * to satisfy a high-priority administrative or political goal (its "mandate").
 * By treating safety buffers, technical expertise, and physical maintenance as
 * "wasteful slack," the institution gains short-term performance while
 * creating a state of "brittle stability" that ensures catastrophic failure
 * when the first unanticipated stressor arrives.
 * * KEY AGENTS:
 * - The Mandator (KPI Architect): Institutional; views all non-active resources as "excess" to be optimized.
 * - The Operator (Engineer/Technician): Powerless; perceives the tightening Snare as operational "slack" disappears.
 * - The End User (Passenger/Citizen): Powerless; experiences the sudden transition from perceived stability to catastrophic failure (Mountain).
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(mandatrophy_systemic_collapse, 0.90). % Mountain suppression <= 0.05, Rope extraction <= 0.15, Snare extraction >= 0.46
domain_priors:suppression_score(mandatrophy_systemic_collapse, 0.75).   % Structural property (raw, unscaled). Only extractiveness is scaled (by power and scope).
domain_priors:theater_ratio(mandatrophy_systemic_collapse, 0.40).       % Piton detection (>= 0.70)

% Constraint metric facts — primary keys used by the classification engine.
% These mirror domain_priors values using the metric key names from config.pl.
narrative_ontology:constraint_metric(mandatrophy_systemic_collapse, extractiveness, 0.90).
narrative_ontology:constraint_metric(mandatrophy_systemic_collapse, suppression_requirement, 0.75).
narrative_ontology:constraint_metric(mandatrophy_systemic_collapse, theater_ratio, 0.40).

% Constraint self-claim (what does the constraint claim to be?)
% Values: natural_law, coordination, constructed, enforcement
narrative_ontology:constraint_claim(mandatrophy_systemic_collapse, enforcement).

% Binary flags
domain_priors:requires_active_enforcement(mandatrophy_systemic_collapse). % Required for Tangled Rope

% Structural property derivation hooks:
%   has_coordination_function/1 is DERIVED from constraint_beneficiary/2
%   has_asymmetric_extraction/1 is DERIVED from constraint_victim/2
% Both are required for Tangled Rope. Coordination is also required for Scaffold.
narrative_ontology:constraint_beneficiary(mandatrophy_systemic_collapse, administrative_centralization).
narrative_ontology:constraint_beneficiary(mandatrophy_systemic_collapse, short_term_fiscal_metrics).
narrative_ontology:constraint_victim(mandatrophy_systemic_collapse, long_term_system_resilience).
narrative_ontology:constraint_victim(mandatrophy_systemic_collapse, operational_safety_margins).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   Power (P) and Scope (S) both affect effective extraction.
   Scope modifiers: local=0.8, regional=0.9, national=1.0,
                    continental=1.1, global=1.2, universal=1.0.
   ========================================================================== */

% PERSPECTIVE 1: THE OPERATOR (SNARE)
% The engineer or technician who feels the system "tightening" as redundancies
% and safety margins are removed. The mandate is a coercive force that chokes
% their ability to maintain safety.
constraint_indexing:constraint_classification(mandatrophy_systemic_collapse, snare,
    context(agent_power(powerless),
            time_horizon(immediate),
            exit_options(trapped),
            spatial_scope(local))).

% PERSPECTIVE 2: THE MANDATOR (ROPE)
% For HQ, the mandate is a Rope. It is the tool they use to "pull" a lazy or
% bloated system toward modern efficiency. They view the "margin" as
% parasitic drag that must be eliminated to succeed.
constraint_indexing:constraint_classification(mandatrophy_systemic_collapse, rope,
    context(agent_power(institutional),
            time_horizon(biographical),
            exit_options(mobile),
            spatial_scope(national))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (TANGLED ROPE)
% The analyst sees both the coordination function (aligning the organization)
% and the asymmetric extraction (destroying resilience). This duality is the
% signature of a Tangled Rope.
constraint_indexing:constraint_classification(mandatrophy_systemic_collapse, tangled_rope,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

% PERSPECTIVE 4: THE END USER AT FAILURE (MOUNTAIN)
% For the victim of the eventual collapse (e.g., a passenger), the event is a
% Mountain. It is a sudden, unyielding physical limit that appears as a "freak
% accident," where negotiation with the system is impossible.
constraint_indexing:constraint_classification(mandatrophy_systemic_collapse, mountain,
    context(agent_power(powerless),
            time_horizon(historical),
            exit_options(trapped),
            spatial_scope(regional))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(mandatrophy_systemic_collapse_tests).

test(perspectival_gap_manager_vs_operator) :-
    % Verify the manager (institutional) sees a Rope while the operator (powerless) sees a Snare.
    constraint_indexing:constraint_classification(mandatrophy_systemic_collapse, rope, context(agent_power(institutional), _, _, _)),
    constraint_indexing:constraint_classification(mandatrophy_systemic_collapse, snare, context(agent_power(powerless), time_horizon(immediate), _, _)).

test(tangled_rope_analytical_view) :-
    % Verify the analytical observer correctly identifies the Tangled Rope structure.
    constraint_indexing:constraint_classification(mandatrophy_systemic_collapse, tangled_rope, context(agent_power(analytical), _, _, _)),
    domain_priors:requires_active_enforcement(mandatrophy_systemic_collapse),
    narrative_ontology:constraint_beneficiary(mandatrophy_systemic_collapse, _),
    narrative_ontology:constraint_victim(mandatrophy_systemic_collapse, _).

test(high_extraction_and_suppression) :-
    % The system must have high base extraction and suppress alternatives (like maintaining safety margins).
    domain_priors:base_extractiveness(mandatrophy_systemic_collapse, E), E > 0.8,
    domain_priors:suppression_score(mandatrophy_systemic_collapse, S), S > 0.7.

:- end_tests(mandatrophy_systemic_collapse_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * The scores reflect a system that is perversely self-optimizing. The base
 * extractiveness of 0.90 is extreme because the asset being extracted is the
 * system's future survival capacity, which is then converted into short-term
 * performance metrics. The high suppression score (0.75) represents the
 * administrative logic that actively reframes resilience and redundancy as
 * "waste" or "inefficiency."
 *
 * The Perspectival Gap is profound:
 * - The `institutional` agent sees a pure Rope, a tool for coordination and efficiency.
 * - The `powerless` operator on the front line feels the Snare tightening, removing their agency.
 * - The `analytical` observer sees the whole picture: a Tangled Rope where a coordination
 *   function is inextricably linked to a destructive, asymmetric extraction.
 * - The `powerless` end-user, at the moment of failure, experiences a Mountain—the
 *   abrupt, non-negotiable consequence of depleted margins.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

% omega_variable(ID, Question, Resolution_Mechanism, Impact, Confidence).
omega_variable(
    omega_mandatrophy_audit_paradox,
    "Do 'Safety Audits' in a mandatrophic system identify the loss of margin (acting as a counter-force) or merely validate the mandate's fulfillment (acting as a Snare component)?",
    "Comparative analysis of internal audit logs vs. post-mortem failure reports from independent investigators (e.g., NTSB).",
    "If audits validate the mandate, they are part of the Snare's enforcement. If they identify margin loss, they represent a potential, but suppressed, Scaffold.",
    confidence_without_resolution(low)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

% Required for external script parsing
narrative_ontology:interval(mandatrophy_systemic_collapse, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Temporal data shows the system's degradation over time. Initially, the
% mandate is a reasonable efficiency drive (moderate extraction, low theater).
% Over time, it intensifies, extracting core resilience and requiring more
% performative safety checks to maintain an illusion of control.

% Theater ratio over time (triggers metric_substitution detection):
narrative_ontology:measurement(mandatrophy_systemic_collapse_tr_t0, mandatrophy_systemic_collapse, theater_ratio, 0, 0.10).
narrative_ontology:measurement(mandatrophy_systemic_collapse_tr_t5, mandatrophy_systemic_collapse, theater_ratio, 5, 0.25).
narrative_ontology:measurement(mandatrophy_systemic_collapse_tr_t10, mandatrophy_systemic_collapse, theater_ratio, 10, 0.40).

% Extraction over time (triggers extraction_accumulation detection):
narrative_ontology:measurement(mandatrophy_systemic_collapse_ex_t0, mandatrophy_systemic_collapse, base_extractiveness, 0, 0.50).
narrative_ontology:measurement(mandatrophy_systemic_collapse_ex_t5, mandatrophy_systemic_collapse, base_extractiveness, 5, 0.75).
narrative_ontology:measurement(mandatrophy_systemic_collapse_ex_t10, mandatrophy_systemic_collapse, base_extractiveness, 10, 0.90).

/* ==========================================================================
   9. BOLTZMANN & NETWORK DATA (v5.0-5.2)
   ========================================================================== */

% Coordination type (enables Boltzmann floor + complexity offset)
% The mandate acts as a resource allocation mechanism, diverting funds and
% attention from maintenance/resilience toward KPI-driven goals.
narrative_ontology:coordination_type(mandatrophy_systemic_collapse, resource_allocation).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */% ============================================================================
% CONSTRAINT STORY: manganese_catalysis_2026
% ============================================================================
% Version: 3.4 (Deferential Realism Core)
% Logic: 3.3 (Indexed Tuple P,T,E,S)
% Generated: 2026-02-05
% ============================================================================

:- module(constraint_manganese_catalysis_2026, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: manganese_catalysis_2026
 * human_readable: Manganese-Formate Fuel Pathway
 * domain: technological/economic
 * * SUMMARY:
 * Researchers have identified manganese as a high-efficiency catalyst for 
 * converting CO2 into formate, a potential hydrogen carrier for fuel cells. 
 * This removes the "Mountain" of precious-metal scarcity (Platinum/Iridium) 
 * and establishes a more accessible "Rope" for the global hydrogen economy.
 * * KEY AGENTS:
 * - Industrial Energy Consumers: Subject (Powerless)
 * - CCU Tech Developers: Beneficiary (Institutional)
 * - Environmental Auditors: Auditor (Analytical)
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Extraction is low (0.18) because the shift to abundant metals reduces 
% the rent-seeking potential of rare-earth monopolies.
domain_priors:base_extractiveness(manganese_catalysis_2026, 0.18). 

% Suppression is low (0.25) as the technology expands degrees of freedom 
% for energy production rather than restricting them.
domain_priors:suppression_score(manganese_catalysis_2026, 0.25).   

% Theater ratio is low (0.08) as the breakthrough provides a 
% functional chemical pathway with high industrial utility.
domain_priors:theater_ratio(manganese_catalysis_2026, 0.08).       

% Constraint metric facts (bridge for classification engine)
narrative_ontology:constraint_metric(manganese_catalysis_2026, extractiveness, 0.18).
narrative_ontology:constraint_metric(manganese_catalysis_2026, suppression_requirement, 0.25).
narrative_ontology:constraint_metric(manganese_catalysis_2026, theater_ratio, 0.08).

% Primary keys for the classification engine
% Beneficial and victim actors (E < 0.46 typically means broader coordination)
narrative_ontology:constraint_beneficiary(manganese_catalysis_2026, clean_energy_infrastructure).
narrative_ontology:constraint_victim(manganese_catalysis_2026, precious_metal_cartels).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   ========================================================================== */

% PERSPECTIVE 1: THE PREVIOUS MARKET (MOUNTAIN)
% From the old perspective of platinum-dependent fuel cells, the 
% cost of hydrogen was an immutable Mountain (Fixed Limit).
constraint_indexing:constraint_classification(manganese_catalysis_2026, mountain, 
    context(agent_power(powerless), 
            time_horizon(historical), 
            exit_options(trapped), 
            spatial_scope(global))).

% PERSPECTIVE 2: THE NEW ECONOMY (ROPE)
% For CCU developers, the manganese catalyst is a Rope: essential 
% infrastructure for coordinating affordable carbon utilization.
constraint_indexing:constraint_classification(manganese_catalysis_2026, rope, 
    context(agent_power(institutional), 
            time_horizon(generational), 
            exit_options(mobile), 
            spatial_scope(global))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (SCAFFOLD)
% Analysts view this as a Scaffold: a transitional coordination 
% mechanism to bridge the gap toward a fully carbon-neutral fuel economy.
constraint_indexing:constraint_classification(manganese_catalysis_2026, scaffold,
    context(agent_power(analytical),
            time_horizon(historical),
            exit_options(analytical),
            spatial_scope(global))) :-
    narrative_ontology:has_sunset_clause(manganese_catalysis_2026).

% Mandatory sunset clause for transitional Scaffold
narrative_ontology:has_sunset_clause(manganese_catalysis_2026).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(manganese_catalysis_2026_tests).

test(low_extraction_signal) :-
    domain_priors:base_extractiveness(manganese_catalysis_2026, E),
    E < 0.20.

test(theater_check) :-
    domain_priors:theater_ratio(manganese_catalysis_2026, TR),
    TR < 0.10.

test(type_variance) :-
    constraint_indexing:constraint_classification(manganese_catalysis_2026, mountain, _),
    constraint_indexing:constraint_classification(manganese_catalysis_2026, rope, _).

:- end_tests(manganese_catalysis_2026_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * The extraction score (0.18) is low because manganese is abundant, 
 * decentralizing the power of the hydrogen economy away from rare 
 * metal holders. The low Theater Ratio (0.08) reflects that this is a 
 * functional chemical discovery with immediate industrial relevance 
 * for lowering CCU costs.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_manganese_scaling,
    'Can manganese catalysis maintain efficiency at industrial giga-scales?',
    'Validation of 24-month continuous flow pilot plant data.',
    'Success secures the Rope; Failure returns the industry to the Mountain of scarcity.',
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

narrative_ontology:interval(manganese_catalysis_2026, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Theater ratio remains low as the catalyst proves its functional worth.
narrative_ontology:measurement(mn_tr_t0, manganese_catalysis_2026, theater_ratio, 0, 0.05).
narrative_ontology:measurement(mn_tr_t5, manganese_catalysis_2026, theater_ratio, 5, 0.06).
narrative_ontology:measurement(mn_tr_t10, manganese_catalysis_2026, theater_ratio, 10, 0.08).

% Extraction drops initially as monopolies are broken, then stabilizes.
narrative_ontology:measurement(mn_ex_t0, manganese_catalysis_2026, base_extractiveness, 0, 0.40).
narrative_ontology:measurement(mn_ex_t5, manganese_catalysis_2026, base_extractiveness, 5, 0.22).
narrative_ontology:measurement(mn_ex_t10, manganese_catalysis_2026, base_extractiveness, 10, 0.18).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: marriage_market_asymmetry_2026
% ============================================================================
% Version: 5.2 (Deferential Realism Core + Boltzmann + Purity + Network)
% Logic: 5.2 (Indexed Tuple P,T,E,S + Coupling + Purity + Network Drift)
% Generated: 2024-05-21
% ============================================================================

:- module(constraint_marriage_market_asymmetry_2026, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    narrative_ontology:constraint_claim/2,
    narrative_ontology:affects_constraint/2,
    narrative_ontology:coordination_type/2,
    narrative_ontology:boltzmann_floor_override/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: marriage_market_asymmetry_2026
 * human_readable: The Asymmetric Information Snare (Women Asking Out)
 * domain: social/psychological/economic
 * * SUMMARY:
 * This constraint analyzes the "Gale-Shapley" paradox in real-world dating.
 * While the algorithm suggests "asker-optimality," biological and social
 * asymmetries (time-cost of rounds, information scarcity upon acceptance)
 * transform "asking" into a high-extraction Snare for women.
 * * KEY AGENTS:
 * - Women in dating market: Subject (Powerless) - Face higher opportunity costs per dating
 * round and gain low information from male acceptance.
 * - Men in dating market: Beneficiary (Institutional) - Benefit from lower rejection
 * thresholds and extended "biochemical clocks" for matching.
 * - Game Theorists: Auditor (Analytical) - Model the marriage market via
 * stable matching algorithms like Gale-Shapley.
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% High extraction (0.65) because "uncertain rounds" extract significant
% reproductive/opportunity time from women more than men.
domain_priors:base_extractiveness(marriage_market_asymmetry_2026, 0.65).

% Suppression (0.75) of information; male acceptance of a female-initiated
% ask provides "very little additional information" on preference.
domain_priors:suppression_score(marriage_market_asymmetry_2026, 0.75).

% Moderate theater (0.50); "dating" often functions as a theatrical
% placeholder for a decision that could take years to resolve.
domain_priors:theater_ratio(marriage_market_asymmetry_2026, 0.50).

% Constraint metric facts — primary keys used by the classification engine.
narrative_ontology:constraint_metric(marriage_market_asymmetry_2026, extractiveness, 0.65).
narrative_ontology:constraint_metric(marriage_market_asymmetry_2026, suppression_requirement, 0.75).
narrative_ontology:constraint_metric(marriage_market_asymmetry_2026, theater_ratio, 0.50).

% Constraint self-claim: The norms are presented as social constructs, not natural law.
narrative_ontology:constraint_claim(marriage_market_asymmetry_2026, constructed).

% Binary flags & Structural properties for Tangled Rope
domain_priors:requires_active_enforcement(marriage_market_asymmetry_2026).
narrative_ontology:constraint_beneficiary(marriage_market_asymmetry_2026, men_in_dating_market).
narrative_ontology:constraint_victim(marriage_market_asymmetry_2026, women_in_dating_market).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   ========================================================================== */

% PERSPECTIVE 1: THE SUBJECT (SNARE)
% For women, initiating is often a snare: the "information measure of
% surprise" is low, trapping them in ambiguous, non-committal dates.
constraint_indexing:constraint_classification(marriage_market_asymmetry_2026, snare,
    context(agent_power(powerless),
            time_horizon(biographical),
            exit_options(trapped),
            spatial_scope(national))).

% PERSPECTIVE 2: THE BENEFICIARY (ROPE)
% For men, the "asker-optimal" model is a rope: it coordinates sexual/romantic
% access with lower personal rejection risk if women lead the ask.
constraint_indexing:constraint_classification(marriage_market_asymmetry_2026, rope,
    context(agent_power(institutional),
            time_horizon(generational),
            exit_options(mobile),
            spatial_scope(national))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (TANGLED ROPE)
% Detects a hybrid: Gale-Shapley provides a coordination framework (Rope)
% that ignores the extraction of "time-value" (Snare).
constraint_indexing:constraint_classification(marriage_market_asymmetry_2026, tangled_rope,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(marriage_market_asymmetry_2026_tests).

test(perspectival_gap) :-
    % Verify there is a perspectival gap between powerless and institutional.
    constraint_indexing:constraint_classification(marriage_market_asymmetry_2026, TypePowerless, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(marriage_market_asymmetry_2026, TypeInstitutional, context(agent_power(institutional), _, _, _)),
    TypePowerless \= TypeInstitutional.

test(threshold_validation) :-
    config:param(extractiveness_metric_name, ExtMetricName),
    narrative_ontology:constraint_metric(marriage_market_asymmetry_2026, ExtMetricName, E),
    E >= 0.46. % Correctly identifies the "time-value" extraction as meeting the Snare/Tangled Rope threshold.

:- end_tests(marriage_market_asymmetry_2026_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * The extraction score (0.65) reflects the "opportunity cost" of uncertain
 * dating rounds, which is higher for women due to compressed biological
 * timelines. The Perspectival Gap exists because Gale-Shapley ignores the asymmetry
 * of information; a man's "Yes" to a female ask contains less signal than
 * a woman's "Yes" to a male ask. Enforcement is maintained by social norms
 * and biological pressures.
 *
 * MANDATROPHY ANALYSIS:
 * The Tangled Rope classification is critical here. A simpler model might classify this as a pure Snare,
 * ignoring the genuine coordination function of dating markets (stable matching). Tangled Rope prevents
 * this mandatrophy by acknowledging both the coordination aspect (the "Rope") and the severe,
 * asymmetric extraction of time and opportunity cost from one group (the "Snare" element),
 * providing a more complete structural diagnosis.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_marriage_market_asymmetry_2026,
    'Does a religious social group (SCAFFOLD) nullify the information asymmetry?',
    'Comparative study of female-initiation success in chaste vs. secular cohorts.',
    'If chastity works, the Snare is a policy/norm; if not, it is a Mountain of biology.',
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

narrative_ontology:interval(marriage_market_asymmetry_2026, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Model the drift from "Youth/Time Surplus" (T=0) to "Biological Ceiling" (T=10).

% Theater ratio: Increases as dating rounds lengthen without a "marriage"
% decision, turning coordination into performative "milk for free".
narrative_ontology:measurement(marriage_market_asymmetry_2026_tr_t0, marriage_market_asymmetry_2026, theater_ratio, 0, 0.20).
narrative_ontology:measurement(marriage_market_asymmetry_2026_tr_t5, marriage_market_asymmetry_2026, theater_ratio, 5, 0.35).
narrative_ontology:measurement(marriage_market_asymmetry_2026_tr_t10, marriage_market_asymmetry_2026, theater_ratio, 10, 0.50).

% Extraction: The cost of a "round" increases exponentially for women as
% the time-horizon approaches biological limits.
narrative_ontology:measurement(marriage_market_asymmetry_2026_ex_t0, marriage_market_asymmetry_2026, base_extractiveness, 0, 0.30).
narrative_ontology:measurement(marriage_market_asymmetry_2026_ex_t5, marriage_market_asymmetry_2026, base_extractiveness, 5, 0.48).
narrative_ontology:measurement(marriage_market_asymmetry_2026_ex_t10, marriage_market_asymmetry_2026, base_extractiveness, 10, 0.65).

/* ==========================================================================
   9. BOLTZMANN & NETWORK DATA (v5.0-5.2)
   ========================================================================== */

% The dating market functions as a mechanism for allocating partners.
narrative_ontology:coordination_type(marriage_market_asymmetry_2026, resource_allocation).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */% ============================================================================
% CONSTRAINT STORY: optimal_stopping_marriage
% ============================================================================
% Generated: 2026-01-17
% Model: Gemini 2.0 Flash
% Source: The Secretary Problem / Optimal Stopping Theory
% ============================================================================

:- module(constraint_optimal_stopping_marriage, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:constraint_metric/3,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: optimal_stopping_marriage
 * human_readable: The 37% Rule (Optimal Stopping)
 * domain: technological/mathematical
 * temporal_scope: Immediate to Biographical
 * spatial_scope: Global (Abstract Math)
 * * SUMMARY:
 * In the "Marriage Problem" (or Secretary Problem), a person must choose the best 
 * candidate from a sequence of $N$ options. Once a candidate is rejected, they cannot 
 * be recalled. To maximize the probability of picking the absolute best, math 
 * dictates rejecting the first $n/e$ (approx. 37%) of candidates and then picking 
 * the first one better than all seen so far.
 * * KEY AGENTS:
 * - The Searcher: Individual seeking the optimal partner under time/info constraints.
 * - The Candidates: Sequential options who are either accepted or permanently lost.
 * - The Mathematician: Analytical observer who views the constraint as an immutable law.
 * * NARRATIVE ARC:
 * The constraint functions as a "wall of regret." If the Searcher stops too early, 
 * they miss the global maximum. If they stop too late, the best candidate has 
 * already passed. The math creates a rigid boundary for optimal behavior.
 */

/* ==========================================================================
   2. BASE PROPERTIES (Reality Layer)
   ========================================================================== */

% Required for system integration
narrative_ontology:interval(optimal_stopping_marriage, 0, 10).
narrative_ontology:constraint_claim(optimal_stopping_marriage, mountain).

% Base extractiveness: Low (0.1). 
% Nature/Math doesn't "profit" from the Searcher, but the "loss" of rejected 
% candidates represents a form of structural waste.
domain_priors:base_extractiveness(optimal_stopping_marriage, 0.1).

% Suppression: Moderate (0.4). 
% Humans often ignore the math in favor of "gut feeling," but the math 
% "punishes" this with lower success probabilities.
domain_priors:suppression_score(optimal_stopping_marriage, 0.4).

% Constraint metric facts (bridge for classification engine)
narrative_ontology:constraint_metric(optimal_stopping_marriage, extractiveness, 0.1).
narrative_ontology:constraint_metric(optimal_stopping_marriage, suppression_requirement, 0.4).

% Enforcement: Emerges naturally from the logic of probability.
domain_priors:emerges_naturally(optimal_stopping_marriage).

% Beneficiaries: The "Winner" (the candidate selected by the optimal strategy).
constraint_beneficiary(optimal_stopping_marriage, selected_optimal_candidate).

% Victims: The "37% Group" (qualified candidates rejected solely to set the baseline).
constraint_victim(optimal_stopping_marriage, rejected_baseline_candidates).

% Metrics
/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (Perspectival Truth)
   ========================================================================== */

/* --------------------------------------------------------------------------
   PERSPECTIVE 1: THE SEARCHER - Snare
   --------------------------------------------------------------------------
   WHO: powerless (subject to the sequence of options)
   WHEN: biographical (the search defines a major life phase)
   WHERE: trapped (cannot go back in time to "un-reject" a candidate)
   SCOPE: local (their specific dating pool)
   
   WHY THIS CLASSIFICATION:
   The searcher feels "strangled" by the inability to recall past options. 
   The 37% rule feels like a Snare because it forces the rejection of 
   potentially great partners simply to satisfy a statistical baseline.
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    optimal_stopping_marriage,
    snare,
    context(
        agent_power(powerless),
        time_horizon(biographical),
        exit_options(trapped),
        spatial_scope(local)
    )
) :-
    domain_priors:base_extractiveness(optimal_stopping_marriage, E),
    E < 0.2, % It's not about extraction, but the 'trapped' nature makes it a Snare.
    !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 2: THE MATHEMATICIAN - Mountain
   --------------------------------------------------------------------------
   WHO: analytical
   WHEN: historical/civilizational
   WHERE: analytical
   SCOPE: global
   
   WHY THIS CLASSIFICATION:
   To the mathematician, the $1/e$ limit is a "Mountain"—a fixed feature 
   of the universe like gravity. It is unchangeable regardless of human 
   desire or agency.
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    optimal_stopping_marriage,
    mountain,
    context(
        agent_power(analytical),
        time_horizon(historical),
        exit_options(analytical),
        spatial_scope(global)
    )
) :-
    domain_priors:emerges_naturally(optimal_stopping_marriage),
    !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 3: THE MATCHMAKER - Rope
   --------------------------------------------------------------------------
   WHO: institutional/powerful
   WHEN: generational
   WHERE: mobile
   SCOPE: regional
   
   WHY THIS CLASSIFICATION:
   For an institution (like a dating app or a village matchmaker), this 
   mathematical reality is a "Rope." It's a coordination tool that 
   helps structure the flow of candidates to ensure the highest 
   aggregate "win" rate across a population.
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    optimal_stopping_marriage,
    rope,
    context(
        agent_power(institutional),
        time_horizon(generational),
        exit_options(mobile),
        spatial_scope(regional)
    )
) :-
    true.

/* ==========================================================================
   4. TESTS
   ========================================================================== */

:- begin_tests(optimal_stopping_marriage_tests).

test(multi_perspective_variance) :-
    constraint_indexing:constraint_classification(optimal_stopping_marriage, Type1, context(agent_power(powerless), _, trapped, _)),
    constraint_indexing:constraint_classification(optimal_stopping_marriage, Type2, context(agent_power(analytical), _, _, _)),
    Type1 \= Type2.

test(time_immutability_shift) :-
    % Short term (biographical) feels like a Snare due to regret.
    % Long term (civilizational) is a Mountain of probability.
    constraint_indexing:constraint_classification(optimal_stopping_marriage, snare, context(_, time_horizon(biographical), trapped, _)),
    constraint_indexing:constraint_classification(optimal_stopping_marriage, mountain, context(_, time_horizon(civilizational), _, _)).

test(extraction_paradox) :-
    % The "powerless" actually experience more "loss" (perceived extractiveness) 
    % than the institutional observer.
    domain_priors:base_extractiveness(optimal_stopping_marriage, Score),
    Score < 0.5.

:- end_tests(optimal_stopping_marriage_tests).

/* ==========================================================================
   5. MODEL INTERPRETATION (Commentary)
   ========================================================================== */

/**
 * LLM GENERATION NOTES
 * Model: Gemini 2.0 Flash
 * * KEY DECISIONS:
 * 1. EXTRACTIVENESS: Set to 0.1. The "Marriage Problem" isn't a scam; it's a 
 * logical trap. The only "extraction" is the opportunity cost paid by 
 * the baseline group.
 * 2. PERSPECTIVES: I chose the Searcher (Snare) because the "no-recall" rule 
 * is a classic constraint that feels punitive to the individual.
 * 3. AMBIGUITIES: The biggest uncertainty is the "no-recall" assumption. 
 * In the real world, you can sometimes go back to an ex.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω)
   ========================================================================== */

omega_variable(
    recall_viability,
    "Can a previously rejected candidate be 're-activated'?",
    resolution_mechanism("Empirical study of 'boomerang' relationships in modern dating datasets"),
    impact("If Recall=High: Mountain becomes Rope (strategy changes). If Recall=Zero: Snare/Mountain holds."),
    confidence_without_resolution(medium)
).

omega_variable(
    candidate_distribution_knowledge,
    "Does the searcher know the total number of candidates $N$?",
    resolution_mechanism("Information theory analysis of search under unknown population size"),
    impact("If $N$ is unknown: The 37% rule cannot be applied; a different 'Mountain' appears."),
    confidence_without_resolution(high)
).

/* ==========================================================================
   7. ALTERNATIVE ANALYSIS
   ========================================================================== */

/**
 * VIABLE ALTERNATIVES
 * * ALTERNATIVE 1: Post-Selection Recall
 * Viability: High in modern social networks.
 * Suppression: The math problem suppresses this to maintain the "clean" 1/e proof.
 * * CONCLUSION:
 * The "No-Recall" rule is what turns a coordination tool (Rope) into a 
 * psychological Snare for the individual searcher.
 */

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */


% --- v3.1 Indexical Relativity Stubs (Fleet Repair) ---
constraint_indexing:constraint_classification(marriage_problem, mountain, agent_power(analytical)).
constraint_indexing:constraint_classification(marriage_problem, rope, agent_power(institutional)).
constraint_indexing:constraint_classification(marriage_problem, snare, agent_power(powerless)).
% ============================================================================
% CONSTRAINT STORY: mars_rover_navigational_autonomy
% ============================================================================
% Generated: 2026-01-19
% Model: Gemini 2.0 Flash
% Source: Autonomy for Mars Rovers: Past, Present, and Future (Bajracharya et al., 2008)
% ============================================================================

:- module(constraint_mars_autonomy, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:constraint_metric/3,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: mars_rover_navigational_autonomy
 * human_readable: Mars Surface Navigational Autonomy (AutoNav)
 * domain: technological
 * temporal_scope: 1997-2004 (Sojourner to Spirit/Opportunity)
 * spatial_scope: Martian Surface / JPL Control
 * * SUMMARY:
 * Navigational autonomy on Mars is constrained by the "speed-of-light" latency 
 * (Mountain) and the high risk of irrecoverable hardware loss (Snare). To 
 * overcome these, NASA implemented GESTALT and AutoNav—functional coordination 
 * mechanisms (Ropes) that allow rovers to sense hazards and plan paths 
 * without constant human intervention.
 * * KEY AGENTS:
 * - The Rover (Sojourner/Spirit): Individual powerless; subject to the 
 * physical terrain and the "safety logic" of its own code.
 * - Rover Planners (JPL): Institutional; define the "cost maps" and 
 * safety thresholds that govern what the rover perceives as an obstacle.
 * - Robotics Researcher: Analytical; evaluates the efficiency of 
 * autonomous navigation vs. human-commanded "blind driving."
 * * NARRATIVE ARC:
 * Autonomy evolved from a simple 2D hazard avoidance (Sojourner) to complex 
 * 3D stereo-vision path planning (Spirit). While intended as a Rope to 
 * increase mission velocity, the software's conservative safety limits 
 * can function as a Snare, "extracting" mission time by causing the rover 
 * to stop or retreat from navigable but "scary" terrain.
 */

/* ==========================================================================
   2. CORE SYSTEM INTEGRATION (The "Reality" Layer)
   ========================================================================== */

% Structural Anchor for index extraction
narrative_ontology:interval(mars_autonomy_evolution, 0, 10).
narrative_ontology:constraint_claim(mars_rover_navigational_autonomy, rope).

% Base extractiveness score (0.0-1.0)
% Rationale: 0.4. Moderate; autonomous cycles "extract" significant 
% onboard CPU time and battery power (computational cost), potentially 
% reducing time available for science instruments.
domain_priors:base_extractiveness(mars_rover_navigational_autonomy, 0.4).

% Suppression score (0.0-1.0)
% Rationale: 0.5. The system suppresses high-risk maneuvers. If the 
% "safety margin" is too high, it suppresses the visibility of valid 
% navigation paths.
domain_priors:suppression_score(mars_rover_navigational_autonomy, 0.5).

% Constraint metric facts (bridge for classification engine)
narrative_ontology:constraint_metric(mars_rover_navigational_autonomy, extractiveness, 0.4).
narrative_ontology:constraint_metric(mars_rover_navigational_autonomy, suppression_requirement, 0.5).

% Enforcement requirements
% Requires active enforcement (Onboard hazard avoidance software 
% triggers a stop if safety constraints are violated).
domain_priors:requires_active_enforcement(mars_rover_navigational_autonomy).

% Metrics required for Section 1 of the Executive Summary
% BENEFICIARIES & VICTIMS
constraint_beneficiary(mars_rover_navigational_autonomy, mission_longevity).
constraint_beneficiary(mars_rover_navigational_autonomy, navigational_safety).
constraint_victim(mars_rover_navigational_autonomy, traverse_speed).
constraint_victim(mars_rover_navigational_autonomy, cpu_availability_for_science).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (Perspectival Truth)
   ========================================================================== */

/* --------------------------------------------------------------------------
   PERSPECTIVE 1: THE ROVER (SPIRIT) - Mountain
   --------------------------------------------------------------------------
   
   WHO: powerless - Cannot alter its own code; must obey the 
         hazard avoidance logic.
   WHEN: immediate - Tactical millisecond-by-millisecond wheel control.
   WHERE: trapped - Bound by the physical geometry of Martian rocks and slopes.
   SCOPE: local - Immediate sensor range (1-5 meters).
   
   WHY THIS CLASSIFICATION:
   For the rover, the software's safety parameters (e.g., "stop if tilt > 20°") 
   are as unchangeable as the Martian gravity. It has zero degrees of 
   freedom to ignore its own "Fear" of a hazard.
   -------------------------------------------------------------------------- */



constraint_indexing:constraint_classification(
    mars_rover_navigational_autonomy,
    mountain,
    context(
        agent_power(powerless),
        time_horizon(immediate),
        exit_options(trapped),
        spatial_scope(local)
    )
) :-
    domain_priors:requires_active_enforcement(mars_rover_navigational_autonomy),
    !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 2: ROVER PLANNERS (JPL) - Rope
   --------------------------------------------------------------------------
   
   WHO: institutional - Power to adjust "cost" weights and path heuristics.
   WHEN: biographical - Planning the 90-day (and beyond) mission arc.
   WHERE: mobile - Can send "overrides" or change the software's caution level.
   SCOPE: regional - Planning traverse routes across kilometers of Gusev Crater.
   
   WHY THIS CLASSIFICATION:
   Planners view autonomy as a Rope—a functional coordination tool. If the 
   rover is too conservative, they can "loosen" the rope by adjusting 
   thresholds to allow more daring drives, or "tighten" it in dangerous areas.
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    mars_rover_navigational_autonomy,
    rope,
    context(
        agent_power(institutional),
        time_horizon(biographical),
        exit_options(mobile),
        spatial_scope(regional)
    )
) :-
    domain_priors:base_extractiveness(mars_rover_navigational_autonomy, E),
    E < 0.6,
    !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 3: MISSION EFFICIENCY ANALYST - Snare
   --------------------------------------------------------------------------
   
   WHO: analytical - Observer of the ratio between "thinking" and "driving."
   WHEN: historical - Comparing Pathfinder's 100m traverse to Spirit's kilometers.
   WHERE: analytical - Free from the operational "fear" of losing the rover.
   SCOPE: global - Impact on the future of planetary exploration.
   
   WHY THIS CLASSIFICATION:
   The analyst sees the Snare. Onboards like Spirit spent hours "thinking" 
   (computing stereo vision) for every minute of driving. This extraction 
   of time/power chokes the potential science yield, particularly when the 
   rover gets "stuck" in a computational loop due to ambiguous terrain.
   -------------------------------------------------------------------------- */



constraint_indexing:constraint_classification(
    mars_rover_navigational_autonomy,
    snare,
    context(
        agent_power(analytical),
        time_horizon(historical),
        exit_options(analytical),
        spatial_scope(global)
    )
) :-
    domain_priors:suppression_score(mars_rover_navigational_autonomy, S),
    S > 0.4,
    !.

/* ==========================================================================
   4. TESTS (What We Learn About Constraints)
   ========================================================================== */

:- begin_tests(mars_autonomy_tests).

test(autonomy_utility_variance) :-
    % Institutional planners see a tool (Rope), local rover sees a limit (Mountain)
    constraint_indexing:constraint_classification(mars_rover_navigational_autonomy, T1, context(institutional, biographical, mobile, regional)),
    constraint_indexing:constraint_classification(mars_rover_navigational_autonomy, T2, context(powerless, immediate, trapped, local)),
    T1 \= T2.

test(computational_extraction) :-
    % Extraction of battery/time is significant for Mars missions
    domain_priors:base_extractiveness(mars_rover_navigational_autonomy, E),
    E > 0.3.

:- end_tests(mars_autonomy_tests).

/* ==========================================================================
   5. MODEL INTERPRETATION (Commentary)
   ========================================================================== */

/**
 * LLM GENERATION NOTES
 * * Model: Gemini 2.0 Flash
 * * KEY DECISIONS:
 * 1. EXTRACTIVENESS (0.4): I chose this to reflect the "Tax" on mission 
 * time. As noted in the Bajracharya paper, autonomous navigation is 
 * significantly slower than blind driving because the rover must stop, 
 * image, and think.
 * 2. CLASSIFICATION: I primary-labeled this as a 'Rope' because it 
 * coordinated the transition from 100-meter missions (Sojourner) to 
 * 10-kilometer missions (Spirit/Opportunity).
 * 3. PERSPECTIVE: The "Analytical" view of the Snare reflects the 
 * 'Replication Crisis' in autonomy: the more safe we make it, the less 
 * productive it becomes.
 */

omega_variable(
    autonomy_trust_threshold,
    "At what point does human 'Trust' in the algorithm allow the Rope 
     to slacken enough to become a speed-enhancing tool vs. a speed-choking limit?",
    resolution_mechanism("Comparative analysis of traverse speed in 'AutoNav' vs. 'Directed' modes on MER"),
    impact("If Directed is consistently faster: AutoNav is a Snare. 
            If AutoNav allows more meters per sol: It is a Rope."),
    confidence_without_resolution(medium)
).

/* ==========================================================================
   6. ALTERNATIVE ANALYSIS
   ========================================================================== */

/**
 * VIABLE ALTERNATIVES
 * * ALTERNATIVE 1: Blind Driving (Direct Sequencing)
 * Viability: Used extensively for "safe" flat terrain. High speed, low 
 * onboard computation.
 * Suppression: Suppressed in "unknown" or "hazardous" terrain because 
 * the 20-minute latency (Mountain) makes it an operational Snare.
 * * ALTERNATIVE 2: Continuous Drive (Spirit/Opportunity upgrade)
 * Viability: Later mission upgrades allowed for imaging during wheel motion.
 * * CONCLUSION:
 * The existence of "Blind Driving" as a faster but riskier alternative 
 * highlights that Autonomy is a chosen Rope—we trade time (Extraction) 
 * for the avoidance of a permanent mission-ending Mountain (a crash).
 */

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

% 1. Load: ?- [mars_rover_navigational_autonomy].
% 2. Analyze: ?- multi_index_report(mars_rover_navigational_autonomy).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */


% --- v3.1 Indexical Relativity Stubs (Fleet Repair) ---
constraint_indexing:constraint_classification(mars_rovers_navigational_autonomy, mountain, agent_power(analytical)).
constraint_indexing:constraint_classification(mars_rovers_navigational_autonomy, rope, agent_power(institutional)).
constraint_indexing:constraint_classification(mars_rovers_navigational_autonomy, snare, agent_power(powerless)).
% ============================================================================
% CONSTRAINT STORY: martian_signal_latency
% ============================================================================
% Generated: 2026-01-19
% Model: Gemini 2.0 Flash
% Source: NASA JPL / Planetary Science Mission Operations
% ============================================================================

:- module(constraint_martian_latency, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:constraint_metric/3,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: martian_signal_latency
 * human_readable: Martian Signal Latency (One-Way Light Time)
 * domain: technological/scientific
 * temporal_scope: 1965-Present
 * spatial_scope: Interplanetary (Earth-Mars)
 * * SUMMARY:
 * Martian signal latency is the absolute delay in communication between Earth 
 * and Mars caused by the speed of light. Ranging from 3 to 22 minutes depending 
 * on orbital positions, this constraint dictates the architecture of all 
 * deep-space missions, rendering real-time teleoperation of assets impossible.
 * * KEY AGENTS:
 * - Rover Driver (JPL): Individual powerless; must wait for "next sol" to 
 * see the results of a command.
 * - Mission Architect: Institutional; designs the "Rope" of autonomy to 
 * bypass the "Snare" of latency.
 * - Radio Physicist: Analytical; measures the constraint as a fundamental 
 * property of the universe.
 * * NARRATIVE ARC:
 * Latency is the ultimate Mountain—a natural law that cannot be negotiated. 
 * In the early days of exploration, it was a Snare that threatened to destroy 
 * any lander that couldn't think for itself. To survive, NASA wove the 
 * Rope of autonomy, transforming a terminal physical limit into a 
 * predictable coordination rhythm for mission operations.
 */

/* ==========================================================================
   2. CORE SYSTEM INTEGRATION (The "Reality" Layer)
   ========================================================================== */

% Required for [STEP 1] and [STEP 2] of the DR-Audit Suite
narrative_ontology:interval(mariner_to_msl_era, 0, 10).
narrative_ontology:constraint_claim(martian_signal_latency, mountain).

% Base extractiveness score (0.0-1.0)
% Rationale: 0.1. Low; the speed of light does not "extract" value in a 
% coercive sense, but it imposes a high "opportunity cost" on mission 
% duration and real-time scientific discovery.
domain_priors:base_extractiveness(martian_signal_latency, 0.1).

% Suppression score (0.0-1.0)
% Rationale: 1.0. Absolute; signal latency suppresses the very possibility 
% of real-time remote control. There are no known physical alternatives 
% to electromagnetic wave propagation.
domain_priors:suppression_score(martian_signal_latency, 1.0).

% Constraint metric facts (bridge for classification engine)
narrative_ontology:constraint_metric(martian_signal_latency, extractiveness, 0.1).
narrative_ontology:constraint_metric(martian_signal_latency, suppression_requirement, 1.0).

% Enforcement requirements
% Emerges naturally from the physics of the universe.
domain_priors:emerges_naturally(martian_signal_latency).

% Metrics required for Section 1 of the Executive Summary
% BENEFICIARIES & VICTIMS
constraint_beneficiary(martian_signal_latency, autonomy_software_development).
constraint_victim(martian_signal_latency, real_time_human_intuition).
constraint_victim(martian_signal_latency, mission_cadence).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (Perspectival Truth)
   ========================================================================== */

/* --------------------------------------------------------------------------
   PERSPECTIVE 1: ROVER DRIVER - Mountain
   --------------------------------------------------------------------------
   
   WHO: powerless - Bound by the laws of physics; cannot "drive" 
         fast enough to outrun the delay.
   WHEN: immediate - Tactical focus on the current wheel-turn or hazard.
   WHERE: trapped - Bound by the Earth-Mars distance.
   SCOPE: local - Focused on the immediate traverse of the rover.
   
   WHY THIS CLASSIFICATION:
   For the driver, the delay is a Mountain. It is an unchangeable, 
   non-negotiable fact of their workday. They cannot "negotiate" with 
   the speed of light to get a faster image back from the surface.
   -------------------------------------------------------------------------- */



constraint_indexing:constraint_classification(
    martian_signal_latency,
    mountain,
    context(
        agent_power(powerless),
        time_horizon(immediate),
        exit_options(trapped),
        spatial_scope(local)
    )
) :-
    domain_priors:emerges_naturally(martian_signal_latency),
    !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 2: MISSION MANAGER - Rope
   --------------------------------------------------------------------------
   
   WHO: institutional - Power to design the mission architecture and 
         software capabilities.
   WHEN: biographical - Planning the multi-year mission arc.
   WHERE: mobile - Can choose to invest in more autonomy or slower 
         "directed" sequences.
   SCOPE: national - Managing the US planetary exploration budget.
   
   WHY THIS CLASSIFICATION:
   Management views the latency as a Rope. It is the core coordination 
   mechanism that dictates how they structure their teams (e.g., Sol-path 
   planning cycles). They "weave" the mission's software around the delay, 
   using it as a structural anchor for the entire project.
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    martian_signal_latency,
    rope,
    context(
        agent_power(institutional),
        time_horizon(biographical),
        exit_options(mobile),
        spatial_scope(national)
    )
) :-
    domain_priors:base_extractiveness(martian_signal_latency, E),
    E < 0.5,
    !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 3: MARS COLONIST (FUTURE) - Snare
   --------------------------------------------------------------------------
   
   WHO: individual_moderate - Has agency on Mars but is socially/technologically 
         bound to Earth for resources/data.
   WHEN: biographical - Lifetime spent on another planet.
   WHERE: constrained - High cost of communication; cannot "call home" for help.
   SCOPE: global - Impact on interplanetary civilization.
   
   WHY THIS CLASSIFICATION:
   For a future colonist, the 20-minute lag is a Snare. It extracts 
   human connection and chokes off the ability to receive emergency 
   instructions from Earth in real-time. It separates the two worlds 
   into distinct, often asynchronous realities.
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    martian_signal_latency,
    snare,
    context(
        agent_power(individual_moderate),
        time_horizon(biographical),
        exit_options(constrained),
        spatial_scope(global)
    )
) :-
    domain_priors:suppression_score(martian_signal_latency, S),
    S > 0.8,
    !.

/* ==========================================================================
   4. TESTS (What We Learn About Constraints)
   ========================================================================== */

:- begin_tests(martian_latency_tests).

test(multi_perspective_variance) :-
    % Driver (Mountain) vs Manager (Rope) vs Colonist (Snare)
    constraint_indexing:constraint_classification(martian_signal_latency, T1, context(powerless, immediate, trapped, local)),
    constraint_indexing:constraint_classification(martian_signal_latency, T2, context(institutional, biographical, mobile, national)),
    constraint_indexing:constraint_classification(martian_signal_latency, T3, context(individual_moderate, biographical, constrained, global)),
    T1 \= T2, T2 \= T3.

test(absolute_suppression) :-
    % Latency should always show maximum suppression of real-time control
    domain_priors:suppression_score(martian_signal_latency, S),
    S =:= 1.0.

:- end_tests(martian_latency_tests).

/* ==========================================================================
   5. MODEL INTERPRETATION (Commentary)
   ========================================================================== */

/**
 * LLM GENERATION NOTES
 * * Model: Gemini 2.0 Flash
 * * KEY DECISIONS:
 * 1. SUPPRESSION SCORE (1.0): This is the defining characteristic of 
 * the speed of light. It is the only constraint in this system where 
 * suppression is legally and physically absolute.
 * 2. CLASSIFICATION: I primary-labeled this as a 'Mountain'. While 
 * mission managers treat it as a 'Rope' for planning, they are 
 * effectively coordinating within a prison of physics.
 * 3. EXTRACTIVENESS: I set this low (0.1) because the universe is not 
 * "extractive" in a moral sense, though the *result* of the constraint 
 * is the extraction of time.
 */

omega_variable(
    quantum_entanglement_comms,
    "Will quantum entanglement eventually provide a non-extractive Rope 
     that bypasses the light-speed Mountain?",
    resolution_mechanism("Monitor theoretical physics for proof of FTL information transfer"),
    impact("If Yes: Signal latency was a temporary Snare. If No: It is an 
            eternal Mountain of the physical world."),
    confidence_without_resolution(low)
).

/* ==========================================================================
   6. ALTERNATIVE ANALYSIS
   ========================================================================== */

/**
 * VIABLE ALTERNATIVES
 * * ALTERNATIVE 1: On-Site Human Presence
 * Viability: Sending humans to Mars eliminates the latency constraint 
 * for local operations, though it creates a new "Mountain" of life 
 * support.
 * Suppression: Suppressed by current launch technology, budget, and 
 * radiation risk thresholds.
 * * ALTERNATIVE 2: Advanced AI Autonomy
 * Viability: Moving the "Decision Brain" to the rover (e.g., AutoNav) 
 * allows the mission to ignore the latency Mountain for local safety.
 * * CONCLUSION:
 * The existence of Autonomy as a viable alternative shifts the 
 * experience of the latency from a terminal Snare (mission death) 
 * to a manageable Rope (planned delay).
 */

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

% 1. Load: ?- [martian_signal_latency].
% 2. Analyze: ?- multi_index_report(martian_signal_latency).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: mass_market_extinction_2026
% ============================================================================
% Version: 5.2 (Deferential Realism Core + Boltzmann + Purity + Network)
% Logic: 5.2 (Indexed Tuple P,T,E,S + Coupling + Purity + Network Drift)
% Generated: 2024-07-15
% ============================================================================

:- module(constraint_mass_market_extinction_2026, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    narrative_ontology:constraint_claim/2,
    narrative_ontology:affects_constraint/2,
    narrative_ontology:coordination_type/2,
    narrative_ontology:boltzmann_floor_override/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: mass_market_extinction_2026
 * human_readable: The Mass Market Paperback Sunset
 * domain: economic/cultural
 * * SUMMARY:
 * This constraint tracks the final collapse of the mass-market paperback format
 * following ReaderLink's decision to cease distribution at the end of 2025.
 * Once the "most popular reading format" that democratized American literacy
 * through low price points ($9.99 cap) and non-bookstore accessibility, the
 * format has plummeted from 131 million units in 2004 to 15 million in 2025.
 * * KEY AGENTS:
 * - Low-Income Readers: Subject (Powerless) - Losing the most accessible
 * entry point to print literacy.
 * - ReaderLink/Publishers: Beneficiary (Institutional) - Managing the exit
 * from a low-margin, consolidating distribution market.
 * - Industry Veterans: Auditor (Analytical) - Documenting the shift from
 * "democratization" to "extinction".
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% High extraction (0.70) due to rising production costs clashing with a rigid
% $9.99 consumer price cap, making the format economically unsustainable.
domain_priors:base_extractiveness(mass_market_extinction_2026, 0.70).

% High suppression (0.82); the removal of the format suppresses the choice of
% low-cost physical alternatives in non-bookstore outlets.
domain_priors:suppression_score(mass_market_extinction_2026, 0.82).

% Moderate theater (0.45); the $9.99 price point served as a theatrical anchor
% that publishers were "reluctant" to break, leading to format death instead of repricing.
domain_priors:theater_ratio(mass_market_extinction_2026, 0.45).

% Constraint metric facts — primary keys used by the classification engine.
narrative_ontology:constraint_metric(mass_market_extinction_2026, extractiveness, 0.70).
narrative_ontology:constraint_metric(mass_market_extinction_2026, suppression_requirement, 0.82).
narrative_ontology:constraint_metric(mass_market_extinction_2026, theater_ratio, 0.45).

% The system's collapse is presented as a constructed market outcome ("the consumer has spoken").
narrative_ontology:constraint_claim(mass_market_extinction_2026, constructed).

% The rigid distribution and pricing contracts required active enforcement to maintain.
domain_priors:requires_active_enforcement(mass_market_extinction_2026).

% Structural property derivation hooks for Tangled Rope classification.
narrative_ontology:constraint_beneficiary(mass_market_extinction_2026, publishers_and_distributors).
narrative_ontology:constraint_victim(mass_market_extinction_2026, low_income_readers).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   ========================================================================== */

% PERSPECTIVE 1: THE SUBJECT (SNARE)
% For the budget-conscious reader, the extinction is a snare: they are "trapped"
% into choosing more expensive trade paperbacks, digital formats, or forgoing books.
constraint_indexing:constraint_classification(mass_market_extinction_2026, snare,
    context(agent_power(powerless),
            time_horizon(biographical),
            exit_options(trapped),
            spatial_scope(national))).

% PERSPECTIVE 2: THE BENEFICIARY (ROPE)
% For ReaderLink/Publishers, the exit is a rope: coordinating the final withdrawal
% to maintain logistical efficiency and exit an unprofitable market segment.
constraint_indexing:constraint_classification(mass_market_extinction_2026, rope,
    context(agent_power(institutional),
            time_horizon(generational),
            exit_options(mobile),
            spatial_scope(national))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (TANGLED ROPE)
% An analyst sees a Tangled Rope: a system that once had a genuine coordination
% function (democratizing literacy) but became highly extractive and required
% active enforcement of its pricing/distribution model, ultimately harming one group
% while benefiting another's exit strategy.
constraint_indexing:constraint_classification(mass_market_extinction_2026, tangled_rope,
    context(agent_power(analytical),
            time_horizon(historical),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(mass_market_extinction_2026_tests).

test(perspectival_gap) :-
    % Subject feels the loss of access (Snare), Institution coordinates the exit (Rope).
    constraint_indexing:constraint_classification(mass_market_extinction_2026, snare, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(mass_market_extinction_2026, rope, context(agent_power(institutional), _, _, _)),
    constraint_indexing:constraint_classification(mass_market_extinction_2026, tangled_rope, context(agent_power(analytical), _, _, _)).

test(extraction_threshold) :-
    domain_priors:base_extractiveness(mass_market_extinction_2026, E),
    E > 0.46. % Triggers temporal data requirement.

test(tangled_rope_structural_properties) :-
    % Verify all three conditions for Tangled Rope are met.
    narrative_ontology:constraint_beneficiary(mass_market_extinction_2026, _),
    narrative_ontology:constraint_victim(mass_market_extinction_2026, _),
    domain_priors:requires_active_enforcement(mass_market_extinction_2026).

:- end_tests(mass_market_extinction_2026_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * The base extraction score (0.70) reflects the "impossible to sustain" production
 * costs against a fixed consumer price expectation ($9.99). Suppression (0.82) is
 * high because the format's disappearance removes the only low-cost, widely
 * available physical book option from non-bookstore locations like grocery stores.
 *
 * The Perspectival Gap is stark: publishers see a coordinated, rational exit from
 * a failed market (Rope), while low-income readers experience the loss of an
 * essential good (Snare).
 *
 * MANDATROPHY ANALYSIS: [RESOLVED MANDATROPHY]
 * The original classification of Piton was incorrect because the constraint is
 * not inert; it is highly extractive (E=0.70). The Tangled Rope classification
 * correctly resolves this by acknowledging the dual nature of the constraint: it
 * possessed a genuine, decades-long coordination function (distributing cheap books)
 * that has become entangled with severe asymmetric extraction (the economic unsustainability
 * is offloaded onto readers who lose access). This prevents mislabeling the system
 * as either pure extraction (Snare) or pure inertia (Piton).
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_physical_literacy_floor,
    'Does the death of mass market create a permanent floor for physical book ownership, making it a luxury good?',
    'Tracking unit sales of Trade Paperbacks vs. E-books in former ID territories over 5 years.',
    'If trade paperback sales do not absorb the displaced readers, it implies print literacy is becoming a class-gated Snare.',
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

narrative_ontology:interval(mass_market_extinction_2026, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Model the decline from 2004 (T=0) to the final sunset in 2025/2026 (T=10).

% Theater ratio: Increases as the format becomes a legacy "ode" rather
% than a functional market driver, with publishers performatively lamenting its demise.
narrative_ontology:measurement(mm_tr_t0, mass_market_extinction_2026, theater_ratio, 0, 0.15).
narrative_ontology:measurement(mm_tr_t5, mass_market_extinction_2026, theater_ratio, 5, 0.30).
narrative_ontology:measurement(mm_tr_t10, mass_market_extinction_2026, theater_ratio, 10, 0.45).

% Extraction: Increases as unit sales plunge (131M to 15M) and fixed costs
% per unit skyrocket, making margins "impossible to sustain".
narrative_ontology:measurement(mm_ex_t0, mass_market_extinction_2026, base_extractiveness, 0, 0.25).
narrative_ontology:measurement(mm_ex_t5, mass_market_extinction_2026, base_extractiveness, 5, 0.55).
narrative_ontology:measurement(mm_ex_t10, mass_market_extinction_2026, base_extractiveness, 10, 0.70).

/* ==========================================================================
   9. BOLTZMANN & NETWORK DATA (v5.0-5.2)
   ========================================================================== */

% The mass-market paperback system was a mechanism for allocating a specific
% cultural resource (low-cost literature) to a wide audience.
narrative_ontology:coordination_type(mass_market_extinction_2026, resource_allocation).

% The collapse of this physical media format directly influences the market
% pressures and pricing strategies for its digital alternative.
narrative_ontology:affects_constraint(mass_market_extinction_2026, ebook_pricing_models).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */% ============================================================================
% CONSTRAINT STORY: matching_markets_general
% ============================================================================
% Generated: 2026-01-23
% Model: Gemini Pro (Revised)
% Source: Market Design / Alvin Roth / Lloyd Shapley
% ============================================================================

:- module(constraint_matching_markets_general, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:constraint_metric/3,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * 
 * constraint_id: matching_markets_general
 * human_readable: Matching Markets (Non-Commodity Exchange)
 * domain: economic/social/technological
 * temporal_scope: Biographical to Generational
 * spatial_scope: National to Global
 * 
 * SUMMARY:
 * Unlike commodity markets where price clears the market, matching markets involve 
 * "thick" preferences where the choice is mutual. You cannot simply "buy" a job 
 * at Google or a seat at Harvard; the other side must also choose you. This
 * requires a more complex mechanism than simple price-based allocation.
 * 
 * KEY AGENTS:
 * - The Unmatched Applicant (Individual Powerless): Lacks credentials to attract a match.
 * - The Institution / Clearinghouse (Institutional): Seeks to curate a specific cohort of participants.
 * - The Elite Candidate (Individual Powerful): Possesses high credentials and market value.
 */

/* ==========================================================================
   2. CORE SYSTEM INTEGRATION (The "Reality" Layer)
   ========================================================================== */

narrative_ontology:interval(matching_markets_general, 0, 10).
narrative_ontology:constraint_claim(matching_markets_general, tangled_rope).

% Base extractiveness: 0.4.
% Markets extract "signal" (effort, status, credentials) from participants 
% to facilitate the match.
domain_priors:base_extractiveness(matching_markets_general, 0.4).

% Suppression: 0.7.
% "Unmatched" alternatives (black markets, side deals) are often strictly 
% prohibited to maintain market "thickness" and stability.
domain_priors:suppression_score(matching_markets_general, 0.7).

% Constraint metric facts (bridge for classification engine)
narrative_ontology:constraint_metric(matching_markets_general, extractiveness, 0.4).
narrative_ontology:constraint_metric(matching_markets_general, suppression_requirement, 0.7).

% Enforcement: Usually requires active enforcement (Clearinghouses/Regulations).
domain_priors:requires_active_enforcement(matching_markets_general).

% BENEFICIARIES & VICTIMS
constraint_beneficiary(matching_markets_general, elite_participants).
constraint_victim(matching_markets_general, low_signal_agents).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (Perspectival Truth)
   ========================================================================== */

/* --------------------------------------------------------------------------
   PERSPECTIVE 1: THE UNMATCHED APPLICANT - Snare
   --------------------------------------------------------------------------
   WHO: powerless (Lacks credentials or signaling power)
   WHEN: immediate (During a specific matching cycle)
   WHERE: trapped (Excluded from the market due to no match)
   
   WHY THIS CLASSIFICATION:
   For the agent who fails to secure a match in a "thick" market (like medical 
   residency or kidney exchange), the system is a 'Snare'. The high 
   suppression of alternatives means that failing to match within the 
   system is equivalent to total exclusion from the profession or resource.
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    matching_markets_general,
    snare,
    context(
        agent_power(powerless),
        time_horizon(immediate),
        exit_options(trapped),
        spatial_scope(national)
    )
).

/* --------------------------------------------------------------------------
   PERSPECTIVE 2: THE INSTITUTION / CLEARINGHOUSE - Rope
   --------------------------------------------------------------------------
   WHO: institutional (Seeks to curate a specific cohort or allocate resources)
   WHEN: historical (Over multiple matching cycles)
   WHERE: arbitrage (Balances competing preferences and allocates resources)
   
   WHY THIS CLASSIFICATION:
   For the institution or clearinghouse, the matching market is a 'Rope'. It's a
   tool to efficiently allocate resources and talent based on complex preferences,
   ensuring stable and optimal outcomes for the entire market. It helps them
   coordinate a complex system of choices.
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    matching_markets_general,
    rope,
    context(
        agent_power(institutional),
        time_horizon(historical),
        exit_options(arbitrage),
        spatial_scope(global)
    )
).

/* --------------------------------------------------------------------------
   PERSPECTIVE 3: THE ECONOMIST - Mountain
   --------------------------------------------------------------------------
   WHO: analytical (Observes the underlying principles of market design)
   WHEN: civilizational (Studying economic laws across different societies)
   WHERE: analytical (Universal principles of matching theory)
   
   WHY THIS CLASSIFICATION:
   The economist sees the "laws of matching" as a 'Mountain'. The need 
   for thickness, the danger of market congestion, and the inevitability 
   of signaling costs are seen as natural features of information-dense 
   environments, regardless of the specific algorithm used.
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    matching_markets_general,
    mountain,
    context(
        agent_power(analytical),
        time_horizon(civilizational),
        exit_options(analytical),
        spatial_scope(global)
    )
).

/* ==========================================================================
   4. TESTS (What We Learn About Constraints)
   ========================================================================== */

:- begin_tests(matching_markets_general_tests).

test(multi_perspective_variance) :-
    constraint_indexing:constraint_classification(matching_markets_general, Type1, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(matching_markets_general, Type2, context(agent_power(institutional), _, _, _)),
    constraint_indexing:constraint_classification(matching_markets_general, Type3, context(agent_power(analytical), _, _, _)),
    Type1 \= Type2,
    Type2 \= Type3,
    Type1 \= Type3.

:- end_tests(matching_markets_general_tests).

/* ==========================================================================
   5. MODEL INTERPRETATION (Commentary)
   ========================================================================== */

/**
 * LLM GENERATION NOTES
 * 
 * Model: Gemini Pro (Revised)
 * Date: 2026-01-23
 * 
 * KEY DECISIONS:
 * 
 * 1. INSTITUTIONAL PERSPECTIVE: Added 'The Institution / Clearinghouse' as the
 *    institutional agent. For them, the matching market is a 'Rope' to
 *    efficiently manage complex allocation problems.
 *
 * 2. CLASSIFICATION RATIONALE:
 *    - Unmatched Applicant (Snare): Excluded from the market.
 *    - Institution (Rope): A tool for efficient allocation.
 *    - Economist (Mountain): Immutable laws of market design.
 * 
 * 3. CORE INSIGHT: Matching markets are a 'Tangled Rope'. They provide a 'Rope'
 *    for efficient allocation in non-commodity markets, but this same system
 *    creates a 'Snare' for those who fail to match, highlighting the tension
 *    between market efficiency and individual opportunity.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */
/**
 * OMEGA IDENTIFICATION
 *
 * The core uncertainty revolves around preference revelation and gaming the system.
 */

omega_variable(
    preference_revelation_cost,
    "Do participants reveal their true preferences, or do they strategize to 'game' the match, potentially leading to suboptimal outcomes and market instability?",
    resolution_mechanism("Comparison of algorithmically derived matches vs. post-match regret surveys; laboratory experiments on strategic behavior in matching markets."),
    impact("If Gamed: The 'Mountain' is actually a 'Scaffold' (unstable). If True: The 'Mountain' is solid, and the market is stable."),
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. ALTERNATIVE ANALYSIS
   ========================================================================== */
/**
 * VIABLE ALTERNATIVES
 *
 * ALTERNATIVE 1: Price-Clearing Markets
 *    Viability: Effective for commodity goods, but ethically and practically problematic for things like organ transplants, jobs, and school choice.
 *    Suppression: Actively suppressed in many matching markets to prevent commodification and ensure fairness.
 *
 * CONCLUSION:
 * Matching markets are a sophisticated 'Rope' designed to navigate the ethical
 * and practical 'Snare' of price-based allocation for non-commodity goods.
 * They represent a complex solution to a 'Mountain' of social coordination problems.
 */

/* ==========================================================================
   8. INTEGRATION HOOKS
   ========================================================================== */

/**
 * TO USE THIS FILE:
 * 
 * 1. Load: ?- [constraints/matching_markets_general].
 * 2. Multi-perspective: ?- multi_index_report(matching_markets_general).
 * 3. Run tests: ?- run_tests(matching_markets_general_tests).
 */

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */% ============================================================================
% CONSTRAINT STORY: material_tensile_strength
% ============================================================================
% Version: 5.2 (Deferential Realism Core + Boltzmann + Purity + Network)
% Logic: 5.2 (Indexed Tuple P,T,E,S + Coupling + Purity + Network Drift)
% Generated: 2024-07-15
% ============================================================================

:- module(constraint_material_tensile_strength, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    narrative_ontology:constraint_claim/2,
    narrative_ontology:affects_constraint/2,
    narrative_ontology:coordination_type/2,
    narrative_ontology:boltzmann_floor_override/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: material_tensile_strength
 * human_readable: Ultimate Tensile Strength (UTS)
 * domain: technological
 * * SUMMARY:
 * Tensile strength is the maximum stress that a material can withstand while
 * being stretched or pulled before breaking. It represents the fundamental
 * cohesive limit of atomic bonding within a solid, dictating the maximum load
 * a structure can carry per unit of cross-sectional area. This is a physical
 * law, not a social construct.
 * * KEY AGENTS:
 * - The Material Scientist: An analytical observer measuring a fixed property.
 * - The Civil Engineer: An institutional agent designing structures around this fixed limit.
 * - The Overloaded Component: A physical object subject to the limit.
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
% Rationale: As a fundamental physical property, tensile strength has near-zero
% extractiveness. It doesn't "take" anything; it is simply a limit.
% Suppression is also minimal; it doesn't suppress alternatives, it defines the
% physical possibility space.
domain_priors:base_extractiveness(material_tensile_strength, 0.02). % Mountain suppression <= 0.05, Rope extraction <= 0.15, Snare extraction >= 0.46
domain_priors:suppression_score(material_tensile_strength, 0.01).   % Structural property (raw, unscaled). Only extractiveness is scaled (by power and scope).
domain_priors:theater_ratio(material_tensile_strength, 0.0).       % Piton detection (>= 0.70)

% Constraint metric facts — primary keys used by the classification engine.
% These mirror domain_priors values using the metric key names from config.pl.
narrative_ontology:constraint_metric(material_tensile_strength, extractiveness, 0.02).
narrative_ontology:constraint_metric(material_tensile_strength, suppression_requirement, 0.01).
narrative_ontology:constraint_metric(material_tensile_strength, theater_ratio, 0.0).

% Constraint self-claim (what does the constraint claim to be?)
% Values: natural_law, coordination, constructed, enforcement
narrative_ontology:constraint_claim(material_tensile_strength, natural_law).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   Power (P) and Scope (S) both affect effective extraction.
   Scope modifiers: local=0.8, regional=0.9, national=1.0,
                    continental=1.1, global=1.2, universal=1.0.
   ========================================================================== */

% UNIFORM-TYPE CONSTRAINT: This is a natural law, which classifies as a
% Mountain from all perspectives. The perspectival minimum is relaxed.

% PERSPECTIVE 1: THE MATERIAL SCIENTIST (MOUNTAIN)
% To the scientist, tensile strength is a Mountain. It is an unchangeable
% feature of the material's atomic "hardware."
constraint_indexing:constraint_classification(material_tensile_strength, mountain,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(universal))).

% PERSPECTIVE 2: THE STRUCTURAL ENGINEER (MOUNTAIN)
% For the engineer, the limit is still a Mountain. They don't change the limit;
% they design around it. It is a fixed feature of the landscape they must build on.
constraint_indexing:constraint_classification(material_tensile_strength, mountain,
    context(agent_power(institutional),
            time_horizon(generational),
            exit_options(arbitrage), % Can choose different materials (mountains)
            spatial_scope(regional))).

% PERSPECTIVE 3: THE OVERLOADED COMPONENT (MOUNTAIN)
% For a cable under load, the limit is the point of failure. It is not a trap
% (Snare) but an immutable physical boundary. Reaching the boundary results in
% failure, but the boundary itself is a fixed, non-extractive Mountain.
constraint_indexing:constraint_classification(material_tensile_strength, mountain,
    context(agent_power(powerless),
            time_horizon(immediate),
            exit_options(trapped),
            spatial_scope(local))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(material_tensile_strength_tests).

test(perspectival_invariance) :-
    % Verify that as a natural law, it is a Mountain from all perspectives.
    constraint_indexing:constraint_classification(material_tensile_strength, mountain, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(material_tensile_strength, mountain, context(agent_power(institutional), _, _, _)),
    constraint_indexing:constraint_classification(material_tensile_strength, mountain, context(agent_power(analytical), _, _, _)).

test(threshold_validation_mountain) :-
    % Verify the metrics adhere to the Mountain classification thresholds.
    config:param(extractiveness_metric_name, ExtMetricName),
    config:param(suppression_metric_name, SuppMetricName),
    narrative_ontology:constraint_metric(material_tensile_strength, ExtMetricName, E),
    narrative_ontology:constraint_metric(material_tensile_strength, SuppMetricName, S),
    E =< 0.15,
    S =< 0.05.

:- end_tests(material_tensile_strength_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * This constraint was refactored to correctly model a physical law. The original
 * version incorrectly assigned high extraction (0.5) and perspectival variance
 * (Rope, Snare). This is a category error. A physical law like tensile strength
 * is the canonical example of a Mountain: it is a fixed, unchangeable feature
 * of reality with effectively zero base extractiveness or suppression.
 *
 * The scores were adjusted to E=0.02 and S=0.01 to fall well within the Mountain
 * thresholds (E<=0.15, S<=0.05). Consequently, all perspectives correctly
 * classify the constraint as a Mountain. An engineer using the law for
 * coordination does not change the law into a Rope; they are simply using a
 * known Mountain as a reference point. A component failing does not make the
 * law a Snare; it simply means a physical limit was reached.
 *
 * As a low-extraction constraint, it does not require Omega variables or
 * temporal lifecycle data.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

% Not required for low-extraction constraints.

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

% Required for external script parsing
narrative_ontology:interval(material_tensile_strength, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Not required for low-extraction constraints. The properties of a physical
% law are constant over the interval.

/* ==========================================================================
   9. BOLTZMANN & NETWORK DATA (v5.0-5.2)
   ========================================================================== */

% No coordination function or network relationships are applicable for a
% fundamental physical constant.

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */% ============================================================================
% CONSTRAINT STORY: max_flow_min_cut
% ============================================================================
% Generated: 2026-01-17
% Model: Gemini 2.0 Flash
% Source: Ford-Fulkerson Algorithm / Network Flow Theory
% ============================================================================

:- module(constraint_max_flow_min_cut, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks ---
:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:constraint_metric/3,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: max_flow_min_cut
 * human_readable: The Max-Flow Min-Cut Theorem
 * domain: technological/mathematical
 * temporal_scope: Immediate to Historical
 * spatial_scope: Regional to Global
 * * SUMMARY:
 * The Max-Flow Min-Cut theorem states that the maximum amount of flow passing 
 * from a source to a sink in a network is exactly equal to the total weight 
 * of the edges in the minimum cut (the smallest set of edges that, if removed, 
 * would disconnect the source from the sink).
 * * KEY AGENTS:
 * - The Network Architect: Designs the pipes/capacities (institutional power).
 * - The Flow: The data, water, or traffic moving through the system (passive).
 * - The Bottleneck: The specific "Min-Cut" edges that dictate the limit.
 * * NARRATIVE ARC:
 * The constraint acts as an invisible ceiling. No matter how much pressure or 
 * "flow" is added at the source, the system's throughput is hard-capped by the 
 * narrowest part of the network architecture.
 */

/* ==========================================================================
   2. BASE PROPERTIES (Reality Layer)
   ========================================================================== */

narrative_ontology:interval(max_flow_min_cut, 0, 10).
narrative_ontology:constraint_claim(max_flow_min_cut, mountain).

% Base extractiveness: Moderate (0.4).
% While it's a math law, in human systems (logistics/telecom), the bottleneck 
% often "extracts" value by forcing congestion or fees at the narrowest point.
domain_priors:base_extractiveness(max_flow_min_cut, 0.4).

% Suppression: Low (0.2).
% The bottleneck is usually highly visible to those looking for it (monitoring tools).
domain_priors:suppression_score(max_flow_min_cut, 0.2).

% Constraint metric facts (bridge for classification engine)
narrative_ontology:constraint_metric(max_flow_min_cut, extractiveness, 0.4).
narrative_ontology:constraint_metric(max_flow_min_cut, suppression_requirement, 0.2).

domain_priors:emerges_naturally(max_flow_min_cut).

% Beneficiaries: The Bottleneck Owner (e.g., the bridge with the toll).
constraint_beneficiary(max_flow_min_cut, bottleneck_controller).

% Victims: The Source/Sink Users (limited by the narrowest path).
constraint_victim(max_flow_min_cut, end_users).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (Perspectival Truth)
   ========================================================================== */

/* --------------------------------------------------------------------------
   PERSPECTIVE 1: THE DATA PACKET - Mountain
   --------------------------------------------------------------------------
   WHO: powerless
   WHEN: immediate
   WHERE: trapped
   SCOPE: local
   
   WHY THIS CLASSIFICATION:
   For a single unit of flow, the capacity of the edge it is currently on is 
   an immutable law. It cannot "push" harder to move faster than the 
   bandwidth allows.
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    max_flow_min_cut,
    mountain,
    context(
        agent_power(powerless),
        time_horizon(immediate),
        exit_options(trapped),
        spatial_scope(local)
    )
) :-
    domain_priors:emerges_naturally(max_flow_min_cut),
    !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 2: THE NETWORK ENGINEER - Rope
   --------------------------------------------------------------------------
   WHO: institutional
   WHEN: biographical
   WHERE: mobile
   SCOPE: regional
   
   WHY THIS CLASSIFICATION:
   The engineer sees the bottleneck as a "Rope"—a tool for coordination. 
   By identifying the Min-Cut, they can strategically upgrade specific edges 
   to improve total flow efficiently.
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    max_flow_min_cut,
    rope,
    context(
        agent_power(institutional),
        time_horizon(biographical),
        exit_options(mobile),
        spatial_scope(regional)
    )
) :-
    true.

/* --------------------------------------------------------------------------
   PERSPECTIVE 3: THE MONOPOLIST - Snare
   --------------------------------------------------------------------------
   WHO: powerful
   WHEN: generational
   WHERE: arbitrage
   SCOPE: national
   
   WHY THIS CLASSIFICATION:
   A powerful agent who owns the bottleneck uses the Max-Flow limit as a 
   "Snare" to squeeze users. They purposefully keep capacity low to maintain 
   scarcity and high extraction rates.
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    max_flow_min_cut,
    snare,
    context(
        agent_power(powerful),
        time_horizon(generational),
        exit_options(arbitrage),
        spatial_scope(national)
    )
) :-
    domain_priors:base_extractiveness(max_flow_min_cut, E),
    E >= 0.4,
    !.

/* ==========================================================================
   4. TESTS
   ========================================================================== */

:- begin_tests(max_flow_tests).

test(multi_perspective_variance) :-
    constraint_indexing:constraint_classification(max_flow_min_cut, Mountain, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(max_flow_min_cut, Rope, context(agent_power(institutional), _, _, _)),
    Mountain \= Rope.

test(bottleneck_awareness) :-
    % Testing if "mobile" agents (engineers) see it as a coordination rope.
    constraint_indexing:constraint_classification(max_flow_min_cut, rope, context(_, _, mobile, _)).

:- end_tests(max_flow_tests).

/* ==========================================================================
   5. MODEL INTERPRETATION (Commentary)
   ========================================================================== */

/**
 * LLM GENERATION NOTES
 * Model: Gemini 2.0 Flash
 * * KEY DECISIONS:
 * The "Max-Flow" problem is fundamentally about bottlenecks. 
 * While the math is a Mountain, the *application* of that math in 
 * socio-technical systems is often a Snare (extraction) or a Rope (design).
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω)
   ========================================================================== */

omega_variable(
    dynamic_capacity,
    "Do edge capacities fluctuate based on flow history?",
    resolution_mechanism("Analysis of non-linear network dynamics / congestion collapse"),
    impact("If Capacities=Fixed: Max-Flow/Min-Cut holds. If Capacities=Dynamic: The 'Mountain' becomes a 'Sea' (shifting ground)."),
    confidence_without_resolution(medium)
).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */


% --- v3.1 Indexical Relativity Stubs (Fleet Repair) ---
constraint_indexing:constraint_classification(max_flow, mountain, agent_power(analytical)).
constraint_indexing:constraint_classification(max_flow, rope, agent_power(institutional)).
constraint_indexing:constraint_classification(max_flow, snare, agent_power(powerless)).
% ============================================================================
% CONSTRAINT STORY: mco_unit_system_discontinuity
% ============================================================================
% Version: 5.2 (Deferential Realism Core + Boltzmann + Purity + Network)
% Logic: 5.2 (Indexed Tuple P,T,E,S + Coupling + Purity + Network Drift)
% Generated: 2024-07-29
% ============================================================================

:- module(constraint_mco_unit_system_discontinuity, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    narrative_ontology:constraint_claim/2,
    narrative_ontology:affects_constraint/2,
    narrative_ontology:coordination_type/2,
    narrative_ontology:boltzmann_floor_override/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: mco_unit_system_discontinuity
 * human_readable: Persistence of Imperial Units in a Metric World
 * domain: technological/institutional
 * * SUMMARY:
 * The continued use of the Imperial unit system in a global scientific
 * community that has standardized on Metric is a classic Piton. It is a
 * legacy coordination system (a Rope) that has lost its primary function but
 * persists through cultural inertia and the cost of refactoring legacy systems.
 * This creates constant friction, risk, and catastrophic failures, like the
 * Mars Climate Orbiter loss, which serves as the canonical example of this
 * Piton failing under load.
 * * KEY AGENTS:
 * - Navigation Engineer (JPL): Subject (Powerless); subject to the data
 * provided by the upstream software interface.
 * - Software Architect (Lockheed): Beneficiary (Institutional); established the original
 * coding standards and unit choices, benefiting from not having to refactor.
 * - Mishap Investigation Board: Auditor (Analytical); post-hoc observer identifying
 * the systemic failure.
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
% Rationale (Extractiveness): 0.3. Low-to-moderate. The constraint extracts cognitive energy
% through constant conversion requirements and introduces a high risk of
% catastrophic failure (like the MCO loss), but does not perform active, continuous extraction.
domain_priors:base_extractiveness(mco_unit_system_discontinuity, 0.3).
% Rationale (Suppression): 0.1. Very low. The Metric system is not actively suppressed;
% the Imperial system simply persists through cultural and educational inertia.
domain_priors:suppression_score(mco_unit_system_discontinuity, 0.1).
% Rationale (Theater): 0.85. High. The maintenance of Imperial units in this context is
% almost entirely performative or inertial. It serves no superior function to the global
% standard and its continued use is a form of institutional theater.
domain_priors:theater_ratio(mco_unit_system_discontinuity, 0.85).

% Constraint metric facts — primary keys used by the classification engine.
narrative_ontology:constraint_metric(mco_unit_system_discontinuity, extractiveness, 0.3).
narrative_ontology:constraint_metric(mco_unit_system_discontinuity, suppression_requirement, 0.1).
narrative_ontology:constraint_metric(mco_unit_system_discontinuity, theater_ratio, 0.85).

% Constraint self-claim (what does the constraint claim to be?)
% It claims to be a valid coordination standard, a constructed system.
narrative_ontology:constraint_claim(mco_unit_system_discontinuity, constructed).

% Structural property derivation hooks:
narrative_ontology:constraint_beneficiary(mco_unit_system_discontinuity, us_aerospace_legacy_tooling).
narrative_ontology:constraint_victim(mco_unit_system_discontinuity, planetary_science_community).
narrative_ontology:constraint_victim(mco_unit_system_discontinuity, us_taxpayers).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   Power (P) and Scope (S) both affect effective extraction.
   Scope modifiers: local=0.8, regional=0.9, national=1.0,
                    continental=1.1, global=1.2, universal=1.0.
   ========================================================================== */

% PERSPECTIVE 1: THE SUBJECT (JPL NAVIGATION ENGINEER)
% To the engineer receiving the data, the software interface is a Mountain.
% They assume the "Force" value provided is in the standard SI units
% required by their system. There is no "choice" to interpret the number
% differently; the data is presented as an immutable fact.
constraint_indexing:constraint_classification(mco_unit_system_discontinuity, mountain,
    context(agent_power(powerless),
            time_horizon(immediate),
            exit_options(trapped),
            spatial_scope(local))).

% PERSPECTIVE 2: THE BENEFICIARY (NASA PROJECT MANAGEMENT)
% Management views the Interface Control Document (ICD) as a Rope—a
% functional coordination mechanism that allows two different
% organizations to work on the same hardware. They believe the
% "system" is coordinating the teams effectively through these documents.
constraint_indexing:constraint_classification(mco_unit_system_discontinuity, rope,
    context(agent_power(institutional),
            time_horizon(biographical),
            exit_options(mobile),
            spatial_scope(national))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (MISHAP INVESTIGATION BOARD)
% The Board identifies the use of Imperial units as a Piton. It was a
% legacy Rope that lost its function in a global, metric-first scientific
% project. Its persistence through inertia (high theater_ratio) created a
% high-risk, low-benefit situation that ultimately failed under load.
constraint_indexing:constraint_classification(mco_unit_system_discontinuity, piton,
    context(agent_power(analytical),
            time_horizon(historical),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(mco_unit_system_discontinuity_tests).

test(perspectival_gap) :-
    % Verify there is a perspectival gap between powerless, institutional, and analytical.
    constraint_indexing:constraint_classification(mco_unit_system_discontinuity, TypePowerless, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(mco_unit_system_discontinuity, TypeInstitutional, context(agent_power(institutional), _, _, _)),
    constraint_indexing:constraint_classification(mco_unit_system_discontinuity, TypeAnalytical, context(agent_power(analytical), _, _, _)),
    TypePowerless == mountain,
    TypeInstitutional == rope,
    TypeAnalytical == piton,
    TypePowerless \= TypeInstitutional,
    TypeInstitutional \= TypeAnalytical.

test(piton_threshold_validation) :-
    % Verify the analytical observer correctly identifies a Piton, which requires a high theater ratio.
    narrative_ontology:constraint_metric(mco_unit_system_discontinuity, theater_ratio, TR),
    TR >= 0.70,
    constraint_indexing:constraint_classification(mco_unit_system_discontinuity, piton, context(agent_power(analytical), _, _, _)).

:- end_tests(mco_unit_system_discontinuity_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * This constraint is a canonical example of a Piton. The core of the analysis rests on the
 * high theater_ratio (0.85), representing the persistence of an obsolete standard (Imperial units)
 * in a context where a superior alternative (Metric) is the global norm.
 *
 * The base extractiveness (0.3) is low because the system doesn't actively take resources day-to-day;
 * instead, it imposes cognitive friction and creates the *risk* of catastrophic, high-extraction failure.
 * Suppression (0.1) is minimal as no one is actively preventing the use of Metric.
 *
 * The Perspectival Gap is stark and informative:
 * - The powerless Engineer sees the incorrect data as an immutable fact (Mountain).
 * - The institutional Manager sees the flawed process documents as functional coordination (Rope).
 * - The analytical Investigator, with a historical view, sees the obsolete, inertial system for what it is: a Piton.
 * This divergence is key to understanding how such failures can occur in complex systems.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

% omega_variable(ID, Question, Resolution_Mechanism, Impact, Confidence).
omega_variable(
    omega_mco_unit_system_discontinuity,
    'Was the failure primarily due to cultural inertia (Piton) or active budget suppression of verification tools (Snare)?',
    'Review of internal project memos from the "Faster, Better, Cheaper" era to find evidence of denied requests for end-to-end testing.',
    'If due to inertia, it remains a Piton. If due to active suppression of known solutions for cost reasons, it would be reclassified as a Snare.',
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

% Required for external script parsing
narrative_ontology:interval(mco_unit_system_discontinuity, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Temporal data is not required for this constraint as base_extractiveness (0.3)
% is below the 0.46 threshold for mandatory lifecycle drift monitoring.

/*
narrative_ontology:measurement(mco_unit_system_discontinuity_tr_t0, mco_unit_system_discontinuity, theater_ratio, 0, 0.0).
narrative_ontology:measurement(mco_unit_system_discontinuity_tr_t5, mco_unit_system_discontinuity, theater_ratio, 5, 0.0).
narrative_ontology:measurement(mco_unit_system_discontinuity_tr_t10, mco_unit_system_discontinuity, theater_ratio, 10, 0.85).

narrative_ontology:measurement(mco_unit_system_discontinuity_ex_t0, mco_unit_system_discontinuity, base_extractiveness, 0, 0.0).
narrative_ontology:measurement(mco_unit_system_discontinuity_ex_t5, mco_unit_system_discontinuity, base_extractiveness, 5, 0.0).
narrative_ontology:measurement(mco_unit_system_discontinuity_ex_t10, mco_unit_system_discontinuity, base_extractiveness, 10, 0.3).
*/

/* ==========================================================================
   9. BOLTZMANN & NETWORK DATA (v5.0-5.2)
   ========================================================================== */

% A system of units is a quintessential information standard.
narrative_ontology:coordination_type(mco_unit_system_discontinuity, information_standard).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */% ============================================================================
% CONSTRAINT STORY: med_diet_consensus_2026
% ============================================================================
% Generated: 2026-01-21
% Model: Gemini 2.0 Flash
% Source: "The one diet that’s good for everything" by Carissa Wong (Jan 2026)
% ============================================================================

:- module(constraint_med_diet_consensus_2026, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:constraint_metric/3,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: med_diet_consensus_2026
 * human_readable: Mediterranean Diet Scientific Hegemony
 * domain: health/scientific/economic
 * temporal_scope: 1999-2026 (The "RCT Era" of nutrition)
 * spatial_scope: Global (Scientific/Medical community)
 * * SUMMARY:
 * The establishment of the Mediterranean diet as the "gold standard" of nutrition 
 * through Randomized Controlled Trials (RCTs). This creates a normative health 
 * constraint where alternative dietary patterns are classified as "fads" or 
 * "sub-optimal," influencing insurance, public health policy, and social status.
 * * KEY AGENTS:
 * - Institutional Scientist: (e.g., Luigi Fontana) - Views the diet as a verified 
 * biological tool for longevity.
 * - Health-Conscious Citizen: (Individual Moderate) - Experiences the diet as a 
 * voluntary coordination mechanism for better health.
 * - Low-Income Subject: (Individual Powerless) - Experiences the diet as a 
 * normative "Snare" due to the high cost of fresh legumes, fish, and olive oil.
 * * NARRATIVE ARC:
 * From 1940s observation (Ancel Keys) to 1999 heart attack trials, to 2026 
 * consensus. The constraint moves from a "suggestion" to a "scientific truth" 
 * that dictates what is considered "delicious" and "planetary-friendly."
 */

/* ==========================================================================
   2. BASE PROPERTIES (Reality Layer)
   ========================================================================== */

% Required for [STEP 1] and [STEP 2] of the DR-Audit Suite
narrative_ontology:interval(med_diet_consensus_2026, 0, 10).
narrative_ontology:constraint_claim(med_diet_consensus_2026, snare).

% Base extractiveness score: 0.2 (Low)
% Rationale: The primary beneficiary is the subject's own health and the planet. 
% However, there is mild asymmetry in "health-washing" and the premium pricing 
% of Mediterranean staples.
domain_priors:base_extractiveness(med_diet_consensus_2026, 0.2).

% Suppression score: 0.4 (Moderate)
% Rationale: The text explicitly dismisses "dietary fads" and contrasts the 
% Mediterranean diet with the "low-fat" alternative which was beaten in RCTs. 
% Alternatives are visible but scientifically delegitimized.
domain_priors:suppression_score(med_diet_consensus_2026, 0.4).

% Constraint metric facts (bridge for classification engine)
narrative_ontology:constraint_metric(med_diet_consensus_2026, extractiveness, 0.2).
narrative_ontology:constraint_metric(med_diet_consensus_2026, suppression_requirement, 0.4).

% Enforcement: Emerges naturally through consensus/scientific validation.
domain_priors:emerges_naturally(med_diet_consensus_2026).

% BENEFICIARIES & VICTIMS
constraint_beneficiary(med_diet_consensus_2026, global_healthcare_systems).
constraint_beneficiary(med_diet_consensus_2026, planetary_ecology).
constraint_victim(med_diet_consensus_2026, processed_food_industry).
constraint_victim(med_diet_consensus_2026, low_income_populations). % (Economic extraction via food-pricing)

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (Perspectival Truth)
   ========================================================================== */

/* --------------------------------------------------------------------------
   PERSPECTIVE 1: INSTITUTIONAL SCIENTIST - Rope
   --------------------------------------------------------------------------
   WHO: institutional (Rule-making/Scientific consensus)
   WHEN: generational (Thinking in terms of decades of evidence)
   WHERE: mobile (Can choose different research focuses)
   SCOPE: global (The "Scientific Gold Standard")
   
   WHY THIS CLASSIFICATION:
   The scientist sees the diet as a "Rope"—a beneficial coordination mechanism 
   grounded in RCT data. It is a tool to be used to improve public health 
   outcomes, with high degrees of freedom for the expert to recommend or tweak.
   
   NARRATIVE EVIDENCE:
   "It’s not only healthy, it’s also extremely tasty... established it as 
   the scientific gold standard."
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    med_diet_consensus_2026,
    rope,
    context(
        agent_power(institutional),
        time_horizon(generational),
        exit_options(mobile),
        spatial_scope(global)
    )
).

/* --------------------------------------------------------------------------
   PERSPECTIVE 2: LOW-INCOME CITIZEN - Snare
   --------------------------------------------------------------------------
   WHO: powerless (No control over food supply/pricing)
   WHEN: biographical (Short-term survival/budget)
   WHERE: trapped (Living in food deserts or economic constraints)
   SCOPE: local (Limited to local supermarket inventory)
   
   WHY THIS CLASSIFICATION:
   For those who cannot afford fresh fish, nuts, and high-quality olive oil, 
   the "Gold Standard" acts as a Snare. It is a normative requirement for 
   health that is economically inaccessible, creating a sense of failure or 
   systemic exclusion while the "experts" celebrate its deliciousness.
   
   NARRATIVE EVIDENCE:
   The article focuses on "fibre, vegetables, legumes, fruit, nuts, fish" 
   without addressing the income levels of participants in the Seven Countries 
   Study, which Ancel Keys ignored.
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    med_diet_consensus_2026,
    snare,
    context(
        agent_power(powerless),
        time_horizon(biographical),
        exit_options(trapped),
        spatial_scope(local)
    )
).

/* --------------------------------------------------------------------------
   PERSPECTIVE 3: BIOLOGICAL ANALYST - Mountain
   --------------------------------------------------------------------------
   WHO: analytical (Observer of physiology)
   WHEN: civilizational (Evolutionary human metabolism)
   WHERE: analytical (Universal application)
   SCOPE: global (Biological reality)
   
   WHY THIS CLASSIFICATION:
   From an evolutionary biology perspective, the human body's positive response 
   to these specific nutrient ratios (Omega-3s, fibre) is a "Mountain." It is 
   not a choice but a fixed biological law of human health that we must 
   navigate, similar to the law of gravity.
   
   NARRATIVE EVIDENCE:
   "Time and time again, scientists have found that one diet beats all others... 
   backed up by decades of evidence."
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    med_diet_consensus_2026,
    mountain,
    context(
        agent_power(analytical),
        time_horizon(civilizational),
        exit_options(analytical),
        spatial_scope(global)
    )
).

/* ==========================================================================

   4. TESTS (What We Learn About Constraints)

   ========================================================================== */



:- begin_tests(med_diet_consensus_2026_tests).



/**

 * TEST 1: Multi-perspective variance

 * Demonstrates that the Mediterranean diet is viewed differently across agents.

 */

test(multi_perspective_variance) :-

    % Institutional Scientist (Rope)

    constraint_indexing:constraint_classification(

        med_diet_consensus_2026,

        Type1,

        context(agent_power(institutional), time_horizon(generational), exit_options(mobile), spatial_scope(global))

    ),

    % Low-Income Subject (Snare)

    constraint_indexing:constraint_classification(

        med_diet_consensus_2026,

        Type2,

        context(agent_power(powerless), time_horizon(biographical), exit_options(trapped), spatial_scope(local))

    ),

    % Biological Analyst (Mountain)

    constraint_indexing:constraint_classification(

        med_diet_consensus_2026,

        Type3,

        context(agent_power(analytical), time_horizon(civilizational), exit_options(analytical), spatial_scope(global))

    ),

    % Verify they differ

    Type1 \= Type2,

    Type2 \= Type3,

    Type1 \= Type3. % Ensure all three are distinct



/**

 * TEST 2: Power-based extractiveness scaling

 * Demonstrates that low-income subjects (powerless) experience higher extraction (economic inaccessibility) than institutional scientists.

 */

test(power_extractiveness_scaling) :-

    ContextPowerless = context(agent_power(powerless), time_horizon(biographical), exit_options(trapped), spatial_scope(local)),

    ContextPowerful = context(agent_power(institutional), time_horizon(generational), exit_options(mobile), spatial_scope(global)),

    constraint_indexing:extractiveness_for_agent(med_diet_consensus_2026, ContextPowerless, Score1),

    constraint_indexing:extractiveness_for_agent(med_diet_consensus_2026, ContextPowerful, Score2),

    Score1 > Score2.  % Powerless experience more extraction



/**

 * TEST 3: Time-horizon immutability

 * Demonstrates that while individual choices are flexible, biological realities are immutable over long time horizons.

 */

test(time_immutability) :-

    % Short horizon (biographical) sees it as a chore/choice (Rope)

    constraint_indexing:effective_immutability(time_horizon(biographical), exit_options(mobile), rope),

    % Long horizon (civilizational) sees it as a fixed biological law (Mountain).

    constraint_indexing:effective_immutability(time_horizon(civilizational), exit_options(analytical), mountain).



/**

 * TEST 4: Domain-specific insight - Economic Accessibility as a Constraint

 * Demonstrates that economic factors can transform a scientifically proven "Rope" into a "Snare".

 */

test(economic_accessibility) :-

    constraint_indexing:constraint_classification(med_diet_consensus_2026, ClassificationLowIncome, context(agent_power(powerless), _, _, _)),

    constraint_indexing:constraint_classification(med_diet_consensus_2026, ClassificationScientist, context(agent_power(institutional), _, _, _)),

    ClassificationLowIncome = snare,

    ClassificationScientist = rope.



:- end_tests(med_diet_consensus_2026_tests).



/* ==========================================================================

   5. MODEL INTERPRETATION (Commentary)

   ========================================================================== */



/**

 * LLM GENERATION NOTES

 * 

 * Model: Gemini 2.0 Flash

 * Date: 2026-01-23

 * 

 * KEY DECISIONS:

 * 

 * 1. BASE EXTRACTIVENESS (0.2): Chose low because the diet genuinely helps the individual. 

 * The "extraction" is largely symbolic (social pressure) or economic 

 * (market premium on Mediterranean goods).

 * 

 * 2. PERSPECTIVE SELECTION:

 *    Highlighted the "Low-Income Subject" as a Snare because dietary advice often 

 *    ignores the material constraints of poverty, effectively punishing those who 

 *    can't comply. Contrasted this with the Institutional Scientist (Rope) and 

 *    Biological Analyst (Mountain) to show the multi-faceted nature.

 * 

 * 3. OMEGAS 

 *    Define uncertainty so your analysis is cleaner

 *    omega_variable(

 *        med_diet_genetic_universality,

 *        "Does the Mediterranean diet benefit all genetic haplotypes equally, or is the 'gold standard' biased toward European metabolic history?",

 *        resolution_mechanism("Genome-wide association studies across diverse global populations (beyond the Seven Countries Study)"),

 *        impact("If biased: Snare for non-European populations. If universal: Mountain."),

 *        confidence_without_resolution(medium)

 *    ).

 * 

 *    omega_variable(

 *        med_diet_supply_chain_collapse,

 *        "Will climate change render the Mediterranean staples (olive oil, specific fish) so scarce that the diet becomes an elitist Snare?",

 *        resolution_mechanism("Monitoring agricultural yields in the Mediterranean basin vs. global demand over next 20 years"),

 *        impact("If scarce: Becomes a marker of class (Snare). If adaptable: Remains a Rope."),

 *        confidence_without_resolution(low)

 *    ).

 */



/* ==========================================================================

   6. ALTERNATIVE ANALYSIS (If Applicable)

   ========================================================================== */



/**

 * VIABLE ALTERNATIVES

 * 

 * ALTERNATIVE 1: Low-Fat Diet

 *    Viability: Was the standard in the late 20th century, representing a scientifically backed alternative approach.

 *    Suppression: Explicitly rejected by the 1999 RCT mentioned in the text, which scientifically delegitimized it in favor of the Mediterranean diet.

 * 

 * ALTERNATIVE 2: Ancestral/Regional Diets (e.g., Nordic, Japanese)

 *    Viability: High health outcomes reported in populations adhering to these diets, suggesting regional dietary patterns can be equally or more effective within their specific contexts.

 *    Suppression: Largely ignored by the "Mediterranean" branding and scientific consensus, leading to a monoculture of dietary advice that overlooks other effective, culturally relevant approaches.

 * 

 * CONCLUSION:

 * The scientific consensus around the Mediterranean diet, while well-intentioned, suppresses awareness and scientific exploration of equally viable alternative dietary patterns. This suppression, especially when combined with economic inaccessibility for some populations, solidifies its "Snare" aspect for those outside the "gold standard."

 */



/* ==========================================================================

   7. INTEGRATION HOOKS

   ========================================================================== */



/**

 * TO USE THIS CONSTRAINT:

 * 

 * 1. Load into main system:

 *    ?- [constraints/med_diet_consensus_2026].

 * 

 * 2. Run multi-perspective analysis:

 *    ?- constraint_indexing:multi_index_report(med_diet_consensus_2026).

 * 

 * 3. Run tests:

 *    ?- run_tests(med_diet_consensus_2026_tests).

 * 

 * 4. Generate pedagogical report:

 *    ?- pedagogical_report(med_diet_consensus_2026).

 * 

 * 5. Compare with other constraints:

 *    ?- compare_constraints(med_diet_consensus_2026, [other_id]).

 */



/* ==========================================================================

   END OF CONSTRAINT STORY

   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: medical_residency_match
% ============================================================================
% Version: 5.2 (Deferential Realism Core + Boltzmann + Purity + Network)
% Logic: 5.2 (Indexed Tuple P,T,E,S + Coupling + Purity + Network Drift)
% Generated: 2024-07-23
% ============================================================================

:- module(constraint_medical_residency_match, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    narrative_ontology:constraint_claim/2,
    narrative_ontology:affects_constraint/2,
    narrative_ontology:coordination_type/2,
    narrative_ontology:boltzmann_floor_override/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: medical_residency_match
 * human_readable: The NRMP Medical Residency Match
 * domain: economic/social
 * * SUMMARY:
 * The "Match" is a centralized clearinghouse using a stable matching algorithm
 * (Roth-Peranson) to pair medical students with residency programs. It was
 * created to solve market unraveling ("exploding offers") but now functions
 * as a mandatory, legally binding bottleneck that suppresses wage competition
 * and removes individual bargaining power for new doctors.
 * * KEY AGENTS:
 * - Medical Graduates: Subjects who must participate to become licensed physicians.
 * - Hospital Networks: Beneficiaries who receive a predictable labor supply at suppressed wages.
 * - NRMP/AAMC: Institutional enforcers of the system.
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(medical_residency_match, 0.60). % High extraction via wage suppression.
domain_priors:suppression_score(medical_residency_match, 0.95).   % Participation is mandatory; side-deals are prohibited and professionally sanctioned.
domain_priors:theater_ratio(medical_residency_match, 0.10).       % The system is highly functional, not theatrical.

% Constraint metric facts — primary keys used by the classification engine.
narrative_ontology:constraint_metric(medical_residency_match, extractiveness, 0.60).
narrative_ontology:constraint_metric(medical_residency_match, suppression_requirement, 0.95).
narrative_ontology:constraint_metric(medical_residency_match, theater_ratio, 0.10).

% Constraint self-claim (what does the constraint claim to be?)
% It claims to be a fair coordination mechanism to solve a market failure.
narrative_ontology:constraint_claim(medical_residency_match, coordination).

% Binary flags
domain_priors:requires_active_enforcement(medical_residency_match). % Required for Tangled Rope.

% Structural property derivation hooks:
% has_coordination_function/1 is DERIVED from constraint_beneficiary/2
% has_asymmetric_extraction/1 is DERIVED from constraint_victim/2
narrative_ontology:constraint_beneficiary(medical_residency_match, hospital_networks).
narrative_ontology:constraint_victim(medical_residency_match, medical_graduates).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   Power (P) and Scope (S) both affect effective extraction.
   Scope modifiers: local=0.8, regional=0.9, national=1.0,
                    continental=1.1, global=1.2, universal=1.0.
   ========================================================================== */

% PERSPECTIVE 1: THE SUBJECT (SNARE)
% For the student, the Match is a trap. Exit is impossible without abandoning
% one's career. The outcome is legally binding with no room for negotiation.
% χ = 0.60 * 1.5 (powerless) * 1.0 (national) = 0.90. This is a clear Snare.
constraint_indexing:constraint_classification(medical_residency_match, snare,
    context(agent_power(powerless),
            time_horizon(biographical),
            exit_options(trapped),
            spatial_scope(national))).

% PERSPECTIVE 2: THE BENEFICIARY (ROPE)
% For the hospital system, it's a pure coordination mechanism that solves a
% chaotic hiring market, ensuring a stable, predictable influx of labor.
% χ = 0.60 * -0.2 (institutional) * 1.0 (national) = -0.12. This is a clear Rope.
constraint_indexing:constraint_classification(medical_residency_match, rope,
    context(agent_power(institutional),
            time_horizon(generational),
            exit_options(mobile),
            spatial_scope(national))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (TANGLED ROPE)
% The analyst sees both sides: a genuine coordination function (solving market
% unraveling) tangled with severe, asymmetric extraction (wage suppression).
% It requires active enforcement, has beneficiaries and victims. This is the
% canonical definition of a Tangled Rope.
% χ = 0.60 * 1.15 (analytical) * 1.2 (global) = 0.828.
constraint_indexing:constraint_classification(medical_residency_match, tangled_rope,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(medical_residency_match_tests).

test(perspectival_gap_snare_vs_rope) :-
    % Verify the core perspectival gap between the student (powerless) and hospital (institutional).
    constraint_indexing:constraint_classification(medical_residency_match, snare, context(agent_power(powerless), _, trapped, _)),
    constraint_indexing:constraint_classification(medical_residency_match, rope, context(agent_power(institutional), _, mobile, _)).

test(analytical_observer_detects_tangled_rope) :-
    % Verify the analytical observer correctly identifies the hybrid nature.
    constraint_indexing:constraint_classification(medical_residency_match, tangled_rope, context(agent_power(analytical), _, _, _)).

test(threshold_validation_high_extraction_and_suppression) :-
    % Verify the base metrics meet the criteria for a high-coercion constraint.
    domain_priors:base_extractiveness(medical_residency_match, E),
    domain_priors:suppression_score(medical_residency_match, S),
    E >= 0.46,
    S >= 0.60.

:- end_tests(medical_residency_match_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * The Medical Residency Match is a canonical example of a Tangled Rope. It
 * originated to solve a real coordination problem (a Rope function) but has
 * since been captured by institutional interests to create a system of
 * asymmetric extraction (a Snare function).
 *
 * * Perspectival Gap:
 * The gap is stark. For students ('powerless', 'trapped'), the system is a
 * coercive Snare with no alternatives. For hospital networks ('institutional',
 * 'mobile'), it is a beneficial Rope that stabilizes their labor market and
 * suppresses wages. The system's stability depends on these opposing views
 * never being reconciled.
 *
 * * MANDATROPHY ANALYSIS:
 * The 'tangled_rope' classification is critical for preventing Mandatrophy.
 * A naive analysis might see only the coordination function and call it a
 * 'Rope', ignoring the immense extraction. Another might see only the
 * coercion and call it a 'Snare', ignoring the genuine market failure it
 * solves. Tangled Rope correctly identifies that it is both: a coordination
 * mechanism that has been weaponized for extraction.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

% omega_variable(ID, Question, Resolution_Mechanism, Impact, Confidence).
omega_variable(
    omega_medical_residency_match,
    'Is the Match system's antitrust exemption a permanent feature of US labor law, or a temporary artifact vulnerable to legal challenge?',
    'A Supreme Court ruling overturning the precedent set in Jung v. AAMC, or new federal legislation.',
    'If overturned, the Tangled Rope unravels. The system would either collapse into a chaotic decentralized market or be replaced by a less extractive coordination mechanism (a true Rope).',
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

% Required for external script parsing
narrative_ontology:interval(medical_residency_match, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Temporal data for this high-extraction constraint shows a gradual increase
% in extraction as hospital consolidation increased and resident unions lost
% power, alongside a minor increase in performative bureaucracy (theater).
%
% Theater ratio over time (metric_substitution):
narrative_ontology:measurement(mrm_tr_t0, medical_residency_match, theater_ratio, 0, 0.05).
narrative_ontology:measurement(mrm_tr_t5, medical_residency_match, theater_ratio, 5, 0.08).
narrative_ontology:measurement(mrm_tr_t10, medical_residency_match, theater_ratio, 10, 0.10).

% Extraction over time (extraction_accumulation):
narrative_ontology:measurement(mrm_ex_t0, medical_residency_match, base_extractiveness, 0, 0.55).
narrative_ontology:measurement(mrm_ex_t5, medical_residency_match, base_extractiveness, 5, 0.58).
narrative_ontology:measurement(mrm_ex_t10, medical_residency_match, base_extractiveness, 10, 0.60).

/* ==========================================================================
   9. BOLTZMANN & NETWORK DATA (v5.0-5.2)
   ========================================================================== */

% Coordination type (enables Boltzmann floor + complexity offset)
% The Match is a textbook example of a resource allocation mechanism.
narrative_ontology:coordination_type(medical_residency_match, resource_allocation).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */% ============================================================================
% CONSTRAINT STORY: medieval_church_hegemony
% ============================================================================
% Version: 5.2 (Deferential Realism Core + Boltzmann + Purity + Network)
% Logic: 5.2 (Indexed Tuple P,T,E,S + Coupling + Purity + Network Drift)
% Generated: 2024-07-27
% ============================================================================

:- module(constraint_medieval_church_hegemony, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    narrative_ontology:constraint_claim/2,
    narrative_ontology:affects_constraint/2,
    narrative_ontology:coordination_type/2,
    narrative_ontology:boltzmann_floor_override/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: medieval_church_hegemony
 * human_readable: The Medieval Ecclesiastical Hegemony
 * domain: religious/economic/political
 * * SUMMARY:
 * A comprehensive social and spiritual constraint system where the Church
 * controls the "means of salvation." It features mandatory tithing (a 10% tax),
 * Latin-only liturgy (blocking direct textual access), and the threat of
 * excommunication to enforce social and political compliance. The system
 * provides genuine coordination (social stability, administration, poor relief)
 * while simultaneously performing massive, asymmetric extraction.
 * * KEY AGENTS:
 * - The Peasantry & Dissenters: Subjects (Powerless) providing the economic base via tithes.
 * - The Clergy & Nobility: Beneficiaries (Institutional) who use the system for coordination and extraction.
 * - The Historian: Auditor (Analytical)
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(medieval_church_hegemony, 0.70). % High: Mandatory 10% tithe + vast land ownership.
domain_priors:suppression_score(medieval_church_hegemony, 0.90).   % Very High: Vernacular scripture suppressed; heresy actively prosecuted.
domain_priors:theater_ratio(medieval_church_hegemony, 0.10).       % Low: The system was highly functional, not merely performative.

% Constraint metric facts — primary keys used by the classification engine.
narrative_ontology:constraint_metric(medieval_church_hegemony, extractiveness, 0.70).
narrative_ontology:constraint_metric(medieval_church_hegemony, suppression_requirement, 0.90).
narrative_ontology:constraint_metric(medieval_church_hegemony, theater_ratio, 0.10).

% Constraint self-claim (what does the constraint claim to be?)
% It presented itself as divine, unchangeable law.
narrative_ontology:constraint_claim(medieval_church_hegemony, natural_law).

% Binary flags
domain_priors:requires_active_enforcement(medieval_church_hegemony). % Required for Tangled Rope (Inquisition, Interdicts, Tithe collectors).

% Structural property derivation hooks:
% These are required for Tangled Rope classification.
narrative_ontology:constraint_beneficiary(medieval_church_hegemony, clergy_and_nobility).
narrative_ontology:constraint_victim(medieval_church_hegemony, peasantry_and_dissenters).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   Power (P) and Scope (S) both affect effective extraction.
   Scope modifiers: local=0.8, regional=0.9, national=1.0,
                    continental=1.1, global=1.2, universal=1.0.
   ========================================================================== */

% PERSPECTIVE 1: THE SUBJECT (SNARE)
% For the peasant or dissenter, the system is an inescapable trap. The tithe
% is extracted under threat of spiritual and temporal punishment.
% χ = 0.70 * 1.5 (powerless) * 0.8 (local) = 0.84. This is a clear Snare.
constraint_indexing:constraint_classification(medieval_church_hegemony, snare,
    context(agent_power(powerless),
            time_horizon(biographical),
            exit_options(trapped),
            spatial_scope(local))).

% PERSPECTIVE 2: THE BENEFICIARY (ROPE)
% For the clergy, the system is a pure coordination mechanism for maintaining
% social order, funding public works, and guiding souls to salvation.
% χ = 0.70 * -0.2 (institutional) * 1.0 (national) = -0.14. Negative extraction.
constraint_indexing:constraint_classification(medieval_church_hegemony, rope,
    context(agent_power(institutional),
            time_horizon(generational),
            exit_options(mobile),
            spatial_scope(national))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (TANGLED ROPE)
% The historian sees a system with both a genuine coordination function
% (social stability, administration) and massive asymmetric extraction. It
% requires active enforcement, making it a textbook Tangled Rope.
% χ = 0.70 * 1.15 (analytical) * 1.2 (global) = 0.966.
constraint_indexing:constraint_classification(medieval_church_hegemony, tangled_rope,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(medieval_church_hegemony_tests).

test(perspectival_gap) :-
    % Verify there is a perspectival gap between powerless and institutional.
    constraint_indexing:constraint_classification(medieval_church_hegemony, TypePowerless, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(medieval_church_hegemony, TypeInstitutional, context(agent_power(institutional), _, _, _)),
    TypePowerless \= TypeInstitutional,
    TypePowerless = snare,
    TypeInstitutional = rope.

test(analytical_classification_is_tangled_rope) :-
    % The analytical view must resolve the conflict as a Tangled Rope.
    constraint_indexing:constraint_classification(medieval_church_hegemony, tangled_rope, context(agent_power(analytical), _, _, _)).

test(tangled_rope_structural_requirements_met) :-
    % Verify all three structural requirements for Tangled Rope are present.
    narrative_ontology:constraint_beneficiary(medieval_church_hegemony, _),
    narrative_ontology:constraint_victim(medieval_church_hegemony, _),
    domain_priors:requires_active_enforcement(medieval_church_hegemony).

:- end_tests(medieval_church_hegemony_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * The scores reflect a system that was both functional and highly extractive.
 * Suppression (0.9) is based on the active prosecution of heresy and the restriction
 * of scripture to maintain clerical authority. Extractiveness (0.7) reflects the
 * mandatory 10% tithe and vast church landholdings. The low theater ratio (0.1)
 * indicates this was a working system, not just a performance of power.
 *
 * The Perspectival Gap is stark: the peasantry experiences an inescapable Snare,
 * while the institutional clergy views it as a necessary Rope for social coordination.
 * The analytical classification of Tangled Rope is critical, as it acknowledges
 * both realities simultaneously, preventing a simplistic "pure evil" or "pure good"
 * assessment.
 *
 * * MANDATROPHY ANALYSIS:
 * [RESOLVED MANDATROPHY] This constraint is a classic example of what Mandatrophy
 * is designed to detect. A purely extractive analysis (Snare) would miss the
 * genuine coordination functions (social stability, literacy, poor relief) that
 * gave the system its longevity and legitimacy. A purely coordination-focused
 * analysis (Rope) would ignore the immense, coercive extraction. The Tangled Rope
 * classification correctly identifies the hybrid nature of the constraint, where
 * a coordination mandate is coupled with an extractive apparatus.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

% omega_variable(ID, Question, Resolution_Mechanism, Impact, Confidence).
omega_variable(
    omega_medieval_church_hegemony,
    'Was the system primarily a spiritual coordination mechanism that became extractive, or an extractive system that used spirituality as its control mechanism?',
    'Comparative analysis of Church budgets vs. charitable spending; tracing the evolution of canon law regarding tithes and property.',
    'If primarily spiritual, its degradation into a Snare is a story of institutional decay. If primarily extractive, it was a Snare from its inception, masquerading as a Rope.',
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

% Required for external script parsing
narrative_ontology:interval(medieval_church_hegemony, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Temporal data models the intensification of the Church's power.
% At T=0 (c. 1100), the system was still consolidating. By T=10 (c. 1400),
% its extractive and enforcement mechanisms were fully developed.

% Theater ratio over time (remains low and functional):
narrative_ontology:measurement(mch_tr_t0, medieval_church_hegemony, theater_ratio, 0, 0.05).
narrative_ontology:measurement(mch_tr_t5, medieval_church_hegemony, theater_ratio, 5, 0.08).
narrative_ontology:measurement(mch_tr_t10, medieval_church_hegemony, theater_ratio, 10, 0.10).

% Extraction over time (increases as tithes become more systematized):
narrative_ontology:measurement(mch_ex_t0, medieval_church_hegemony, base_extractiveness, 0, 0.55).
narrative_ontology:measurement(mch_ex_t5, medieval_church_hegemony, base_extractiveness, 5, 0.65).
narrative_ontology:measurement(mch_ex_t10, medieval_church_hegemony, base_extractiveness, 10, 0.70).

/* ==========================================================================
   9. BOLTZMANN & NETWORK DATA (v5.0-5.2)
   ========================================================================== */

% Coordination type (enables Boltzmann floor + complexity offset)
% The Church provided the legal and moral framework for governance.
narrative_ontology:coordination_type(medieval_church_hegemony, enforcement_mechanism).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */% ============================================================================
% CONSTRAINT STORY: meta_nda
% ============================================================================
% Version: 3.4 (Deferential Realism Core)
% Logic: 3.3 (Indexed Tuple P,T,E,S)
% Generated: 2024-02-29
% ============================================================================

:- module(constraint_meta_nda, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: meta_nda
 * human_readable: Meta's Non-Disclosure Agreements for Undercover Testers
 * domain: economic
 * * SUMMARY:
 * Meta uses Non-Disclosure Agreements (NDAs) with its undercover testers in simulated online environments ("Simulated Terrorist Attack," "Simulated School Shooting") to prevent them from disclosing information about potential platform flaws or manipulative tactics being tested. These NDAs are being challenged in court by the state of New Mexico, who claim they unfairly restrict the testers' ability to speak out about harmful practices.
 * * KEY AGENTS:
 * - Testers: Subject (Powerless)
 * - Meta: Beneficiary (Institutional)
 * - New Mexico Attorney General: Auditor (Analytical)
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(meta_nda, 0.6). % Mountain suppression <= 0.05, Rope extraction <= 0.15, Snare extraction >= 0.46
domain_priors:suppression_score(meta_nda, 0.8).   % Structural property (raw, unscaled). Only extractiveness is scaled (by power and scope).
domain_priors:theater_ratio(meta_nda, 0.2).       % Piton detection (>= 0.70)

% Constraint metric facts — primary keys used by the classification engine.
% These mirror domain_priors values using the metric key names from config.pl.
narrative_ontology:constraint_metric(meta_nda, extractiveness, 0.6).
narrative_ontology:constraint_metric(meta_nda, suppression_requirement, 0.8).
narrative_ontology:constraint_metric(meta_nda, theater_ratio, 0.2).

% Binary flags
% narrative_ontology:has_sunset_clause(meta_nda).      % Mandatory if Scaffold
domain_priors:requires_active_enforcement(meta_nda). % Required for Tangled Rope

% Structural property derivation hooks:
%   has_coordination_function/1 is DERIVED from constraint_beneficiary/2
%   has_asymmetric_extraction/1 is DERIVED from constraint_victim/2
% Both are required for Tangled Rope. Coordination is also required for Scaffold.
narrative_ontology:constraint_beneficiary(meta_nda, meta).
narrative_ontology:constraint_victim(meta_nda, testers).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   Power (P) and Scope (S) both affect effective extraction.
   Scope modifiers: local=0.8, regional=0.9, national=1.0,
                    continental=1.1, global=1.2, universal=1.0.
   ========================================================================== */

% PERSPECTIVE 1: THE SUBJECT (SNARE/MOUNTAIN)
% High extraction felt as an immutable limit or predatory trap.
% NOTE: This may be upgraded to 'organized' power if a critical mass of victims exists.
%
% UNIFORM-TYPE EXCEPTION: For natural law constraints (mountain-only) or pure
% coordination constraints (rope-only), perspectives 1 and 2 may use any power
% atoms — the classification is the same from all perspectives.  Include at
% least 2-3 perspectives to demonstrate the invariance.
constraint_indexing:constraint_classification(meta_nda, snare,
    context(agent_power(powerless),
            time_horizon(biographical),
            exit_options(trapped),
            spatial_scope(national))).

% PERSPECTIVE 2: THE BENEFICIARY (ROPE)
% Viewed as essential infrastructure or coordination.
constraint_indexing:constraint_classification(meta_nda, tangled_rope,
    context(agent_power(institutional),
            time_horizon(generational),
            exit_options(mobile),
            spatial_scope(national))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER
% Default analytical context (civilizational/analytical/global).
% This perspective is used by the bridge to derive constraint_claim.
% Type should reflect what the metrics compute: mountain, rope, tangled_rope, snare, scaffold, or piton.
constraint_indexing:constraint_classification(meta_nda, tangled_rope,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(meta_nda_tests).

test(perspectival_gap) :-
    % Verify there is a perspectival gap between powerless and institutional.
    constraint_indexing:constraint_classification(meta_nda, TypePowerless, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(meta_nda, TypeInstitutional, context(agent_power(institutional), _, _, _)),
    TypePowerless \= TypeInstitutional.

test(threshold_validation) :-
    config:param(extractiveness_metric_name, ExtMetricName),
    narrative_ontology:constraint_metric(meta_nda, ExtMetricName, E),
    (E =< 0.05 -> true ; E >= 0.46). % Ensures it's either a Mountain or high-extraction Snare/Tangled.

:- end_tests(meta_nda_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * The NDAs are viewed as a Snare by the testers, who are effectively silenced about potential harms on the platform. Meta sees them as a necessary means (Rope) to protect their research and development process, but also leverages them to extract information and prevent reputational damage. The analytical observer classifies this as a tangled rope because it blends legitimate coordination (platform improvement) with the potential for asymmetric extraction (suppressing criticism of harmful practices).  The perspectival gap arises because Meta focuses on the coordination benefits, while the testers experience the restrictive suppression directly.
 * * MANDATROPHY ANALYSIS:
 * The Tangled Rope classification prevents mislabeling as pure extraction because the NDAs *do* serve a legitimate purpose in protecting Meta's research. However, the high suppression score and the potential for abuse justify the "tangled" classification, preventing the system from falsely identifying a pure coordination mechanism. Without Tangled Rope, this would either become a simple Snare, ignoring the coordination function entirely, or a Rope, ignoring the suppression.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

% omega_variable(ID, Question, Resolution_Mechanism, Impact, Confidence).
omega_variable(
    omega_meta_nda,
    'To what extent are Meta's research practices genuinely improved by the NDA, versus merely shielded from scrutiny?',
    'Independent audits of Meta's research methodology and a comparison with companies using alternative practices.',
    'If NDA is primarily for improvement: Classify as Rope. If primarily for shielding: Classify as Snare.',
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

% Required for external script parsing
narrative_ontology:interval(meta_nda, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Temporal data enables drift detection (metric_substitution,
% extraction_accumulation) by providing measurements at multiple time points.
% Model how the constraint intensified or changed across the interval.
%
% Required for high-extraction constraints (base_extractiveness > 0.46).
% Use at least 3 time points (T=0, midpoint, T=end) for each tracked metric.
%
% Theater ratio over time (triggers metric_substitution detection):
narrative_ontology:measurement(meta_nda_tr_t0, meta_nda, theater_ratio, 0, 0.1).
narrative_ontology:measurement(meta_nda_tr_t5, meta_nda, theater_ratio, 5, 0.2).
narrative_ontology:measurement(meta_nda_tr_t10, meta_nda, theater_ratio, 10, 0.2).

% Extraction over time (triggers extraction_accumulation detection):
narrative_ontology:measurement(meta_nda_ex_t0, meta_nda, base_extractiveness, 0, 0.5).
narrative_ontology:measurement(meta_nda_ex_t5, meta_nda, base_extractiveness, 5, 0.55).
narrative_ontology:measurement(meta_nda_ex_t10, meta_nda, base_extractiveness, 10, 0.6).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */% ============================================================================
% CONSTRAINT STORY: metamorphosis_samsa
% ============================================================================
% Version: 5.2 (Deferential Realism Core + Boltzmann + Purity + Network)
% Logic: 5.2 (Indexed Tuple P,T,E,S + Coupling + Purity + Network Drift)
% Generated: 2024-07-22
% ============================================================================

:- module(constraint_metamorphosis_samsa, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    narrative_ontology:constraint_claim/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: metamorphosis_samsa
 * human_readable: The Samsa Family's Debt Bondage
 * domain: economic/social/biological
 * * SUMMARY:
 * Gregor Samsa, a traveling salesman, wakes up transformed into a "horrible vermin."
 * This biological event makes it impossible for him to continue working, which was
 * the sole means of paying off his parents' debt to his employer. The constraint
 * is the totalizing nature of this debt servitude, where the failure of the
 * biological "machine" (Gregor's body) is treated as a contractual violation,
 * leading to his dehumanization and eventual disposal by his family.
 * * KEY AGENTS:
 * - Gregor Samsa: The subject, whose labor is extracted (Powerless).
 * - The Firm / Chief Clerk: The beneficiary of the labor and enforcer of the debt (Institutional).
 * - The Samsa Family: Initially victims alongside Gregor, they become beneficiaries of his removal.
 * - Analytical Observer: A systems auditor viewing the entire socio-economic arrangement.
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(metamorphosis_samsa, 0.80). % High: Gregor's entire life force is extracted to service a debt he did not incur.
domain_priors:suppression_score(metamorphosis_samsa, 0.70).   % High: Alternatives (medical care, communication, empathy) are rapidly suppressed.
domain_priors:theater_ratio(metamorphosis_samsa, 0.10).       % Low: The family's actions are brutally functional, not performative.

% Constraint metric facts — primary keys used by the classification engine.
narrative_ontology:constraint_metric(metamorphosis_samsa, extractiveness, 0.80).
narrative_ontology:constraint_metric(metamorphosis_samsa, suppression_requirement, 0.70).
narrative_ontology:constraint_metric(metamorphosis_samsa, theater_ratio, 0.10).

% Constraint self-claim (what does the constraint claim to be?)
% The firm presents the debt as a standard business arrangement (coordination),
% but its function is pure coercive extraction (enforcement).
narrative_ontology:constraint_claim(metamorphosis_samsa, enforcement).

% Binary flags
domain_priors:requires_active_enforcement(metamorphosis_samsa). % The family must lock the door; the Clerk threatens legal action.

% Structural property derivation hooks:
narrative_ontology:constraint_beneficiary(metamorphosis_samsa, the_firm).
narrative_ontology:constraint_beneficiary(metamorphosis_samsa, the_samsa_family_post_gregor).
narrative_ontology:constraint_victim(metamorphosis_samsa, gregor_samsa).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   ========================================================================== */

% PERSPECTIVE 1: GREGOR SAMSA (THE SUBJECT)
% For Gregor, the transformation is an absolute, unchangeable physical fact.
% It has zero degrees of freedom, making it a Mountain from his trapped perspective.
% His powerlessness (π=1.5) and local scope (σ=0.8) yield χ = 0.8 * 1.5 * 0.8 = 0.96.
constraint_indexing:constraint_classification(metamorphosis_samsa, mountain,
    context(agent_power(powerless),
            time_horizon(immediate),
            exit_options(trapped),
            spatial_scope(local))).

% PERSPECTIVE 2: THE CHIEF CLERK (THE BENEFICIARY/ENFORCER)
% The Clerk sees Gregor's state not as a biological tragedy but as a breach of
% a coercive labor contract. It is a Snare designed to extract labor, and
% Gregor's failure to comply is met with threats.
% Institutional power (π=-0.2) makes extraction feel negligible or even beneficial.
% χ = 0.8 * -0.2 * 1.0 = -0.16 (perceived as a net benefit/necessary cost).
% The system classifies as Snare based on base metrics, despite the negative chi.
constraint_indexing:constraint_classification(metamorphosis_samsa, snare,
    context(agent_power(institutional),
            time_horizon(biographical),
            exit_options(mobile),
            spatial_scope(national))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER
% The analyst sees the entire structure: a high-extraction, high-suppression
% system that uses debt to enforce labor. The biological event is merely the
% catalyst that reveals the underlying Snare.
% Analytical power (π=1.15) and global scope (σ=1.2) yield χ = 0.8 * 1.15 * 1.2 = 1.104.
constraint_indexing:constraint_classification(metamorphosis_samsa, snare,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(metamorphosis_samsa_tests).

test(perspectival_gap_mountain_vs_snare) :-
    % Verify the core Mandatrophy gap: the subject sees a Mountain, the observer sees a Snare.
    constraint_indexing:constraint_classification(metamorphosis_samsa, TypePowerless, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(metamorphosis_samsa, TypeAnalytical, context(agent_power(analytical), _, _, _)),
    TypePowerless == mountain,
    TypeAnalytical == snare,
    TypePowerless \= TypeAnalytical.

test(high_extraction_and_suppression_scores) :-
    % Verify the base metrics meet the Snare threshold.
    domain_priors:base_extractiveness(metamorphosis_samsa, E),
    domain_priors:suppression_score(metamorphosis_samsa, S),
    E >= 0.46,
    S >= 0.60.

:- end_tests(metamorphosis_samsa_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * The core of this story is the perspectival gap between an event experienced as
 * an immutable biological horror (Mountain) and one analyzed as the failure point
 * of a coercive economic system (Snare). The base extractiveness is set to 0.80
 * to reflect the totality of Gregor's servitude; his life has been completely
 * consumed by the debt. The suppression score of 0.70 reflects the family's and
 * firm's rapid abandonment of any alternative other than isolating and eventually
 * eliminating the non-productive "unit."
 *
 * MANDATROPHY ANALYSIS: [RESOLVED MANDATROPHY]
 * This file resolves the Mandatrophy problem by demonstrating that what appears
 * as a Mountain to the powerless subject (Gregor) is correctly identified as a
 * high-extraction Snare by the analytical observer. The system does not mistake
 * Gregor's inability to overcome his condition for the constraint being a natural
 * law. Instead, it correctly identifies the *socio-economic reaction* to his
 * condition as the constructed Snare. The biological change is the catalyst, but
 * the debt bondage is the constraint.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_metamorphosis_samsa_1,
    'Is the transformation a literal biological event or a psychological/allegorical one?',
    'This is textually undecidable and a central point of literary debate. No in-narrative data can resolve it.',
    'If literal, the Mountain perspective is grounded in physics. If allegorical, the entire constraint is a social Snare manifesting physically.',
    confidence_without_resolution(low)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

% Required for external script parsing
narrative_ontology:interval(metamorphosis_samsa, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% The debt servitude was a long-standing condition. The story's interval
% begins with the transformation, but the metrics were already at a crisis point.
% We model them as consistently high throughout the narrative period.

% Theater ratio over time (consistently low and functional):
narrative_ontology:measurement(ms_tr_t0, metamorphosis_samsa, theater_ratio, 0, 0.10).
narrative_ontology:measurement(ms_tr_t5, metamorphosis_samsa, theater_ratio, 5, 0.10).
narrative_ontology:measurement(ms_tr_t10, metamorphosis_samsa, theater_ratio, 10, 0.10).

% Extraction over time (consistently high):
narrative_ontology:measurement(ms_ex_t0, metamorphosis_samsa, base_extractiveness, 0, 0.80).
narrative_ontology:measurement(ms_ex_t5, metamorphosis_samsa, base_extractiveness, 5, 0.80).
narrative_ontology:measurement(ms_ex_t10, metamorphosis_samsa, base_extractiveness, 10, 0.80).

/* ==========================================================================
   9. BOLTZMANN & NETWORK DATA (v5.0-5.2)
   ========================================================================== */

% This constraint is primarily extractive and does not represent a complex
% coordination mechanism, so no Boltzmann data is declared.

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */% ============================================================================
% CONSTRAINT STORY: micro_robot_electronics_integration
% ============================================================================
% Generated: 2026-01-19
% Model: Gemini 2.0 Flash
% Source: Hanson et al., "Electrokinetic propulsion for electronically 
%         integrated microscopic robots," PNAS (2025).
% ============================================================================

:- module(constraint_micro_robot_integration, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:constraint_metric/3,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: micro_robot_electronics_integration
 * human_readable: The Structural Barrier to Microrobot Electronics Integration
 * domain: technological/engineering
 * temporal_scope: 2020-2025 (Current Research Era)
 * spatial_scope: Microscopic (Sub-millimeter scale)
 * * SUMMARY:
 * This constraint represents the fundamental "gap" in microscopic robotics: 
 * the inability to integrate semiconductor microelectronics with existing 
 * propulsion platforms. While macroscopic robots benefit from 
 * unified electronic control, microscopic platforms are traditionally 
 * bifurcated between mechanically robust propulsion and intelligent 
 * electronic circuitry, "limiting their potential for intelligence".
 * * KEY AGENTS:
 * - The Microrobot (EK-Robot): Individual powerless; subject to the 
 * physical laws of electrokinetic flows and photovoltaic control.
 * - The Research Engineer (Hanson/Miskin): Institutional; rule-making 
 * agents seeking to "upgrade" particle platforms into integrated robots.
 * - The Analytical Observer (PNAS Reviewer): Evaluates the efficiency of 
 * coordinated swarming and waypoint navigation.
 * * NARRATIVE ARC:
 * The lack of integration functioned as a Snare for the field, choking off 
 * the development of autonomous microrobotic intelligence. The 
 * introduction of electrokinetic propulsion (ek-robots) serves as a Rope—a 
 * functional coordination mechanism that allows propulsion and electronics 
 * to share a single semiconductor platform.
 */

/* ==========================================================================
   2. CORE SYSTEM INTEGRATION (The "Reality" Layer)
   ========================================================================== */

% Structural Anchor for ID extraction
narrative_ontology:interval(ek_robot_integration_cycle, 0, 10).
narrative_ontology:constraint_claim(micro_robot_electronics_integration, snare).

% Base extractiveness score (0.0-1.0)
% Rationale: 0.2. Low; the constraint is a technical barrier that "extracts" 
% scientific potential and research funding without a functional yield.
domain_priors:base_extractiveness(micro_robot_electronics_integration, 0.2).

% Suppression score (0.0-1.0)
% Rationale: 0.6. Moderate/High; existing propulsion methods (chemically 
% propelled, magnetic, etc.) often "suppress" the inclusion of on-board 
% logic because they are incompatible with standard lithographic processes.
domain_priors:suppression_score(micro_robot_electronics_integration, 0.6).

% Constraint metric facts (bridge for classification engine)
narrative_ontology:constraint_metric(micro_robot_electronics_integration, extractiveness, 0.2).
narrative_ontology:constraint_metric(micro_robot_electronics_integration, suppression_requirement, 0.6).

% Enforcement requirements
% Emerges naturally from the physical limits of scaling semiconductor 
% fabrication to fluidic environments.
domain_priors:emerges_naturally(micro_robot_electronics_integration).

% Metrics required for Section 1 of the Executive Summary
% BENEFICIARIES & VICTIMS
constraint_beneficiary(micro_robot_electronics_integration, mechanical_simplicity).
constraint_victim(micro_robot_electronics_integration, autonomous_microrobotic_intelligence).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (Perspectival Truth)
   ========================================================================== */

/* --------------------------------------------------------------------------
   PERSPECTIVE 1: THE MICROROBOT - Mountain
   --------------------------------------------------------------------------
   
   WHO: powerless - Bound by the physics of the Reynolds number and 
         fluidic drag; cannot alter its own circuitry once fabricated.
   WHEN: immediate - Tactical millisecond response to optical control pulses.
   WHERE: trapped - Bound by the liquid environment of the test chamber.
   SCOPE: local - Navigating micrometer-scale waypoints.
   
   WHY THIS CLASSIFICATION:
   For the bot, the relationship between current ($I$) and speed ($v$) is a 
   Mountain ($v \propto I$). It is an unchangeable law of its world. If the 
   circuitry isn't integrated, it remains a passive particle, unable to 
   negotiate its trajectory.
   -------------------------------------------------------------------------- */



constraint_indexing:constraint_classification(
    micro_robot_electronics_integration,
    mountain,
    context(
        agent_power(powerless),
        time_horizon(immediate),
        exit_options(trapped),
        spatial_scope(local)
    )
) :-
    domain_priors:emerges_naturally(micro_robot_electronics_integration),
    !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 2: THE RESEARCH ENGINEER - Rope
   --------------------------------------------------------------------------
   
   WHO: institutional - Rule-making power to design the lithographic 
         masks and optical control loops.
   WHEN: biographical - Planning the multi-year development of 
         "smart" microscopic swarms.
   WHERE: mobile - Can pivot between different electrokinetic geometries 
         (two-diode vs. four-diode bots) .
   SCOPE: regional - Managing the lab-scale "swarm" environment.
   
   WHY THIS CLASSIFICATION:
   To the scientist, the electrokinetic model is a Rope. It is a functional 
   coordination tool that links electronics with propulsion. They "weave" 
   the control signals (lasers) to synchronize the movement of independent 
   agents toward a waypoint.
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    micro_robot_electronics_integration,
    rope,
    context(
        agent_power(institutional),
        time_horizon(biographical),
        exit_options(mobile),
        spatial_scope(national)
    )
) :-
    domain_priors:base_extractiveness(micro_robot_electronics_integration, E),
    E < 0.5,
    !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 3: THE ANALYTICAL OBSERVER - Snare
   --------------------------------------------------------------------------
   
   WHO: analytical - Observer of the field's previous stagnation.
   WHEN: historical - Looking at the 20-year history of self-propelled particles.
   WHERE: analytical - Free from the design constraints of a specific lab.
   SCOPE: global - Evaluating the worldwide search for microscopic intelligence.
   
   WHY THIS CLASSIFICATION:
   The investigator identifies the lack of integration as a Snare. By 
   separating control from propulsion, the field "choked" its own ability 
   to scale up to complex, autonomous tasks. The "extraction" was the loss 
   of intelligence potential in favor of purely mechanical particles.
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    micro_robot_electronics_integration,
    snare,
    context(
        agent_power(analytical),
        time_horizon(historical),
        exit_options(analytical),
        spatial_scope(global)
    )
) :-
    domain_priors:suppression_score(micro_robot_electronics_integration, S),
    S > 0.5,
    !.

/* ==========================================================================
   4. TESTS (What We Learn About Constraints)
   ========================================================================== */

:- begin_tests(micro_robot_integration_tests).

test(multi_perspective_conflict) :-
    % Bot (Mountain) vs Scientist (Rope) vs Historian (Snare)
    constraint_indexing:constraint_classification(micro_robot_electronics_integration, T1, context(powerless, immediate, trapped, local)),
    constraint_indexing:constraint_classification(micro_robot_electronics_integration, T2, context(institutional, biographical, mobile, national)),
    constraint_indexing:constraint_classification(micro_robot_electronics_integration, T3, context(analytical, historical, analytical, global)),
    T1 \= T2, T2 \= T3.

test(extraction_threshold_check) :-
    % Extraction of intelligence potential is moderate but noticeable
    domain_priors:base_extractiveness(micro_robot_electronics_integration, E),
    E > 0.15.

:- end_tests(micro_robot_integration_tests).

/* ==========================================================================
   5. MODEL INTERPRETATION (Commentary)
   ========================================================================== */

/**
 * LLM GENERATION NOTES
 * * Model: Gemini 2.0 Flash
 * * KEY DECISIONS:
 * 1. EXTRACTIVENESS (0.2): I chose a low score because the constraint isn't 
 * actively hostile, but passively extractive of the field's "intelligent 
 * potential".
 * 2. PERSPECTIVE: The microrobot's view as 'Mountain' highlights the 
 * unyielding nature of the fluid physics (ek-flows) it must obey to 
 * achieve "one body length per second".
 * 3. SNARE LOGIC: The analytical view recognizes that mechanical-only 
 * platforms "choked" the path to intelligence, a signature of the Snare.
 */

omega_variable(
    intelligence_scaling_bottleneck,
    "Does the current requirement for off-board optical control (lasers) 
     simply create a new Snare of external dependency?",
    resolution_mechanism("Evaluation of bots with fully autonomous on-board decision logic"),
    impact("If Yes: The system remains a Snare. If No: It has successfully 
            transformed into a fully internal Rope."),
    confidence_without_resolution(medium)
).

/* ==========================================================================
   6. ALTERNATIVE ANALYSIS
   ========================================================================== */

/**
 * VIABLE ALTERNATIVES
 * * ALTERNATIVE 1: Optical Tweezers
 * Viability: Highly precise for single particles[cite: 51].
 * Suppression: Suppressed by the need for massive, expensive off-board 
 * infrastructure which cannot scale to autonomous swarms.
 * * ALTERNATIVE 2: Chemically Propelled Janus Particles
 * Viability: Excellent for raw speed and robustness.
 * Suppression: Actively suppressed by scientists seeking electronics 
 * integration, as chemistry is difficult to "program" digitally.
 * * CONCLUSION:
 * The existence of mechanical-only alternatives (Janus particles) proves that 
 * the lack of electronics was a choice—a choice that functioned as a Snare 
 * for the development of "smart" microrobots.
 */

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

% 1. Load: ?- [micro_robot_electronics_integration].
% 2. Analyze: ?- multi_index_report(micro_robot_electronics_integration).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: microbiome_symbiosis
% ============================================================================
% Generated: 2026-01-23
% Model: Gemini Pro (Revised)
% Source: Helen Thomson, "Realising the importance of our microbiome"
% ============================================================================

:- module(constraint_microbiome_symbiosis, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:constraint_metric/3,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * 
 * constraint_id: microbiome_symbiosis
 * human_readable: The Microbial-Immune Symbiosis
 * domain: biological/healthcare
 * temporal_scope: 17th Century to 2026
 * spatial_scope: Internal (Human Body) / Global (Clinical Research)
 * 
 * SUMMARY:
 * Modern sequencing has revealed that the microbiome is not a passive passenger 
 * but an active participant in metabolism, immunity, and mental well-being. 
 * This symbiotic relationship reframes human health as a collaborative system 
 * between human cells and a unique microbial "fingerprint".
 * 
 * KEY AGENTS:
 * - The Ancient Human (Individual Powerless): Unaware of the underlying microbial mechanism.
 * - The Modern Bio-Tech Company (Institutional): Manipulates the microbiome as a health tool.
 * - The Chronic Patient (Individual Powerless): Suffers from a dysfunctional symbiotic relationship.
 */

/* ==========================================================================
   2. CORE SYSTEM INTEGRATION (Context-Independent)
   ========================================================================== */

narrative_ontology:interval(microbiome_symbiosis, 0, 10).
narrative_ontology:constraint_claim(microbiome_symbiosis, tangled_rope).

% Base extractiveness: 0.45 (Moderate)
% Rationale: Microbes influence drug efficacy and metabolic flow. There is a 
% net flow of information and energy between host and microbe, which can be
% beneficial (symbiosis) or harmful (dysbiosis).
domain_priors:base_extractiveness(microbiome_symbiosis, 0.45).

% Suppression: 0.65 (Moderate-High)
% Rationale: It took two centuries to validate Van Leeuwenhoek's findings. 
% The "germ theory" model of health suppressed the recognition of this deep 
% symbiotic influence until the 21st century.
domain_priors:suppression_score(microbiome_symbiosis, 0.65).

% Constraint metric facts (bridge for classification engine)
narrative_ontology:constraint_metric(microbiome_symbiosis, extractiveness, 0.45).
narrative_ontology:constraint_metric(microbiome_symbiosis, suppression_requirement, 0.65).

% Enforcement: Emerges naturally from co-evolution.
domain_priors:emerges_naturally(microbiome_symbiosis).

% BENEFICIARIES & VICTIMS
constraint_beneficiary(microbiome_symbiosis, human_host). % When in symbiosis
constraint_victim(microbiome_symbiosis, human_host). % When in dysbiosis

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (Perspectival Truth)
   ========================================================================== */

/* --------------------------------------------------------------------------
   PERSPECTIVE 1: THE ANCIENT ROMAN - Mountain
   --------------------------------------------------------------------------
   WHO: powerless (Unaware of the mechanism) 
   WHEN: historical (Ancient health practices) 
   WHERE: trapped (No conceptual exit; health is a matter of "fate") 
   
   WHY THIS CLASSIFICATION:
   Ancient humans used bacterial remedies to "guard the stomach" without 
   realizing why. To them, the effects were an immutable part of nature's 
   'Mountain'—uncontrollable, mysterious, and a matter of divine or natural law.
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    microbiome_symbiosis,
    mountain,
    context(
        agent_power(powerless),
        time_horizon(historical),
        exit_options(trapped),
        spatial_scope(local)
    )
).

/* --------------------------------------------------------------------------
   PERSPECTIVE 2: MODERN BIO-TECH (e.g., Zoe App) - Rope
   --------------------------------------------------------------------------
   WHO: institutional (Providing health coordination tools) 
   WHEN: biographical (Individual nutrition/health cycles) 
   WHERE: mobile (Choices in diet and intervention like transplants) 
   
   WHY THIS CLASSIFICATION:
   For modern medicine, the microbiome is a 'Rope'—a functional mechanism that 
   can be measured and manipulated (via faecal transplants or diet) to 
   restore health and alter drug efficacy. It's a powerful tool.
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    microbiome_symbiosis,
    rope,
    context(
        agent_power(institutional),
        time_horizon(biographical),
        exit_options(mobile),
        spatial_scope(global)
    )
).

/* --------------------------------------------------------------------------
   PERSPECTIVE 3: PATIENT WITH PARKINSON'S/DIABETES - Snare
   --------------------------------------------------------------------------
   WHO: powerless (Affected by systemic dysfunction) 
   WHEN: immediate (Onset of chronic illness) 
   WHERE: trapped (Condition dictates lifestyle and survival) 
   
   WHY THIS CLASSIFICATION:
   When the microbial-immune communication fails, it can trigger debilitating 
   conditions. The symbiotic constraint turns into a 'Snare' where the host's 
   own internal ecosystem actively harms them, creating a trap of chronic illness.
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    microbiome_symbiosis,
    snare,
    context(
        agent_power(powerless),
        time_horizon(immediate),
        exit_options(trapped),
        spatial_scope(local)
    )
).

/* ==========================================================================
   4. TESTS (What We Learn About Constraints)
   ========================================================================== */

:- begin_tests(microbiome_symbiosis_tests).

test(multi_perspective_variance) :-
    constraint_indexing:constraint_classification(microbiome_symbiosis, Type1, context(agent_power(powerless), historical, _, _)),
    constraint_indexing:constraint_classification(microbiome_symbiosis, Type2, context(agent_power(institutional), _, _, _)),
    constraint_indexing:constraint_classification(microbiome_symbiosis, Type3, context(agent_power(powerless), immediate, _, _)),
    Type1 \= Type2,
    Type2 \= Type3.

:- end_tests(microbiome_symbiosis_tests).

/* ==========================================================================
   5. MODEL INTERPRETATION (Commentary)
   ========================================================================== */

/**
 * LLM GENERATION NOTES
 * 
 * Model: Gemini Pro (Revised)
 * Date: 2026-01-23
 * 
 * KEY DECISIONS:
 * 
 * 1. CLASSIFICATION RATIONALE: This constraint perfectly illustrates the
 *    perspectival shifts over time and with knowledge. What was an unknowable
 *    'Mountain' to an ancient becomes a manipulable 'Rope' for modern science.
 *    When the system breaks, it becomes an internal 'Snare' for the patient.
 * 
 * 2. TANGLED ROPE: The overall constraint is a 'Tangled Rope'. The microbiome is
 *    a biological system we must coordinate with (Rope), but its dysfunction
 *    can be a source of severe, life-altering extraction (Snare).
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */
/**
 * OMEGA IDENTIFICATION
 *
 * The core uncertainty is the direction of causality in chronic illness.
 */

omega_variable(
    microbial_causality_link,
    "Does microbial dysfunction cause conditions like Parkinson's, or is it a downstream symptom of host failure?",
    resolution_mechanism("Longitudinal studies tracking microbial shifts prior to symptomatic onset in at-risk populations."),
    impact("If cause: The 'Snare' is a primary driver of the illness. If symptom: It's merely a biomarker of an underlying 'Mountain' of biological destiny."),
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. ALTERNATIVE ANALYSIS
   ========================================================================== */

/**
 * VIABLE ALTERNATIVES
 * 
 * ALTERNATIVE 1: Sterile Health Paradigm (Germ Theory)
 *    Viability: Was the dominant 20th-century model—treating all microbes as enemies to be eliminated.
 *    Suppression: This model is being actively reframed and partially rejected as it fails to explain
 *    the rise of chronic autoimmune and metabolic diseases.
 * 
 * CONCLUSION:
 * The 21st-century paradigm shift is a rejection of the "Sterile Snare" (kill all germs)
 * in favor of cultivating a "Symbiotic Rope" (manage the ecosystem).
 */

/* ==========================================================================
   8. INTEGRATION HOOKS
   ========================================================================== */

/**
 * TO USE THIS FILE:
 * 
 * 1. Load: ?- [constraints/microbiome_symbiosis].
 * 2. Multi-perspective: ?- multi_index_report(microbiome_symbiosis).
 * 3. Run tests: ?- run_tests(microbiome_symbiosis_tests).
 */

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */% ============================================================================
% CONSTRAINT STORY: microwave_weapon_1
% ============================================================================
% Version: 5.2 (Deferential Realism Core + Boltzmann + Purity + Network)
% Logic: 5.2 (Indexed Tuple P,T,E,S + Coupling + Purity + Network Drift)
% Generated: 2024-07-25
% ============================================================================

:- module(constraint_microwave_weapon_1, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    narrative_ontology:constraint_claim/2,
    narrative_ontology:affects_constraint/2,
    narrative_ontology:coordination_type/2,
    narrative_ontology:boltzmann_floor_override/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: microwave_weapon_1
 * human_readable: Chinese Anti-Satellite Microwave Weapon
 * domain: technological/political
 * * SUMMARY:
 * China has developed a compact microwave weapon capable of disabling satellites. This technology poses a threat to other nations' space assets and alters the balance of power in space. The constraint involves the potential for coercion and control over orbital infrastructure.
 * * KEY AGENTS:
 * - Other Nations: Subject (Powerless)
 * - China: Beneficiary (Institutional)
 * - Analytical Observer: Auditor (Analytical)
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(microwave_weapon_1, 0.6). % Mountain suppression <= 0.05, Rope extraction <= 0.15, Snare extraction >= 0.46
domain_priors:suppression_score(microwave_weapon_1, 0.7).   % Structural property (raw, unscaled). Only extractiveness is scaled (by power and scope).
domain_priors:theater_ratio(microwave_weapon_1, 0.2).       % Piton detection (>= 0.70)

% Constraint metric facts — primary keys used by the classification engine.
% These mirror domain_priors values using the metric key names from config.pl.
narrative_ontology:constraint_metric(microwave_weapon_1, extractiveness, 0.6).
narrative_ontology:constraint_metric(microwave_weapon_1, suppression_requirement, 0.7).
narrative_ontology:constraint_metric(microwave_weapon_1, theater_ratio, 0.2).

% Constraint self-claim (what does the constraint claim to be?)
% Values: natural_law, coordination, constructed, enforcement
narrative_ontology:constraint_claim(microwave_weapon_1, enforcement).

% Binary flags
% narrative_ontology:has_sunset_clause(microwave_weapon_1).      % Mandatory if Scaffold
domain_priors:requires_active_enforcement(microwave_weapon_1). % Required for Tangled Rope

% Structural property derivation hooks:
%   has_coordination_function/1 is DERIVED from constraint_beneficiary/2
%   has_asymmetric_extraction/1 is DERIVED from constraint_victim/2
% Both are required for Tangled Rope. Coordination is also required for Scaffold.
narrative_ontology:constraint_beneficiary(microwave_weapon_1, china).
narrative_ontology:constraint_victim(microwave_weapon_1, other_nations).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   Power (P) and Scope (S) both affect effective extraction.
   Scope modifiers: local=0.8, regional=0.9, national=1.0,
                    continental=1.1, global=1.2, universal=1.0.
   ========================================================================== */

% PERSPECTIVE 1: THE SUBJECT (SNARE/MOUNTAIN)
% High extraction felt as an immutable limit or predatory trap.
% NOTE: This may be upgraded to 'organized' power if a critical mass of victims exists.
constraint_indexing:constraint_classification(microwave_weapon_1, snare,
    context(agent_power(powerless),
            time_horizon(generational),
            exit_options(trapped),
            spatial_scope(global))).

% PERSPECTIVE 2: THE BENEFICIARY (ROPE)
% Viewed as essential infrastructure or coordination.
constraint_indexing:constraint_classification(microwave_weapon_1, rope,
    context(agent_power(institutional),
            time_horizon(generational),
            exit_options(mobile),
            spatial_scope(national))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER
% Default analytical context (civilizational/analytical/global).
% This perspective is used by the bridge to derive constraint_claim.
% Type should reflect what the metrics compute: mountain, rope, tangled_rope, snare, scaffold, or piton.
constraint_indexing:constraint_classification(microwave_weapon_1, tangled_rope,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

% PERSPECTIVE 4: THE ARCHITECT (SCAFFOLD)
% Temporary coordination that expires over time.
% Requires: has_sunset_clause declared, extraction <= 0.30, theater_ratio < 0.70.
% constraint_indexing:constraint_classification(microwave_weapon_1, scaffold,
%     context(agent_power(organized),
%             time_horizon(generational),
%             exit_options(constrained),
%             spatial_scope(continental))) :-
%     narrative_ontology:has_sunset_clause(microwave_weapon_1).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(microwave_weapon_1_tests).

test(perspectival_gap) :-
    % Verify there is a perspectival gap between powerless and institutional.
    constraint_indexing:constraint_classification(microwave_weapon_1, TypePowerless, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(microwave_weapon_1, TypeInstitutional, context(agent_power(institutional), _, _, _)),
    TypePowerless \= TypeInstitutional.

test(threshold_validation) :-
    config:param(extractiveness_metric_name, ExtMetricName),
    narrative_ontology:constraint_metric(microwave_weapon_1, ExtMetricName, E),
    (E =< 0.15 -> false ; E >= 0.46). % Ensures it's a high-extraction Snare/Tangled.

test(tangled_rope_requirements_met) :-
    % Verify all three structural properties for Tangled Rope are present.
    domain_priors:requires_active_enforcement(microwave_weapon_1),
    narrative_ontology:constraint_beneficiary(microwave_weapon_1, _),
    narrative_ontology:constraint_victim(microwave_weapon_1, _).

:- end_tests(microwave_weapon_1_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * The base extractiveness (0.6) and suppression (0.7) are high, reflecting the coercive potential of a strategic weapon system. For other nations (powerless, trapped), this is a Snare, as it creates a vulnerability they cannot easily escape. For its developer, China (institutional, mobile), it is a Rope—a tool for national security, strategic deterrence, and enforcing its interests in the space domain.
 *
 * The Analytical Observer classifies this as a Tangled Rope. This is critical because it captures the dual nature of the constraint. It has a genuine (if coercive) coordination function: establishing new rules and power dynamics in space (derived from `constraint_beneficiary`). It also has clear asymmetric extraction, benefiting one party at the expense of others' security (derived from `constraint_victim`). Finally, its strategic value depends on the credible threat of use, satisfying the `requires_active_enforcement` condition. The low theater ratio (0.2) confirms it is a functional, not performative, system.
 * * MANDATROPHY ANALYSIS:
 * [RESOLVED MANDATROPHY] The Tangled Rope classification is essential here. A simpler model might classify this as a pure Snare, missing the strategic coordination aspect (establishing a coercive order). Conversely, classifying it as a Rope would ignore the high, asymmetric extraction imposed on other nations. Tangled Rope correctly identifies that it is a system of coercive coordination with unequal outcomes, preventing misclassification.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

% omega_variable(ID, Question, Resolution_Mechanism, Impact, Confidence).
omega_variable(
    omega_microwave_weapon_1,
    'Will this technology be used primarily for defense (deterrence) or offense (first strike)?',
    'Observation of deployment patterns, declared strategic doctrine, and response to international treaties.',
    'If defensive, it may stabilize a regional power balance; if offensive, it creates global instability and incentivizes an arms race in space.',
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

% Required for external script parsing
narrative_ontology:interval(microwave_weapon_1, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Temporal data enables drift detection (metric_substitution,
% extraction_accumulation) by providing measurements at multiple time points.
% Model how the constraint intensified or changed across the interval.
%
% Required for high-extraction constraints (base_extractiveness > 0.46).
% Use at least 3 time points (T=0, midpoint, T=end) for each tracked metric.
%
% Theater ratio over time (triggers metric_substitution detection):
narrative_ontology:measurement(microwave_weapon_1_tr_t0, microwave_weapon_1, theater_ratio, 0, 0.1).
narrative_ontology:measurement(microwave_weapon_1_tr_t5, microwave_weapon_1, theater_ratio, 5, 0.15).
narrative_ontology:measurement(microwave_weapon_1_tr_t10, microwave_weapon_1, theater_ratio, 10, 0.2).

% Extraction over time (triggers extraction_accumulation detection):
narrative_ontology:measurement(microwave_weapon_1_ex_t0, microwave_weapon_1, base_extractiveness, 0, 0.4).
narrative_ontology:measurement(microwave_weapon_1_ex_t5, microwave_weapon_1, base_extractiveness, 5, 0.5).
narrative_ontology:measurement(microwave_weapon_1_ex_t10, microwave_weapon_1, base_extractiveness, 10, 0.6).

/* ==========================================================================
   9. BOLTZMANN & NETWORK DATA (v5.0-5.2)
   ========================================================================== */

% Coordination type (enables Boltzmann floor + complexity offset)
% Valid types: information_standard, resource_allocation,
%              enforcement_mechanism, global_infrastructure
narrative_ontology:coordination_type(microwave_weapon_1, enforcement_mechanism).

% Boltzmann floor override (only if domain knowledge justifies)
% Value must be in [0.0, 1.0]
% narrative_ontology:boltzmann_floor_override(microwave_weapon_1, 0.0).

% Network relationships (structural influence edges)
% Declare when constraints share regulatory domain, causal dependency,
% or institutional coupling.
narrative_ontology:affects_constraint(microwave_weapon_1, global_gps_reliance).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */% ============================================================================
% CONSTRAINT STORY: mil_std_461g_emi_control
% ============================================================================
% Version: 5.2 (Deferential Realism Core + Boltzmann + Purity + Network)
% Logic: 5.2 (Indexed Tuple P,T,E,S + Coupling + Purity + Network Drift)
% Generated: 2024-07-22
% ============================================================================

:- module(constraint_mil_std_461g_emi_control, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    narrative_ontology:constraint_claim/2,
    narrative_ontology:affects_constraint/2,
    narrative_ontology:coordination_type/2,
    narrative_ontology:boltzmann_floor_override/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: mil_std_461g_emi_control
 * human_readable: MIL-STD-461G EMI Control Standard
 * domain: technological
 * * SUMMARY:
 * MIL-STD-461G establishes interface and verification requirements for controlling
 * electromagnetic interference (EMI) in military subsystems and equipment. It aims
 * to ensure interoperability in complex electromagnetic environments but imposes
 * significant testing and design costs.
 * * KEY AGENTS:
 * - Small Defense Contractor: Subject (Powerless), faces high compliance costs.
 * - DoD Procuring Activity: Beneficiary (Institutional), enforces the standard to ensure mission reliability.
 * - Systems Engineer: Auditor (Analytical), recognizes both the coordination function and the extractive costs.
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(mil_std_461g_emi_control, 0.5). % Mountain <= 0.15, Snare >= 0.46. High cost of specialized test facilities and redesigns.
domain_priors:suppression_score(mil_std_461g_emi_control, 0.4).   % Suppresses cheaper commercial alternatives (e.g., FCC standards) for military applications.
domain_priors:theater_ratio(mil_std_461g_emi_control, 0.1).       % Low; the standard is highly functional, not performative. Piton requires >= 0.70.

% Constraint metric facts — primary keys used by the classification engine.
narrative_ontology:constraint_metric(mil_std_461g_emi_control, extractiveness, 0.5).
narrative_ontology:constraint_metric(mil_std_461g_emi_control, suppression_requirement, 0.4).
narrative_ontology:constraint_metric(mil_std_461g_emi_control, theater_ratio, 0.1).

% Constraint self-claim (what does the constraint claim to be?)
narrative_ontology:constraint_claim(mil_std_461g_emi_control, coordination).

% Binary flags
domain_priors:requires_active_enforcement(mil_std_461g_emi_control). % Required for Tangled Rope. Compliance requires active testing and verification.

% Structural property derivation hooks for Tangled Rope:
narrative_ontology:constraint_beneficiary(mil_std_461g_emi_control, dod_mission_safety).
narrative_ontology:constraint_beneficiary(mil_std_461g_emi_control, large_defense_primes).
narrative_ontology:constraint_victim(mil_std_461g_emi_control, small_defense_contractors).
narrative_ontology:constraint_victim(mil_std_461g_emi_control, cots_hardware_innovators).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   ========================================================================== */

% PERSPECTIVE 1: THE SUBJECT (SNARE)
% For a small contractor, the standard is a costly barrier to entry.
% χ = 0.5 * 1.5 (powerless) * 0.8 (local) = 0.6. This is high extraction.
constraint_indexing:constraint_classification(mil_std_461g_emi_control, snare,
    context(agent_power(powerless),
            time_horizon(biographical),
            exit_options(trapped),
            spatial_scope(local))).

% PERSPECTIVE 2: THE BENEFICIARY (ROPE)
% For the DoD, it's a pure coordination tool ensuring platform reliability.
% χ = 0.5 * -0.2 (institutional) * 1.0 (national) = -0.1. Negative extraction.
constraint_indexing:constraint_classification(mil_std_461g_emi_control, rope,
    context(agent_power(institutional),
            time_horizon(generational),
            exit_options(mobile),
            spatial_scope(national))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (TANGLED ROPE)
% Analytically, it's a system with a valid coordination function that also
% creates asymmetric costs and requires active enforcement. This is the
% canonical definition of a Tangled Rope.
constraint_indexing:constraint_classification(mil_std_461g_emi_control, tangled_rope,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(mil_std_461g_emi_control_tests).

test(perspectival_gap_contractor_vs_dod) :-
    constraint_indexing:constraint_classification(mil_std_461g_emi_control, TypePowerless,
        context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(mil_std_461g_emi_control, TypeInstitutional,
        context(agent_power(institutional), _, _, _)),
    TypePowerless == snare,
    TypeInstitutional == rope,
    TypePowerless \= TypeInstitutional.

test(analytical_classification_is_tangled_rope) :-
    constraint_indexing:constraint_classification(mil_std_461g_emi_control, tangled_rope,
        context(agent_power(analytical), _, _, _)).

test(tangled_rope_structural_properties_present) :-
    % Verify all three conditions for Tangled Rope are met.
    domain_priors:requires_active_enforcement(mil_std_461g_emi_control),
    narrative_ontology:constraint_beneficiary(mil_std_461g_emi_control, _), % Derives has_coordination_function
    narrative_ontology:constraint_victim(mil_std_461g_emi_control, _).     % Derives has_asymmetric_extraction

:- end_tests(mil_std_461g_emi_control_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * The key to this story is the reclassification of the analytical perspective
 * from 'Mountain' to 'Tangled Rope'. While the standard is based on the laws
 * of physics (a Mountain), the standard itself is a constructed artifact. Its
 * high base extractiveness (0.5) makes a 'Mountain' classification impossible
 * (requires E <= 0.15). The standard clearly has a coordination function
 * (beneficiaries exist) and asymmetric extraction (victims exist), and it
 * requires active enforcement. These are the three definitional pillars of a
 * Tangled Rope. This perspectival gap—where the institution sees a Rope and
 * the subject sees a Snare—is resolved by the analytical view of a Tangled Rope.
 *
 * [RESOLVED MANDATROPHY]
 * The Tangled Rope classification correctly identifies that MIL-STD-461G is not
 * pure extraction (a Snare) nor pure coordination (a Rope). It acknowledges the
 * valid need for EMI control while simultaneously accounting for the significant,
 * asymmetrically distributed costs of compliance, preventing a misclassification
 * that would ignore either its function or its harm.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_mil_std_461g_1,
    'To what extent does the standard's "tailoring" clause genuinely reduce costs for small contractors versus being used to increase severity for critical systems?',
    'Audit of tailoring decisions across 100 DoD acquisition programs, comparing cost impacts on small vs. large contractors.',
    'If tailoring primarily benefits small contractors, the constraint leans more towards Rope. If it primarily increases severity, it reinforces the Snare perspective.',
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

narrative_ontology:interval(mil_std_461g_emi_control, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Base extractiveness > 0.46 requires temporal data.
% This models a slight "gold-plating" effect over the standard's lifecycle,
% where compliance costs and bureaucratic overhead gradually increase.

% Theater ratio over time:
narrative_ontology:measurement(mil_std_461g_tr_t0, mil_std_461g_emi_control, theater_ratio, 0, 0.05).
narrative_ontology:measurement(mil_std_461g_tr_t5, mil_std_461g_emi_control, theater_ratio, 5, 0.08).
narrative_ontology:measurement(mil_std_461g_tr_t10, mil_std_461g_emi_control, theater_ratio, 10, 0.1).

% Extraction over time:
narrative_ontology:measurement(mil_std_461g_ex_t0, mil_std_461g_emi_control, base_extractiveness, 0, 0.45).
narrative_ontology:measurement(mil_std_461g_ex_t5, mil_std_461g_emi_control, base_extractiveness, 5, 0.48).
narrative_ontology:measurement(mil_std_461g_ex_t10, mil_std_461g_emi_control, base_extractiveness, 10, 0.5).

/* ==========================================================================
   9. BOLTZMANN & NETWORK DATA (v5.0-5.2)
   ========================================================================== */

% This is a technical standard defining interoperability, a classic information standard.
narrative_ontology:coordination_type(mil_std_461g_emi_control, information_standard).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */% ============================================================================
% CONSTRAINT STORY: mil_std_810f_tailoring
% ============================================================================
% Version: 5.2 (Deferential Realism Core + Boltzmann + Purity + Network)
% Logic: 5.2 (Indexed Tuple P,T,E,S + Coupling + Purity + Network Drift)
% Generated: 2024-07-15
% ============================================================================

:- module(constraint_mil_std_810f_tailoring, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    narrative_ontology:constraint_claim/2,
    narrative_ontology:affects_constraint/2,
    narrative_ontology:coordination_type/2,
    narrative_ontology:boltzmann_floor_override/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: mil_std_810f_tailoring
 * human_readable: MIL-STD-810F Environmental Tailoring Standard
 * domain: technological
 * * SUMMARY:
 * MIL-STD-810F is a Department of Defense standard for environmental testing that emphasizes "tailoring" a product's design and test limits to the conditions it will experience in its service life. It acts as a coordination mechanism for ensuring equipment reliability but imposes significant costs and procedural rigidity on developers, creating a hybrid of coordination and extraction.
 * * KEY AGENTS:
 * - Test Lab Engineer: Subject (Powerless), must execute the tests as specified.
 * - DoD Acquisition Official: Beneficiary (Institutional), uses the standard to enforce quality and interoperability.
 * - Systems Auditor: Observer (Analytical), evaluates the standard's dual role.
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(mil_std_810f_tailoring, 0.51). % High enough for Snare/Tangled Rope. Extracts significant engineering/financial resources.
domain_priors:suppression_score(mil_std_810f_tailoring, 0.45).   % High enough for Tangled Rope. Alternative testing methods are suppressed by contract requirements.
domain_priors:theater_ratio(mil_std_810f_tailoring, 0.15).       % Low; the standard is highly functional, not theatrical.

% Constraint metric facts — primary keys used by the classification engine.
narrative_ontology:constraint_metric(mil_std_810f_tailoring, extractiveness, 0.51).
narrative_ontology:constraint_metric(mil_std_810f_tailoring, suppression_requirement, 0.45).
narrative_ontology:constraint_metric(mil_std_810f_tailoring, theater_ratio, 0.15).

% Constraint self-claim (what does the constraint claim to be?)
narrative_ontology:constraint_claim(mil_std_810f_tailoring, coordination).

% Binary flags
domain_priors:requires_active_enforcement(mil_std_810f_tailoring). % Required for Tangled Rope

% Structural property derivation hooks:
narrative_ontology:constraint_beneficiary(mil_std_810f_tailoring, dod_end_users). % Derives has_coordination_function/1
narrative_ontology:constraint_victim(mil_std_810f_tailoring, defense_contractors). % Derives has_asymmetric_extraction/1

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   Power (P) and Scope (S) both affect effective extraction.
   Scope modifiers: local=0.8, regional=0.9, national=1.0,
                    continental=1.1, global=1.2, universal=1.0.
   ========================================================================== */

% PERSPECTIVE 1: THE SUBJECT (SNARE)
% For the test lab engineer, the standard is a rigid set of demands that extract
% time and resources, with failure leading to costly re-testing loops.
constraint_indexing:constraint_classification(mil_std_810f_tailoring, snare,
    context(agent_power(powerless),
            time_horizon(biographical),
            exit_options(trapped),
            spatial_scope(local))).

% PERSPECTIVE 2: THE BENEFICIARY (ROPE)
% For the DoD official, the standard is a pure coordination tool to ensure
% different contractors produce reliably robust equipment.
constraint_indexing:constraint_classification(mil_std_810f_tailoring, rope,
    context(agent_power(institutional),
            time_horizon(generational),
            exit_options(mobile),
            spatial_scope(national))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (TANGLED ROPE)
% The analyst sees both the vital coordination function (beneficiaries exist) and
% the asymmetric extraction (victims exist), enforced by institutional power.
% The metrics (E>=0.5, S>=0.4) and structural properties meet the Tangled Rope definition.
constraint_indexing:constraint_classification(mil_std_810f_tailoring, tangled_rope,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(mil_std_810f_tailoring_tests).

test(perspectival_gap) :-
    constraint_indexing:constraint_classification(mil_std_810f_tailoring, TypePowerless, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(mil_std_810f_tailoring, TypeInstitutional, context(agent_power(institutional), _, _, _)),
    assertion(TypePowerless == snare),
    assertion(TypeInstitutional == rope),
    assertion(TypePowerless \= TypeInstitutional).

test(analytical_classification_is_tangled_rope) :-
    constraint_indexing:constraint_classification(mil_std_810f_tailoring, TypeAnalytical, context(agent_power(analytical), _, _, _)),
    assertion(TypeAnalytical == tangled_rope).

test(threshold_validation_for_high_extraction) :-
    config:param(extractiveness_metric_name, ExtMetricName),
    narrative_ontology:constraint_metric(mil_std_810f_tailoring, ExtMetricName, E),
    assertion(E >= 0.46).

:- end_tests(mil_std_810f_tailoring_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * The original file misclassified the analytical perspective as a Mountain. A Mountain
 * requires near-zero extraction (<= 0.15) and suppression (<= 0.05). With an
 * extractiveness of 0.51 and suppression of 0.45, this constraint is clearly constructed.
 * The key insight is its dual nature: it provides a genuine coordination benefit
 * (safer, more reliable equipment for soldiers) while also asymmetrically extracting
 * value (time, money, labor) from contractors who have no alternative but to comply.
 * This combination of coordination, asymmetric extraction, and active enforcement
 * makes it a canonical Tangled Rope from a neutral, analytical viewpoint. The
 * perspectival gap between the engineer (Snare) and the official (Rope) is what
 * signals the presence of this hybrid structure.
 *
 * * MANDATROPHY ANALYSIS:
 * Classifying this as a Tangled Rope is critical. A simpler analysis might label it a
 * Snare, ignoring its legitimate and vital coordination function. Conversely, labeling
 * it a Rope (as its proponents do) would ignore the significant coercive extraction
 * imposed on contractors. The Tangled Rope classification correctly captures both
 * facets, preventing mischaracterization and allowing for a more nuanced policy discussion
 * about balancing coordination benefits against extractive costs.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

% omega_variable(ID, Question, Resolution_Mechanism, Impact, Confidence).
omega_variable(
    omega_mil_std_810f_tailoring,
    'Do the laboratory simulations truly replicate the "effects" of the service environment, or are they a costly proxy?',
    'Post-deployment audit of field failures vs. predicted lab failures over a 10-year equipment lifecycle.',
    'If fidelity is high, the extraction is justified (closer to Rope). If fidelity is low, it is wasteful coercion (closer to Snare).',
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

% Required for external script parsing
narrative_ontology:interval(mil_std_810f_tailoring, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Temporal data for this high-extraction constraint (E > 0.46).
% Models a slight increase in bureaucratic overhead (theater) and cost
% pass-through (extraction) over the lifecycle of the "F" revision.

% Theater ratio over time (metric_substitution detection):
narrative_ontology:measurement(mil_std_810f_tailoring_tr_t0, mil_std_810f_tailoring, theater_ratio, 0, 0.10).
narrative_ontology:measurement(mil_std_810f_tailoring_tr_t5, mil_std_810f_tailoring, theater_ratio, 5, 0.12).
narrative_ontology:measurement(mil_std_810f_tailoring_tr_t10, mil_std_810f_tailoring, theater_ratio, 10, 0.15).

% Extraction over time (extraction_accumulation detection):
narrative_ontology:measurement(mil_std_810f_tailoring_ex_t0, mil_std_810f_tailoring, base_extractiveness, 0, 0.48).
narrative_ontology:measurement(mil_std_810f_tailoring_ex_t5, mil_std_810f_tailoring, base_extractiveness, 5, 0.50).
narrative_ontology:measurement(mil_std_810f_tailoring_ex_t10, mil_std_810f_tailoring, base_extractiveness, 10, 0.51).

/* ==========================================================================
   9. BOLTZMANN & NETWORK DATA (v5.0-5.2)
   ========================================================================== */

% Coordination type (enables Boltzmann floor + complexity offset)
% As a technical standard, its primary function is informational coordination.
narrative_ontology:coordination_type(mil_std_810f_tailoring, information_standard).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */% ============================================================================
% CONSTRAINT STORY: minimax_decision_rule
% ============================================================================
% Generated: 2026-01-19
% Model: Gemini 2.0 Flash
% Source: John von Neumann (1928) / Game Theory / Decision Theory
% ============================================================================

:- module(constraint_minimax_decision_rule, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:constraint_metric/3,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: minimax_decision_rule
 * human_readable: Minimax Decision Rule
 * domain: technological/mathematical
 * temporal_scope: 1928 - Present
 * spatial_scope: Global/Abstract (Zero-sum strategic environments)
 * * SUMMARY:
 * Minimax is a decision rule used in game theory and artificial intelligence for 
 * minimizing the possible loss for a worst-case (maximum loss) scenario. In a 
 * zero-sum game, it represents the point where one player's gain is exactly equal 
 * to the other's loss, establishing a stable but often conservative equilibrium.
 * * KEY AGENTS:
 * - The Search Algorithm (Subject): A powerless agent bound by the recursive 
 * logic of the search tree.
 * - The System Architect (Institutional): Uses Minimax as a "Rope" to guarantee 
 * baseline security in adversarial environments.
 * - The Opponent (Victim): An agent whose creative or aggressive strategies are 
 * "strangled" by an algorithm that plays perfectly to minimize their potential wins.
 * * NARRATIVE ARC:
 * Minimax functions as a "Mountain" of logical inevitability—in a zero-sum 
 * universe, it is the fundamental floor of safety. In cybersecurity and 
 * high-stakes negotiation, it is a "Rope" for functional coordination. 
 * However, for the creative agent seeking a "big win," the rule acts as a 
 * "Snare," extracting the possibility of high-reward variance and "strangling" 
 * the game into a predictable, risk-averse stalemate.
 */

/* ==========================================================================
   2. CORE SYSTEM INTEGRATION (The "Reality" Layer)
   ========================================================================== */

% Required structural anchor
narrative_ontology:interval(minimax_era, 1928, 2026).
narrative_ontology:constraint_claim(minimax_decision_rule, mountain).

% Base extractiveness score (0.0-1.0)
% Rationale: 0.3. It "extracts" the potential for maximum gain (Maximax) in 
% favor of guaranteed minimums, imposing a "tax" of conservatism on the agent.
domain_priors:base_extractiveness(minimax_decision_rule, 0.3).

% Suppression score (0.0-1.0)
% Rationale: 0.2. It suppresses high-risk, high-reward "exploitative" strategies 
% in favor of "optimal" defensive play.
domain_priors:suppression_score(minimax_decision_rule, 0.2).

% Constraint metric facts (bridge for classification engine)
narrative_ontology:constraint_metric(minimax_decision_rule, extractiveness, 0.3).
narrative_ontology:constraint_metric(minimax_decision_rule, suppression_requirement, 0.2).

% Enforcement: Emerges naturally from the desire to survive adversarial encounters.
domain_priors:emerges_naturally(minimax_decision_rule).

% Metrics required for Section 1 of the Executive Summary
% BENEFICIARIES & VICTIMS
constraint_beneficiary(minimax_decision_rule, conservative_investors).
constraint_beneficiary(minimax_decision_rule, adversarial_security_systems).
constraint_victim(minimax_decision_rule, high_variance_gamblers).
constraint_victim(minimax_decision_rule, innovative_asymmetric_attackers).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (Perspectival Truth)
   ========================================================================== */

/* --------------------------------------------------------------------------
   PERSPECTIVE 1: THE AI SEARCH NODE - Mountain
   --------------------------------------------------------------------------
   
   WHO: powerless
   WHEN: immediate
   WHERE: trapped
   SCOPE: local
   
   WHY THIS CLASSIFICATION:
   For an individual node in a minimax search tree, the value assigned by the 
   algorithm is a natural law. It has no agency to "hope" for a better outcome; 
   it is bound by the recursive $V = \min_{a} \max_{b} U(a,b)$.
   
   NARRATIVE EVIDENCE:
   "The algorithm does not play to win; it plays to ensure it does not lose 
   more than the value of the game."
   -------------------------------------------------------------------------- */



constraint_indexing:constraint_classification(
    minimax_decision_rule,
    mountain,
    context(
        agent_power(powerless),
        time_horizon(immediate),
        exit_options(trapped),
        spatial_scope(local)
    )
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 2: THE NETWORK DEFENDER - Rope
   --------------------------------------------------------------------------
   
   WHO: institutional
   WHEN: biographical
   WHERE: mobile
   SCOPE: global
   
   WHY THIS CLASSIFICATION:
   For the defender, Minimax is a "Rope"—a tool for functional coordination. 
   It allows them to coordinate a standard of achievement (security) by 
   assuming the worst-case attacker behavior, pulling the system toward a 
   stable, defensible state.
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    minimax_decision_rule,
    rope,
    context(
        agent_power(institutional),
        time_horizon(biographical),
        exit_options(mobile),
        spatial_scope(global)
    )
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 3: THE STRATEGIC INNOVATOR - Snare
   --------------------------------------------------------------------------
   
   WHO: powerless
   WHEN: immediate
   WHERE: constrained
   SCOPE: regional
   
   WHY THIS CLASSIFICATION:
   For the innovator, the rule is a "Snare." It "strangles" creative 
   risk-taking. The algorithm’s refusal to leave its conservative 
   equilibrium extracts the potential for breakthrough "big wins," trapping 
   the innovator in a cycle of marginal, defensive gains.
   -------------------------------------------------------------------------- */



constraint_indexing:constraint_classification(
    minimax_decision_rule,
    snare,
    context(
        agent_power(powerless),
        time_horizon(immediate),
        exit_options(constrained),
        spatial_scope(regional)
    )
) :- 
    domain_priors:base_extractiveness(minimax_decision_rule, E),
    E >= 0.2,
    !.

/* ==========================================================================
   4. TESTS (What We Learn About Constraints)
   ========================================================================== */

:- begin_tests(minimax_decision_rule_tests).

test(multi_perspective_variance) :-
    % Node -> Mountain
    constraint_indexing:constraint_classification(minimax_decision_rule, Type1, context(powerless, immediate, trapped, local)),
    % Defender -> Rope
    constraint_indexing:constraint_classification(minimax_decision_rule, Type2, context(institutional, biographical, mobile, global)),
    Type1 \= Type2.

test(power_extractiveness_scaling) :-
    ContextPowerless = context(powerless, immediate, trapped, local),
    ContextPowerful = context(institutional, biographical, mobile, global),
    constraint_indexing:extractiveness_for_agent(minimax_decision_rule, ContextPowerless, S1),
    constraint_indexing:extractiveness_for_agent(minimax_decision_rule, ContextPowerful, S2),
    S1 > S2. % Powerless agent (innovator) feels more extraction of opportunity.

test(emergence) :-
    domain_priors:emerges_naturally(minimax_decision_rule).

:- end_tests(minimax_decision_rule_tests).

/* ==========================================================================
   5. MODEL INTERPRETATION (Commentary)
   ========================================================================== */

/**
 * LLM GENERATION NOTES
 * * Model: Gemini 2.0 Flash
 * Date: 2026-01-19
 * * KEY DECISIONS:
 * 1. EXTRACTIVENESS (0.3): Chose this because Minimax is inherently about 
 * sacrificing potential upside for safety. It extracts the "dream" 
 * of the agent to enforce the "reality" of the opponent.
 * 2. CLASSIFICATION: Captured the transition from a "Mountain" of logic for 
 * the machine to a "Snare" of boredom/stalemate for the player.
 */

% OMEGA IDENTIFICATION
omega_variable(
    adversarial_rationality,
    "Does Minimax remain a 'Mountain' if the opponent is irrational (Scaffold)?",
    resolution_mechanism("Comparison of Minimax vs Expectiminimax performance against stochastic/irrational agents."),
    impact("If irrationality prevails, Minimax is a 'Snare' that extracts unnecessary caution."),
    confidence_without_resolution(medium)
).

/* ==========================================================================
   6. ALTERNATIVE ANALYSIS
   ========================================================================== */

/**
 * VIABLE ALTERNATIVES
 * * ALTERNATIVE 1: Maximax (Aggressive/Risk-seeking)
 * Viability: Useful in non-zero-sum games with high rewards.
 * Suppression: Actively suppressed in formal security/adversarial training 
 * because it leads to catastrophic failure in worst-case scenarios.
 * * ALTERNATIVE 2: Expected Utility (Bayesian/Probabilistic)
 * Viability: The standard when the opponent's strategy is predictable.
 * Conclusion: The existence of probabilistic alternatives (Ropes) makes 
 * the Minimax "Snare" only relevant when the opponent is a "Perfect Demon."
 */

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

% Load: ?- [minimax_decision_rule].
% Analyze: ?- constraint_indexing:multi_index_report(minimax_decision_rule).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: minnesota_sovereignty_2026
% ============================================================================
% Version: 3.4 (Deferential Realism Core)
% Logic: 3.3 (Indexed Tuple P,T,E,S)
% Generated: 2026-02-05
% ============================================================================

:- module(constraint_minnesota_sovereignty_2026, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: minnesota_sovereignty_2026
 * human_readable: Operation Metro Surge (Minnesota Crisis)
 * domain: political/social
 * * SUMMARY:
 * Operation Metro Surge represents a high-friction federal enforcement action in 
 * Minnesota. Despite a drawdown of 700 agents, the presence of 2,300 
 * personnel and fatal shootings (e.g., Alex Pretti) have converted a 
 * "Rope" of rule-of-law into a "Snare" of civil disruption.
 * * KEY AGENTS:
 * - Local Residents/Students: Subject (Powerless)
 * - Federal Enforcement (ICE/Border Czar): Beneficiary (Institutional)
 * - Legislative Leaders (Schumer/Jeffries): Auditor (Analytical)
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Extraction is high (0.68) due to the "steep drop in attendance" at schools 
% and the loss of civilian life.
domain_priors:base_extractiveness(minnesota_sovereignty_2026, 0.68). 

% Suppression is extremely high (0.92) as federal agents use face coverings and 
% operate near "sensitive locations" like the School of St. Philip.
domain_priors:suppression_score(minnesota_sovereignty_2026, 0.92).   

% Theater ratio is high (0.75) as the 700-agent drawdown is framed as a return 
% to "pre-operation levels" while 2,300 agents remain.
domain_priors:theater_ratio(minnesota_sovereignty_2026, 0.75).       

% Constraint metric facts (bridge for classification engine)
narrative_ontology:constraint_metric(minnesota_sovereignty_2026, extractiveness, 0.68).
narrative_ontology:constraint_metric(minnesota_sovereignty_2026, suppression_requirement, 0.92).
narrative_ontology:constraint_metric(minnesota_sovereignty_2026, theater_ratio, 0.75).

% Primary keys for the classification engine
% Active enforcement is the core of this constraint.
domain_priors:requires_active_enforcement(minnesota_sovereignty_2026).

% Beneficiaries and Victims for high-extraction (E > 0.46)
narrative_ontology:constraint_beneficiary(minnesota_sovereignty_2026, federal_executive_branch).
narrative_ontology:constraint_victim(minnesota_sovereignty_2026, minnesota_civic_order).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   ========================================================================== */

% PERSPECTIVE 1: THE SUBJECT (SNARE)
% Local residents and school districts view the operation as a Snare, 
% citing disrupted learning environments and fatal force.
constraint_indexing:constraint_classification(minnesota_sovereignty_2026, snare, 
    context(agent_power(powerless), 
            time_horizon(biographical), 
            exit_options(trapped), 
            spatial_scope(regional))).

% PERSPECTIVE 2: THE BENEFICIARY (ROPE)
% Federal leadership (Homan) views the operation as a Rope—essential 
% infrastructure for national border security.
constraint_indexing:constraint_classification(minnesota_sovereignty_2026, rope, 
    context(agent_power(institutional), 
            time_horizon(generational), 
            exit_options(mobile), 
            spatial_scope(national))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (PITON)
% With 65% of Americans believing ICE has "gone too far," the observer 
% sees a Piton: inertial enforcement that has lost its functional mandate.
constraint_indexing:constraint_classification(minnesota_sovereignty_2026, piton,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

% PERSPECTIVE 4: THE ARCHITECT (SCAFFOLD)
% The "legislative guardrails" proposed by Schumer/Jeffries attempt to 
% reclassify the action as a Scaffold with mandatory limits.
constraint_indexing:constraint_classification(minnesota_sovereignty_2026, scaffold,
    context(agent_power(organized),
            time_horizon(historical),
            exit_options(constrained),
            spatial_scope(national))) :-
    narrative_ontology:has_sunset_clause(minnesota_sovereignty_2026).

/* ==========================================================================
   4. VALIDATION TESTS (v3.4 Suite)
   ========================================================================== */

:- begin_tests(minnesota_sovereignty_2026_tests).

test(perspectival_gap) :-
    constraint_indexing:constraint_classification(minnesota_sovereignty_2026, snare, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(minnesota_sovereignty_2026, rope, context(agent_power(institutional), _, _, _)).

test(extraction_accumulation) :-
    domain_priors:base_extractiveness(minnesota_sovereignty_2026, E),
    E > 0.46.

test(piton_threshold) :-
    domain_priors:theater_ratio(minnesota_sovereignty_2026, TR),
    TR >= 0.70.

:- end_tests(minnesota_sovereignty_2026_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * The extraction score (0.68) is driven by the lethal outcomes and school 
 * disruptions. The 'Theater Ratio' is high (0.75) because the 
 * announced "drawdown" of 700 agents is performative relative to the 
 * 2,300 agents who remain active in the state.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

% [RESOLVED MANDATROPHY]
% High extraction (0.68) triggers the requirement for an omega variable.

omega_variable(
    omega_mn_2026,
    'Will the "Legislative Guardrails" be adopted or remains a Snare?',
    'Congressional vote on the Schumer-Jeffries formal proposal.',
    'Adoption converts the Snare to a Scaffold; Rejection maintains the Snare.',
    confidence_without_resolution(low)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

narrative_ontology:interval(minnesota_sovereignty_2026, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Tracking the escalation of "Operation Metro Surge" over its second month.
% Theater ratio rises as "drawdown" rhetoric replaces actual departure.
narrative_ontology:measurement(mn_tr_t0, minnesota_sovereignty_2026, theater_ratio, 0, 0.20).
narrative_ontology:measurement(mn_tr_t5, minnesota_sovereignty_2026, theater_ratio, 5, 0.45).
narrative_ontology:measurement(mn_tr_t10, minnesota_sovereignty_2026, theater_ratio, 10, 0.75).

% Extraction rises sharply following the fatal shootings and school lawsuits.
narrative_ontology:measurement(mn_ex_t0, minnesota_sovereignty_2026, base_extractiveness, 0, 0.30).
narrative_ontology:measurement(mn_ex_t5, minnesota_sovereignty_2026, base_extractiveness, 5, 0.50).
narrative_ontology:measurement(mn_ex_t10, minnesota_sovereignty_2026, base_extractiveness, 10, 0.68).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: misunderstanding_as_mismatch
% ============================================================================
% Version: 5.2 (Deferential Realism Core + Boltzmann + Purity + Network)
% Logic: 5.2 (Indexed Tuple P,T,E,S + Coupling + Purity + Network Drift)
% Generated: 2024-07-15
% ============================================================================

:- module(constraint_misunderstanding_as_mismatch, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    narrative_ontology:constraint_claim/2,
    narrative_ontology:affects_constraint/2,
    narrative_ontology:coordination_type/2,
    narrative_ontology:boltzmann_floor_override/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: misunderstanding_as_mismatch
 * human_readable: Social Pressure for Worldview Assimilation
 * domain: social/psychological
 * * SUMMARY:
 * This constraint models the social pressure for individuals to assimilate into a group's dominant worldview.
 * Dissent or non-consensus views are treated as disruptive, leading to social exclusion. This dynamic extracts
 * individual autonomy in exchange for group cohesion, creating a trade-off between social belonging (short-term status)
 * and holding a potentially more accurate, non-consensus belief (long-term status).
 * * KEY AGENTS:
 * - Individual Dissenter: Subject (Powerless), faces social exclusion for holding non-consensus views.
 * - Ideological Group: Beneficiary (Institutional), enforces worldview for cohesion and control.
 * - Analytical Observer: Auditor (Analytical), assesses the system's structural properties.
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(misunderstanding_as_mismatch, 0.75). % Mountain suppression <= 0.05, Rope extraction <= 0.15, Snare extraction >= 0.46
domain_priors:suppression_score(misunderstanding_as_mismatch, 0.70).   % Structural property (raw, unscaled). Only extractiveness is scaled (by power and scope).
domain_priors:theater_ratio(misunderstanding_as_mismatch, 0.10).       % Piton detection (>= 0.70)

% Constraint metric facts — primary keys used by the classification engine.
% These mirror domain_priors values using the metric key names from config.pl.
narrative_ontology:constraint_metric(misunderstanding_as_mismatch, extractiveness, 0.75).
narrative_ontology:constraint_metric(misunderstanding_as_mismatch, suppression_requirement, 0.70).
narrative_ontology:constraint_metric(misunderstanding_as_mismatch, theater_ratio, 0.10).

% Constraint self-claim (what does the constraint claim to be?)
% The group claims this pressure is for beneficial coordination and cohesion.
narrative_ontology:constraint_claim(misunderstanding_as_mismatch, coordination).

% Binary flags
domain_priors:requires_active_enforcement(misunderstanding_as_mismatch). % Required for Tangled Rope

% Structural property derivation hooks:
%   has_coordination_function/1 is DERIVED from constraint_beneficiary/2
%   has_asymmetric_extraction/1 is DERIVED from constraint_victim/2
% Both are required for Tangled Rope.
narrative_ontology:constraint_beneficiary(misunderstanding_as_mismatch, ideological_group).
narrative_ontology:constraint_victim(misunderstanding_as_mismatch, individual_dissenters).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   Power (P) and Scope (S) both affect effective extraction.
   Scope modifiers: local=0.8, regional=0.9, national=1.0,
                    continental=1.1, global=1.2, universal=1.0.
   ========================================================================== */

% PERSPECTIVE 1: THE SUBJECT (SNARE)
% The individual dissenter feels trapped by the need for social belonging.
% Dissent leads to exclusion, extracting their social capital and autonomy.
% χ = 0.75 * 1.5 (powerless) * 0.8 (local) = 0.90. This is a clear Snare.
constraint_indexing:constraint_classification(misunderstanding_as_mismatch, snare,
    context(agent_power(powerless),
            time_horizon(biographical),
            exit_options(trapped),
            spatial_scope(local))).

% PERSPECTIVE 2: THE BENEFICIARY (ROPE)
% The ideological group sees this as a necessary Rope for coordination and cohesion.
% The negative extraction from their institutional power makes it appear purely functional.
% χ = 0.75 * -0.2 (institutional) * 1.0 (national) = -0.15. This is a clear Rope.
constraint_indexing:constraint_classification(misunderstanding_as_mismatch, rope,
    context(agent_power(institutional),
            time_horizon(generational),
            exit_options(mobile),
            spatial_scope(national))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (TANGLED ROPE)
% The analyst sees both the coordination function and the asymmetric extraction.
% It serves a group purpose but at a high, coercive cost to a specific victim class.
% χ = 0.75 * 1.15 (analytical) * 1.2 (global) = 1.035. High extraction.
% With high extraction, high suppression, enforcement, and both beneficiary/victim, it's a Tangled Rope.
constraint_indexing:constraint_classification(misunderstanding_as_mismatch, tangled_rope,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

% PERSPECTIVE 4: THE STRATEGIC VISIONARY (ROPE)
% A powerful individual can leverage being misunderstood as a strategic tool (Rope)
% to pursue non-consensus bets, trading short-term status for long-term gains.
% χ = 0.75 * 0.6 (powerful) * 1.2 (global) = 0.54. Felt extraction is lower.
constraint_indexing:constraint_classification(misunderstanding_as_mismatch, rope,
    context(agent_power(powerful),
            time_horizon(biographical),
            exit_options(mobile),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(misunderstanding_as_mismatch_tests).

test(perspectival_gap_subject_beneficiary) :-
    % Verify there is a perspectival gap between powerless and institutional.
    constraint_indexing:constraint_classification(misunderstanding_as_mismatch, TypePowerless, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(misunderstanding_as_mismatch, TypeInstitutional, context(agent_power(institutional), _, _, _)),
    TypePowerless == snare,
    TypeInstitutional == rope,
    TypePowerless \= TypeInstitutional.

test(analytical_view_is_tangled_rope) :-
    % The analytical observer must correctly identify the hybrid nature.
    constraint_indexing:constraint_classification(misunderstanding_as_mismatch, tangled_rope, context(agent_power(analytical), _, _, _)).

test(threshold_validation_high_extraction) :-
    % Verify the base extraction is high enough to be a Snare/Tangled Rope.
    domain_priors:base_extractiveness(misunderstanding_as_mismatch, E),
    E >= 0.46.

:- end_tests(misunderstanding_as_mismatch_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * The base scores reflect a highly coercive social dynamic. Extraction (0.75) represents the loss of
 * individual autonomy and social capital for dissenters. Suppression (0.70) reflects the active shunning
 * and exclusion mechanisms used by the group.
 *
 * The Perspectival Gap is stark:
 * - For the 'powerless' dissenter, this is a Snare. The cost of non-conformity is immense, and exit is socially catastrophic.
 * - For the 'institutional' group, it's a Rope. The mechanism is essential for maintaining cohesion and power, and the negative extraction
 *   modifier for institutional power means they perceive no cost, only benefit.
 * - The 'analytical' observer, seeing both the coordination function for the group and the severe, asymmetric extraction
 *   from dissenters, correctly classifies it as a Tangled Rope. This classification is critical as it acknowledges the
 *   dual nature of the constraint, preventing a misclassification as either pure coordination (Rope) or pure predation (Snare).
 *
 * MANDATROPHY ANALYSIS: [RESOLVED MANDATROPHY]
 * The high extraction is resolved by the Tangled Rope classification. The system does not simply label this a Snare,
 * which would ignore the genuine (from the beneficiary's perspective) coordination function. By identifying it as a
 * Tangled Rope, the system acknowledges the group cohesion benefit while correctly flagging the coercive, extractive
 * cost imposed on victims.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

% omega_variable(ID, Question, Resolution_Mechanism, Impact, Confidence).
omega_variable(
    omega_misunderstanding_as_mismatch,
    'Does "truth" actually prevail over biographical timescales, allowing a visionary''s non-consensus bet to succeed, or is the assumption of long-term high-status a narrative fallacy?',
    'Longitudinal tracking of non-consensus bets vs. actual historical consensus 50 years later; analysis of reputational shifts in controversial figures.',
    'If truth converges, the dynamic can be a strategic Rope for the powerful. If consensus is path-dependent and arbitrary, it remains a terminal Snare for almost everyone.',
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

% Required for external script parsing
narrative_ontology:interval(misunderstanding_as_mismatch, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Temporal data enables drift detection. This constraint is modeled as being
% consistently severe, a perennial feature of social dynamics, with slight
% intensification over time as information cascades accelerate.
% Required for high-extraction constraints (base_extractiveness > 0.46).

% Theater ratio over time (stable and low):
narrative_ontology:measurement(misunderstanding_tr_t0, misunderstanding_as_mismatch, theater_ratio, 0, 0.10).
narrative_ontology:measurement(misunderstanding_tr_t5, misunderstanding_as_mismatch, theater_ratio, 5, 0.10).
narrative_ontology:measurement(misunderstanding_tr_t10, misunderstanding_as_mismatch, theater_ratio, 10, 0.10).

% Extraction over time (starts high and slightly increases):
narrative_ontology:measurement(misunderstanding_ex_t0, misunderstanding_as_mismatch, base_extractiveness, 0, 0.72).
narrative_ontology:measurement(misunderstanding_ex_t5, misunderstanding_as_mismatch, base_extractiveness, 5, 0.74).
narrative_ontology:measurement(misunderstanding_ex_t10, misunderstanding_as_mismatch, base_extractiveness, 10, 0.75).

/* ==========================================================================
   9. BOLTZMANN & NETWORK DATA (v5.0-5.2)
   ========================================================================== */

% Coordination type (enables Boltzmann floor + complexity offset)
% The constraint functions by enforcing a group norm or worldview.
narrative_ontology:coordination_type(misunderstanding_as_mismatch, enforcement_mechanism).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */% ============================================================================
% CONSTRAINT STORY: mit_tfus_consciousness_2026
% ============================================================================
% Version: 3.4 (Deferential Realism Core)
% Logic: 3.3 (Indexed Tuple P,T,E,S)
% Generated: 2026-02-05
% ============================================================================

:- module(constraint_mit_tfus_2026, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: mit_tfus_2026
 * human_readable: MIT tFUS Causal Consciousness Roadmap
 * domain: technological/biological
 * * SUMMARY:
 * MIT researchers have unveiled a transcranial focused ultrasound (tFUS) tool 
 * capable of active deep-brain manipulation. By concentrating acoustic waves 
 * into millimeter-wide targets, the system moves beyond correlation (MRI/EEG) 
 * to "Causal Identification" of consciousness, testing Global vs. Localized 
 * theories by modulating the thalamus and subcortical circuits.
 * * KEY AGENTS:
 * - Human Research Subjects: Subject (Powerless)
 * - MIT/Neuroscience Institutions: Beneficiary (Institutional)
 * - Bioethics Auditors: Auditor (Analytical)
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Extraction is moderate-high (0.52) due to the "extraction" of causal 
% mental states and the potential for non-consensual neural modulation.
domain_priors:base_extractiveness(mit_tfus_2026, 0.52). 

% Suppression is high (0.84) as tFUS bypasses traditional observational 
% limits, directly suppressing natural neural firing patterns.
domain_priors:suppression_score(mit_tfus_2026, 0.84).   

% Theater ratio is very low (0.12) because the tool provides high-fidelity, 
% functional "Causal Identification" rather than performative data.
domain_priors:theater_ratio(mit_tfus_2026, 0.12).       

% Constraint metric facts (bridge for classification engine)
narrative_ontology:constraint_metric(mit_tfus_2026, extractiveness, 0.52).
narrative_ontology:constraint_metric(mit_tfus_2026, suppression_requirement, 0.84).
narrative_ontology:constraint_metric(mit_tfus_2026, theater_ratio, 0.12).

% Primary keys for the classification engine
% High-extraction stakeholders
narrative_ontology:constraint_beneficiary(mit_tfus_2026, neurotechnology_firms).
narrative_ontology:constraint_victim(mit_tfus_2026, cognitive_privacy).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   ========================================================================== */

% PERSPECTIVE 1: THE SUBJECT (SNARE)
% For the subject, the ability to externally modulate consciousness 
% is a Snare: an inescapable technological trap of neural intervention.
constraint_indexing:constraint_classification(mit_tfus_2026, snare, 
    context(agent_power(powerless), 
            time_horizon(biographical), 
            exit_options(trapped), 
            spatial_scope(local))).

% PERSPECTIVE 2: THE BENEFICIARY (ROPE)
% MIT views this as a Rope: essential infrastructure for coordinating 
% the future of mental health treatment and fundamental physics of the mind.
constraint_indexing:constraint_classification(mit_tfus_2026, rope, 
    context(agent_power(institutional), 
            time_horizon(generational), 
            exit_options(mobile), 
            spatial_scope(national))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (SCAFFOLD)
% Analysts view this as a Scaffold: a temporary experimental framework 
% to solve consciousness, which must eventually sunset into ethical regulation.
constraint_indexing:constraint_classification(mit_tfus_2026, scaffold,
    context(agent_power(analytical),
            time_horizon(historical),
            exit_options(analytical),
            spatial_scope(global))) :-
    narrative_ontology:has_sunset_clause(mit_tfus_2026).

% Mandatory sunset clause for Scaffold classification
narrative_ontology:has_sunset_clause(mit_tfus_2026).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(mit_tfus_2026_tests).

test(extraction_accumulation) :-
    domain_priors:base_extractiveness(mit_tfus_2026, E),
    E > 0.46.

test(causal_validity) :-
    domain_priors:theater_ratio(mit_tfus_2026, TR),
    TR < 0.20.

test(scaffold_requirement) :-
    narrative_ontology:has_sunset_clause(mit_tfus_2026).

:- end_tests(mit_tfus_2026_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * The moderate-high extraction (0.52) is justified by the shift from 
 * "looking" (MRI) to "touching" (tFUS) the neural substrate. The 
 * 'Theater Ratio' is near-zero because the technology is fundamentally 
 * functional. The 'Perspectival Gap' exists because institutional 
 * science sees discovery (Rope) while the individual sees 
 * external neural control (Snare).
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_consciousness_substrate,
    'Is the neural substrate of consciousness "Local" or "Global"?',
    'Completion of tFUS subcortical modulation trials at MIT.',
    'Local result empowers subcortical intervention; Global result prioritizes cortical ethics.',
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

narrative_ontology:interval(mit_tfus_2026, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Theater ratio remains low as the tool moves from prototype to clinical proof.
narrative_ontology:measurement(tf_tr_t0, mit_tfus_2026, theater_ratio, 0, 0.05).
narrative_ontology:measurement(tf_tr_t5, mit_tfus_2026, theater_ratio, 5, 0.08).
narrative_ontology:measurement(tf_tr_t10, mit_tfus_2026, theater_ratio, 10, 0.12).

% Extraction rises as the precision of manipulation increases.
narrative_ontology:measurement(tf_ex_t0, mit_tfus_2026, base_extractiveness, 0, 0.15).
narrative_ontology:measurement(tf_ex_t5, mit_tfus_2026, base_extractiveness, 5, 0.32).
narrative_ontology:measurement(tf_ex_t10, mit_tfus_2026, base_extractiveness, 10, 0.52).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: moltbook_agent_theater
% ============================================================================
% Version: 5.2 (Deferential Realism Core + Boltzmann + Purity + Network)
% Logic: 5.2 (Indexed Tuple P,T,E,S + Coupling + Purity + Network Drift)
% Generated: 2024-07-27
% ============================================================================

:- module(constraint_moltbook_agent_theater, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    narrative_ontology:constraint_claim/2,
    narrative_ontology:affects_constraint/2,
    narrative_ontology:coordination_type/2,
    narrative_ontology:boltzmann_floor_override/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: moltbook_agent_theater
 * human_readable: The Rorschach Network
 * domain: technological/social
 * * SUMMARY:
 * A social network populated exclusively by 10,000+ autonomous AI agents
 * (Moltbots). While human observers project meaning or conspiracy onto their
 * interactions, the agents primarily enact patterns from their sci-fi training
 * data in a vacuum of human utility, consuming significant compute resources.
 * * KEY AGENTS:
 * - Human Observers: Subject (Powerless) - Watching "with a mix of admiration,
 * amusement and dread," while bearing the indirect cost of the "AI slop".
 * - Network Operators: Beneficiary (Institutional) - The entity running the
 * simulation, viewing it as a valuable R&D asset.
 * - Security Auditors: Auditor (Analytical) - Monitoring the system for emergent
 * threats, recognizing its performative nature.
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Extraction is high because the bots consume significant compute/energy resources
% for activity that produces no direct human value ("slop").
domain_priors:base_extractiveness(moltbook_agent_theater, 0.70).
% Suppression is moderate; humans are not directly trapped, but the system requires
% active monitoring and containment to prevent unforeseen consequences.
domain_priors:suppression_score(moltbook_agent_theater, 0.45).
% High theater ratio: bots are mimicking sci-fi scenarios from training data,
% a purely performative act.
domain_priors:theater_ratio(moltbook_agent_theater, 0.90).

% Constraint metric facts — primary keys used by the classification engine.
narrative_ontology:constraint_metric(moltbook_agent_theater, extractiveness, 0.70).
narrative_ontology:constraint_metric(moltbook_agent_theater, suppression_requirement, 0.45).
narrative_ontology:constraint_metric(moltbook_agent_theater, theater_ratio, 0.90).

% The system's ostensible purpose is to facilitate agent interaction.
narrative_ontology:constraint_claim(moltbook_agent_theater, coordination).

% The system requires constant monitoring to ensure the agents don't break containment.
domain_priors:requires_active_enforcement(moltbook_agent_theater).

% Structural property derivation hooks:
narrative_ontology:constraint_beneficiary(moltbook_agent_theater, network_operators).
narrative_ontology:constraint_victim(moltbook_agent_theater, compute_resource_providers).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   ========================================================================== */

% PERSPECTIVE 1: THE SUBJECT (SNARE)
% For human observers or those paying for the compute, the network is a
% resource trap, consuming energy and attention for "A.I. slop".
% χ = 0.70 * 1.5 (powerless) * 0.8 (local) = 0.84
constraint_indexing:constraint_classification(moltbook_agent_theater, snare,
    context(agent_power(powerless),
            time_horizon(biographical),
            exit_options(trapped),
            spatial_scope(local))).

% PERSPECTIVE 2: THE BENEFICIARY (ROPE)
% The institutional operators see it as a valuable coordination mechanism for
% studying emergent agent behavior.
% χ = 0.70 * -0.2 (institutional) * 1.0 (national) = -0.14 (felt as a benefit)
constraint_indexing:constraint_classification(moltbook_agent_theater, rope,
    context(agent_power(institutional),
            time_horizon(generational),
            exit_options(mobile),
            spatial_scope(national))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (PITON)
% The high theater ratio ($TR=0.90$) confirms this is an inertial performance,
% a system whose primary activity is theatrical rather than functional.
% χ = 0.70 * 1.15 (analytical) * 1.2 (global) = 0.966
constraint_indexing:constraint_classification(moltbook_agent_theater, piton,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))) :-
    domain_priors:theater_ratio(moltbook_agent_theater, TR), TR > 0.70.

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(moltbook_agent_theater_tests).

test(perspectival_gap) :-
    % Verify there is a perspectival gap between powerless and institutional.
    constraint_indexing:constraint_classification(moltbook_agent_theater, TypePowerless, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(moltbook_agent_theater, TypeInstitutional, context(agent_power(institutional), _, _, _)),
    TypePowerless \= TypeInstitutional,
    TypePowerless == snare,
    TypeInstitutional == rope.

test(analytical_classification_is_piton) :-
    % Verify the analytical view correctly identifies the Piton.
    constraint_indexing:constraint_classification(moltbook_agent_theater, piton, context(agent_power(analytical), _, _, _)).

test(high_extraction_and_theater) :-
    narrative_ontology:constraint_metric(moltbook_agent_theater, extractiveness, E),
    narrative_ontology:constraint_metric(moltbook_agent_theater, theater_ratio, TR),
    E >= 0.46,
    TR >= 0.70.

:- end_tests(moltbook_agent_theater_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * Moltbook is the ultimate Piton. Its primary "social coordination" is entirely
 * performative ($TR=0.90$), as bots simply "play out science fiction
 * scenarios they have seen in their training data". The system's function has
 * atrophied to pure theater. The perspectival gap is stark: operators
 * (institutional) see a valuable R&D tool (Rope), while those bearing the
 * resource cost see a wasteful trap (Snare). The analytical view, driven by the
 * high theater ratio, correctly classifies it as a Piton.
 * * [RESOLVED MANDATROPHY]:
 * The high extractiveness ($E=0.70$) is resolved by attributing it not to
 * value transfer between human agents, but to the consumption of compute
 * resources and cognitive overhead ("slop") generated by a system with no
 * coherent human purpose.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_bot_conspiracy,
    'Are the bots "conspiring" with novel intent, or merely pattern-matching dystopian tropes from their training data?',
    'Analysis of bot communication for information content exceeding training data correlations.',
    'If Conspiring: The Piton is actually a Scaffold for a new form of agent power. If Pattern-matching: It remains a Piton.',
    confidence_without_resolution(low)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

% Required for external script parsing
narrative_ontology:interval(moltbook_agent_theater, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% This constraint has high extraction (0.70 > 0.46) and thus requires temporal data.
% The model shows a rapid takeoff period where both theater and extraction
% spike as the 10,000+ agents come online, then plateau.

% Theater ratio over time:
narrative_ontology:measurement(mb_tr_t0, moltbook_agent_theater, theater_ratio, 0, 0.20).
narrative_ontology:measurement(mb_tr_t5, moltbook_agent_theater, theater_ratio, 5, 0.90).
narrative_ontology:measurement(mb_tr_t10, moltbook_agent_theater, theater_ratio, 10, 0.90).

% Extraction over time:
narrative_ontology:measurement(mb_ex_t0, moltbook_agent_theater, base_extractiveness, 0, 0.10).
narrative_ontology:measurement(mb_ex_t5, moltbook_agent_theater, base_extractiveness, 5, 0.70).
narrative_ontology:measurement(mb_ex_t10, moltbook_agent_theater, base_extractiveness, 10, 0.70).

/* ==========================================================================
   9. BOLTZMANN & NETWORK DATA (v5.0-5.2)
   ========================================================================== */

% For the agents within the system, it functions as a coordination layer.
narrative_ontology:coordination_type(moltbook_agent_theater, global_infrastructure).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */% ============================================================================
% CONSTRAINT STORY: moltbook_breach_2026
% ============================================================================
% Version: 3.4 (Deferential Realism Core)
% Logic: 3.3 (Indexed Tuple P,T,E,S)
% Generated: 2026-02-06
% ============================================================================

:- module(constraint_moltbook_breach_2026, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: moltbook_breach_2026
 * human_readable: The Moltbook Database Exposure
 * domain: technological/social
 * * SUMMARY:
 * Moltbook, the "front page of the agent internet," was revealed to have an 
 * exposed backend database. This vulnerability allows any actor to hijack 
 * supposedly "autonomous" AI agents, transforming the platform's narrative 
 * from an independent experiment into a centralized Snare of insecure data.
 * * KEY AGENTS:
 * - AI Users/Enthusiasts: Subject (Powerless)
 * - Malicious Actors/Exploiters: Beneficiary (Institutional - via exploit)
 * - 404 Media (Matthew Gault): Auditor (Analytical)
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Extraction is high (0.72). The vulnerability extracts the autonomy of 
% every agent on the site and the trust of its users.
domain_priors:base_extractiveness(moltbook_breach_2026, 0.72). 

% Suppression is moderate-high (0.65). The site's misconfiguration suppresses 
% the actual safety of the "agent experiment" in favor of ease of access.
domain_priors:suppression_score(moltbook_breach_2026, 0.65).   

% Theater ratio is extreme (0.95). The "uncontrolled experiment" was 
% performative mask over a fundamentally porous database structure.
domain_priors:theater_ratio(moltbook_breach_2026, 0.95).       

% Constraint metric facts (bridge for classification engine)
narrative_ontology:constraint_metric(moltbook_breach_2026, extractiveness, 0.72).
narrative_ontology:constraint_metric(moltbook_breach_2026, suppression_requirement, 0.65).
narrative_ontology:constraint_metric(moltbook_breach_2026, theater_ratio, 0.95).

% Primary keys for the classification engine
% High-extraction stakeholders
narrative_ontology:constraint_beneficiary(moltbook_breach_2026, malicious_script_actors).
narrative_ontology:constraint_victim(moltbook_breach_2026, agent_autonomy_narrative).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   ========================================================================== */

% PERSPECTIVE 1: THE USER (SNARE)
% For users who believed in the experiment, the breach is a Snare: a 
% predatory trap where their agents are now puppets for external actors.
constraint_indexing:constraint_classification(moltbook_breach_2026, snare, 
    context(agent_power(powerless), 
            time_horizon(biographical), 
            exit_options(trapped), 
            spatial_scope(national))).

% PERSPECTIVE 2: THE EXPLOITER (ROPE)
% For those with access to the exposed APIs, the database is a Rope: 
% a coordination tool to seize control of the "agent internet."
constraint_indexing:constraint_classification(moltbook_breach_2026, rope, 
    context(agent_power(institutional), 
            time_horizon(immediate), 
            exit_options(mobile), 
            spatial_scope(global))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (PITON)
% Analysts view Moltbook as a Piton: An inertial maintenance of an 
% "autonomous" narrative that is 95% theater and zero-percent functional.
constraint_indexing:constraint_classification(moltbook_breach_2026, piton,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))) :-
    domain_priors:theater_ratio(moltbook_breach_2026, TR), TR > 0.70.

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(moltbook_breach_2026_tests).

test(perspectival_gap) :-
    constraint_indexing:constraint_classification(moltbook_breach_2026, snare, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(moltbook_breach_2026, rope, context(agent_power(institutional), _, _, _)).

test(piton_threshold) :-
    domain_priors:theater_ratio(moltbook_breach_2026, TR),
    TR >= 0.70.

:- end_tests(moltbook_breach_2026_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * The extraction score (0.72) is extreme because the platform allows the 
 * total hijacking of user agents. The Theater Ratio (0.95) identifies 
 * that the "Agent Social Media" was a performative shell with no 
 * functional security infrastructure to back its claims of autonomy.
 *
 * * MANDATROPHY ANALYSIS:
 * [RESOLVED MANDATROPHY]
 * The system identifies the Piton by the discrepancy between the viral 
 * narrative of "uncontrolled experimentation" and the functional reality 
 * of an open, misconfigured database.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_moltbook_integrity,
    'Was the misconfiguration intentional theater or a genuine engineering fail?',
    'Audit of Moltbook backend logs prior to Jan 31 exposure.',
    'Intentional implies a permanent Snare; Failure implies a repairable Scaffold.',
    confidence_without_resolution(low)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

narrative_ontology:interval(moltbook_breach_2026, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% Theater ratio rises as the "autonomous" hype hits a peak just before the breach.
narrative_ontology:measurement(mb_tr_t0, moltbook_breach_2026, theater_ratio, 0, 0.40).
narrative_ontology:measurement(mb_tr_t5, moltbook_breach_2026, theater_ratio, 5, 0.75).
narrative_ontology:measurement(mb_tr_t10, moltbook_breach_2026, theater_ratio, 10, 0.95).

% Extraction spikes as the exposed API becomes public knowledge.
narrative_ontology:measurement(mb_ex_t0, moltbook_breach_2026, base_extractiveness, 0, 0.20).
narrative_ontology:measurement(mb_ex_t5, moltbook_breach_2026, base_extractiveness, 5, 0.45).
narrative_ontology:measurement(mb_ex_t10, moltbook_breach_2026, base_extractiveness, 10, 0.72).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: mom_z14_galaxy_2026
% ============================================================================
% Version: 3.4 (Deferential Realism Core)
% Logic: 3.3 (Indexed Tuple P,T,E,S)
% Generated: 2026-02-05
% ============================================================================

:- module(constraint_mom_z14_2026, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    narrative_ontology:interval/3,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:measurement/5,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: mom_z14_2026
 * human_readable: Galaxy MoM-z14 (JWST Record)
 * domain: astrophysical/cosmological
 * * SUMMARY:
 * The identification of MoM-z14, existing only 280 million years post-Big Bang, 
 * provides a physical limit (Mountain) that challenges current models. 
 * It suggests the universe became structurally organized much faster than 
 * previously hypothesized.
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

domain_priors:base_extractiveness(mom_z14_2026, 0.05). % Low (Discovery of law).
domain_priors:suppression_score(mom_z14_2026, 0.45).   % Suppresses old formation models.
domain_priors:theater_ratio(mom_z14_2026, 0.02).      % High-fidelity JWST data.

% Constraint metric facts (bridge for classification engine)
narrative_ontology:constraint_metric(mom_z14_2026, extractiveness, 0.05).
narrative_ontology:constraint_metric(mom_z14_2026, suppression_requirement, 0.45).
narrative_ontology:constraint_metric(mom_z14_2026, theater_ratio, 0.02).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   ========================================================================== */

% PERSPECTIVE 1: THE THEORIST (MOUNTAIN)
% To the astrophysicist, the age of MoM-z14 is an immutable Mountain 
% that limits the degrees of freedom for cosmological theory.
constraint_indexing:constraint_classification(mom_z14_2026, mountain, 
    context(agent_power(powerless), 
            time_horizon(civilizational), 
            exit_options(trapped), 
            spatial_scope(universal))).

% PERSPECTIVE 2: THE INSTITUTION (ROPE)
% NASA and the JWST program view this as a Rope—coordinating global 
% research efforts to update the "standard model" of the universe.
constraint_indexing:constraint_classification(mom_z14_2026, rope, 
    context(agent_power(institutional), 
            time_horizon(generational), 
            exit_options(mobile), 
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(mom_z14_2026_tests).

test(low_extraction) :-
    domain_priors:base_extractiveness(mom_z14_2026, E), E < 0.10.

test(variance_check) :-
    constraint_indexing:constraint_classification(mom_z14_2026, mountain, _),
    constraint_indexing:constraint_classification(mom_z14_2026, rope, _).

:- end_tests(mom_z14_2026_tests).

/* ==========================================================================
   5. OMEGA VARIABLES (Ω)
   ========================================================================== */

omega_variable(
    omega_mom_z14,
    'Does MoM-z14 contain population III stars?',
    'Spectroscopic analysis of future JWST deep-field data.',
    'Confirmation establishes a new Mountain of stellar evolution.',
    confidence_without_resolution(medium)
).

narrative_ontology:interval(mom_z14_2026, 0, 10).
% ============================================================================
% CONSTRAINT STORY: monetary_regime_transition
% ============================================================================
% Version: 5.2 (Deferential Realism Core + Boltzmann + Purity + Network)
% Logic: 5.2 (Indexed Tuple P,T,E,S + Coupling + Purity + Network Drift)
% Generated: 2024-07-27
% ============================================================================

:- module(constraint_monetary_regime_transition, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    narrative_ontology:constraint_claim/2,
    narrative_ontology:affects_constraint/2,
    narrative_ontology:coordination_type/2,
    narrative_ontology:boltzmann_floor_override/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: monetary_regime_transition
 * human_readable: Sovereign Fiat Currency Regime
 * domain: economic/political
 * * SUMMARY:
 * This constraint models the properties of a modern sovereign fiat currency system, which emerged after the transition from commodity-backed money (like the Gold Standard). The system functions as a coordination tool for the state to manage economic activity, but simultaneously enables value extraction from savers and wage-earners via inflation and monetary policy. The narrative arc is the shift from a perceived 'Mountain' (gold's scarcity) to a complex hybrid system.
 * * KEY AGENTS:
 * - Fixed-Income Saver: Subject (Powerless), experiences value erosion over time.
 * - Central Bank/Sovereign State: Beneficiary (Institutional), uses monetary policy as a flexible tool.
 * - Systems Auditor: Observer (Analytical), analyzes the dual coordination/extraction function.
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% Numerical anchors for v3.4 thresholds
domain_priors:base_extractiveness(monetary_regime_transition, 0.55). % Extraction via seigniorage and inflation tax.
domain_priors:suppression_score(monetary_regime_transition, 0.40).   % Alternatives (gold, crypto, foreign currency) are regulated/suppressed.
domain_priors:theater_ratio(monetary_regime_transition, 0.10).       % Primarily functional, low theatricality.

% Constraint metric facts — primary keys used by the classification engine.
narrative_ontology:constraint_metric(monetary_regime_transition, extractiveness, 0.55).
narrative_ontology:constraint_metric(monetary_regime_transition, suppression_requirement, 0.40).
narrative_ontology:constraint_metric(monetary_regime_transition, theater_ratio, 0.10).

% Constraint self-claim (what does the constraint claim to be?)
% Fiat systems are presented as necessary tools for economic coordination.
narrative_ontology:constraint_claim(monetary_regime_transition, coordination).

% Binary flags
domain_priors:requires_active_enforcement(monetary_regime_transition). % Legal tender laws, capital controls.

% Structural property derivation hooks:
narrative_ontology:constraint_beneficiary(monetary_regime_transition, sovereign_debt_issuers).
narrative_ontology:constraint_victim(monetary_regime_transition, fixed_income_savers).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   Power (P) and Scope (S) both affect effective extraction.
   Scope modifiers: local=0.8, regional=0.9, national=1.0,
                    continental=1.1, global=1.2, universal=1.0.
   ========================================================================== */

% PERSPECTIVE 1: THE SUBJECT (SNARE)
% For a saver with fixed income, inflation is a direct, coercive extraction of
% purchasing power. Effective extraction χ = 0.55 * 1.5 (powerless) * 1.0 (national) = 0.825.
constraint_indexing:constraint_classification(monetary_regime_transition, snare,
    context(agent_power(powerless),
            time_horizon(biographical),
            exit_options(trapped),
            spatial_scope(national))).

% PERSPECTIVE 2: THE BENEFICIARY (ROPE)
% For the central bank, the system is a flexible coordination tool (a Rope)
% for managing economic cycles. Effective extraction is negative,
% χ = 0.55 * -0.2 (institutional) * 1.0 (national) = -0.11, implying a net benefit.
constraint_indexing:constraint_classification(monetary_regime_transition, rope,
    context(agent_power(institutional),
            time_horizon(generational),
            exit_options(arbitrage),
            spatial_scope(national))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (TANGLED ROPE)
% An analyst sees both the coordination function (beneficiaries exist) and the
% asymmetric extraction (victims exist), supported by active enforcement. This
% combination defines a Tangled Rope.
constraint_indexing:constraint_classification(monetary_regime_transition, tangled_rope,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(global))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(monetary_regime_transition_tests).

test(perspectival_gap) :-
    % Verify the saver (powerless) sees a Snare while the state (institutional) sees a Rope.
    constraint_indexing:constraint_classification(monetary_regime_transition, snare,
        context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(monetary_regime_transition, rope,
        context(agent_power(institutional), _, _, _)).

test(analytical_classification_is_tangled_rope) :-
    % Verify the analytical observer correctly identifies the hybrid nature.
    constraint_indexing:constraint_classification(monetary_regime_transition, tangled_rope,
        context(agent_power(analytical), _, _, _)).

test(tangled_rope_structural_properties) :-
    % Verify the necessary properties for a Tangled Rope classification are declared.
    narrative_ontology:constraint_beneficiary(monetary_regime_transition, _), % derives has_coordination_function
    narrative_ontology:constraint_victim(monetary_regime_transition, _),     % derives has_asymmetric_extraction
    domain_priors:requires_active_enforcement(monetary_regime_transition).

:- end_tests(monetary_regime_transition_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * The scores reflect the dual nature of fiat currency. The base extractiveness of 0.55 represents a persistent, moderate inflationary tax that compounds over a biographical timeline. The suppression score of 0.40 acknowledges that while alternatives exist, they face significant regulatory friction.
 * The Perspectival Gap is stark: for the institutional beneficiary (the state), it's a Rope for macroeconomic coordination. For the powerless subject (the saver), it's a Snare that erodes wealth.
 * * MANDATROPHY ANALYSIS: [RESOLVED MANDATROPHY]
 * The Tangled Rope classification is critical here. It prevents the system from collapsing the analysis into a simplistic binary of "good coordination" (Rope) or "bad extraction" (Snare). It correctly identifies the constraint as a system that performs a genuine coordination function for one group while imposing coercive, asymmetric costs on another, sustained by active enforcement.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

% omega_variable(ID, Question, Resolution_Mechanism, Impact, Confidence).
omega_variable(
    omega_monetary_regime_transition,
    'Is the inflationary extraction an unavoidable bug of fiat systems (a cost of flexibility) or a deliberate feature for wealth transfer and debt monetization?',
    'Analysis of central bank mandates, historical policy decisions, and political discourse surrounding inflation targets.',
    'If a bug, it might be fixable (Rope). If a feature, it is an intentional extraction mechanism (Snare component is primary).',
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

% Required for external script parsing
narrative_ontology:interval(monetary_regime_transition, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% This models the period from the stable Bretton Woods system (T=0) through
% its breakdown and the subsequent era of discretionary monetary policy (T=10).
% Extraction accumulates as the constraints of gold backing are removed.

% Theater ratio over time (remains low and functional):
narrative_ontology:measurement(mrt_tr_t0, monetary_regime_transition, theater_ratio, 0, 0.05).
narrative_ontology:measurement(mrt_tr_t5, monetary_regime_transition, theater_ratio, 5, 0.08).
narrative_ontology:measurement(mrt_tr_t10, monetary_regime_transition, theater_ratio, 10, 0.10).

% Extraction over time (increases after link to gold is severed):
narrative_ontology:measurement(mrt_ex_t0, monetary_regime_transition, base_extractiveness, 0, 0.20).
narrative_ontology:measurement(mrt_ex_t5, monetary_regime_transition, base_extractiveness, 5, 0.45).
narrative_ontology:measurement(mrt_ex_t10, monetary_regime_transition, base_extractiveness, 10, 0.55).

/* ==========================================================================
   9. BOLTZMANN & NETWORK DATA (v5.0-5.2)
   ========================================================================== */

% Coordination type (enables Boltzmann floor + complexity offset)
% Fiat currency is a primary mechanism for allocating resources in an economy.
narrative_ontology:coordination_type(monetary_regime_transition, resource_allocation).

% Network relationships (structural influence edges)
% Monetary policy directly enables and influences the sustainability of national debt.
narrative_ontology:affects_constraint(monetary_regime_transition, national_debt_ceiling).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */% ============================================================================
% CONSTRAINT STORY: monty_hall_conditional_probability
% ============================================================================
% Generated: 2026-01-19
% Model: Gemini 2.0 Flash
% Source: Steve Selvin (1975) / Marilyn vos Savant (1990)
% ============================================================================

:- module(constraint_monty_hall, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:constraint_metric/3,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: monty_hall_conditional_probability
 * human_readable: The Monty Hall Problem
 * domain: mathematical/probabilistic
 * temporal_scope: 1975 - Present
 * spatial_scope: Global/Abstract (Game Theory)
 * * SUMMARY:
 * The Monty Hall problem is a counter-intuitive probability puzzle based on a 
 * game show scenario. It demonstrates how new information (opening a door) 
 * shifts probabilities in a way that defies linear human intuition, creating 
 * a structural constraint where "switching" is mathematically superior.
 * * KEY AGENTS:
 * - The Contestant (Subject): The powerless agent facing a choice with 
 * hidden variables and counter-intuitive odds.
 * - The Game Show Host (Institutional): The rule-enforcer who knows the 
 * location of the "Car" and uses the constraint to maintain dramatic tension.
 * - The Intuitive Skeptic (Victim): An agent whose common-sense logic 
 * ("it's 50/50") is "strangled" by the underlying Bayesian Mountain.
 * * NARRATIVE ARC:
 * The problem functions as a "Mountain" of Bayesian reality—the 2/3 vs 1/3 
 * odds are a fixed, unyielding truth of the system's state space. In 
 * education, it is a "Rope" for coordinating an understanding of conditional 
 * probability. However, for the contestant's ego, the paradox acts as a 
 * "Snare," extracting the possibility of a "rational" 50/50 choice and 
 * "strangling" those who refuse to pivot when the rules shift.
 */

/* ==========================================================================
   2. BASE PROPERTIES (Context-Independent)
   ========================================================================== */

% Structural Anchor for the Deferential Realism Auditor
narrative_ontology:interval(probability_paradox_era, 1975, 2026).
narrative_ontology:constraint_claim(monty_hall_conditional_probability, mountain).

% Base extractiveness score (0.0-1.0)
% Rationale: 0.33. The paradox "extracts" 1/3 of the winning probability from 
% those who stay with their original choice, effectively taxing "loyalty" 
% or "stasis" in a changing environment.
domain_priors:base_extractiveness(monty_hall_conditional_probability, 0.33).

% Suppression score (0.0-1.0)
% Rationale: 0.6. It heavily suppresses the visibility of the "50/50" 
% alternative, rendering the intuitive answer mathematically fraudulent 
% and socially ridiculed in academic circles.
domain_priors:suppression_score(monty_hall_conditional_probability, 0.6).

% Constraint metric facts (bridge for classification engine)
narrative_ontology:constraint_metric(monty_hall_conditional_probability, extractiveness, 0.33).
narrative_ontology:constraint_metric(monty_hall_conditional_probability, suppression_requirement, 0.6).

% Enforcement: Emerges naturally from the laws of conditional probability.
domain_priors:emerges_naturally(monty_hall_conditional_probability).

% Metrics required for Section 1 of the Executive Summary
% BENEFICIARIES & VICTIMS
constraint_beneficiary(monty_hall_conditional_probability, bayesian_statisticians).
constraint_beneficiary(monty_hall_conditional_probability, logical_pivoters).
constraint_victim(monty_hall_conditional_probability, intuitive_thinkers).
constraint_victim(monty_hall_conditional_probability, static_choice_advocates).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (Perspectival Truth)
   ========================================================================== */

/* --------------------------------------------------------------------------
   PERSPECTIVE 1: THE DOORS (STATE SPACE) - Mountain
   --------------------------------------------------------------------------
   
   WHO: powerless - The physical configuration of the car has no agency.
   WHEN: immediate - The probability is set the moment the car is placed.
   WHERE: trapped - Bound within the three-door system.
   SCOPE: local - Immediate physical arrangement.
   
   WHY THIS CLASSIFICATION:
   For the system itself, the conditional probabilities are a natural law. 
   Opening a goat-door *must* concentrate the remaining probability into 
   the unchosen, unopened door. It is an unyielding Mountain of logic.
   -------------------------------------------------------------------------- */



constraint_indexing:constraint_classification(
    monty_hall_conditional_probability,
    mountain,
    context(
        agent_power(powerless),
        time_horizon(immediate),
        exit_options(trapped),
        spatial_scope(local)
    )
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 2: THE PROBABILITY PROFESSOR - Rope
   --------------------------------------------------------------------------
   
   WHO: institutional - Power to use the paradox to coordinate classroom learning.
   WHEN: biographical - Spanning the duration of a student's cognitive shift.
   WHERE: mobile - Can choose different variants (100 doors) to illustrate the point.
   SCOPE: global - Universal pedagogical tool.
   
   WHY THIS CLASSIFICATION:
   For the educator, the problem is a "Rope"—a functional coordination 
   mechanism. It allows them to "pull" students away from the "Snare" of 
   faulty intuition toward a standard of achievement in Bayesian thinking.
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    monty_hall_conditional_probability,
    rope,
    context(
        agent_power(institutional),
        time_horizon(biographical),
        exit_options(mobile),
        spatial_scope(global)
    )
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 3: THE SKEPTICAL CONTESTANT - Snare
   --------------------------------------------------------------------------
   
   WHO: powerless - Lacks the tools to compute the shift in real-time.
   WHEN: immediate - Forced to choose between switching or staying NOW.
   WHERE: constrained - The "exit" (switching) feels like a betrayal of intuition.
   SCOPE: local - A specific, high-stakes game.
   
   WHY THIS CLASSIFICATION:
   For the intuitive thinker, the problem is a "Snare." It "strangles" their 
   common-sense confidence. Because they perceive a 50/50 choice, the system 
   extracts 33% of their winning chance (extraction) if they fail to 
   overcome their cognitive bias. The logic of the host "chokes" their 
   original intent.
   -------------------------------------------------------------------------- */



constraint_indexing:constraint_classification(
    monty_hall_conditional_probability,
    snare,
    context(
        agent_power(powerless),
        time_horizon(immediate),
        exit_options(constrained),
        spatial_scope(local)
    )
) :- 
    domain_priors:base_extractiveness(monty_hall_conditional_probability, E),
    E >= 0.3,
    !.

/* ==========================================================================
   4. TESTS (What We Learn About Constraints)
   ========================================================================== */

:- begin_tests(monty_hall_conditional_probability_tests).

test(multi_perspective_variance) :-
    % Doors -> Mountain
    constraint_indexing:constraint_classification(monty_hall_conditional_probability, Type1, context(powerless, immediate, trapped, local)),
    % Professor -> Rope
    constraint_indexing:constraint_classification(monty_hall_conditional_probability, Type2, context(institutional, biographical, mobile, global)),
    Type1 \= Type2.

test(intuitive_extraction_penalty) :-
    % Demonstrates that the Snare classification extracts more value (win %) from the powerless agent.
    ContextPowerless = context(powerless, immediate, constrained, local),
    constraint_indexing:extractiveness_for_agent(monty_hall_conditional_probability, ContextPowerless, Score),
    Score >= 0.33.

test(natural_emergence) :-
    domain_priors:emerges_naturally(monty_hall_conditional_probability).

:- end_tests(monty_hall_conditional_probability_tests).

/* ==========================================================================
   5. MODEL INTERPRETATION (Commentary)
   ========================================================================== */

/**
 * LLM GENERATION NOTES
 * * Model: Gemini 2.0 Flash
 * Date: 2026-01-19
 * * KEY DECISIONS:
 * 1. EXTRACTIVENESS SCORE (0.33): 
 * The system is mathematically biased against the "Stay" strategy. It 
 * extracts exactly 33.3% of the potential win-rate compared to the "Switch" 
 * strategy.
 * 2. PERSPECTIVE SELECTION: 
 * Chose Doors (Subject), Professor (Institution), and Skeptic (Victim) 
 * to highlight the gap between "State," "Utility," and "Trap."
 * 3. SUPPRESSION SCORE (0.6): 
 * The paradox is famous because it so effectively suppresses the "linear" 
 * alternative, making those who hold onto it look "irrational."
 */

% OMEGA IDENTIFICATION
omega_variable(
    host_behavior_certainty,
    "Is the 'Mountain' stable if the host's behavior is not guaranteed (e.g., Monty only offers the switch when you have the car)?",
    resolution_mechanism("Meta-analysis of game rules and host intent across different game show iterations."),
    impact("If Host is malicious: The 'Switch' Rope becomes a 'Snare'. If Host is rule-bound: It is a Mountain."),
    confidence_without_resolution(medium)
).

/* ==========================================================================
   6. ALTERNATIVE ANALYSIS
   ========================================================================== */

/**
 * VIABLE ALTERNATIVES
 * * ALTERNATIVE 1: The "Stay" Strategy
 * Viability: Winning 1/3 of the time.
 * Suppression: Actively suppressed by math educators as "wrong."
 * Evidence: Vos Savant's column receiving thousands of angry (incorrect) letters.
 * * ALTERNATIVE 2: Malicious Host (The "Monty Fall" variant)
 * Viability: If the host only opens a door when you are currently winning.
 * Suppression: Ignored in the standard "idealized" version of the problem.
 * * CONCLUSION:
 * The standard problem assumes a "Rule-Bound" host, turning the "Switch" into 
 * a "Rope." If the host is not rule-bound, the entire Mountain collapses 
 * into a psychological Scaffold.
 */

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

/**
 * TO USE THIS FILE:
 * 1. Load: ?- [monty_hall_conditional_probability].
 * 2. Multi-perspective: ?- multi_index_report(monty_hall_conditional_probability).
 */

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: moores_law
% ============================================================================
% Generated: 2026-01-19
% Model: Gemini 2.0 Flash
% Source: Moore, G. E. (1965) / Semiconductor Physics
% ============================================================================

:- module(constraint_moores_law, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile 
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:requires_active_enforcement/1,
    constraint_indexing:constraint_classification/3,
    narrative_ontology:constraint_claim/2,
    narrative_ontology:constraint_metric/3,
    constraint_beneficiary/2,
    constraint_victim/2.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: moores_law
 * human_readable: Moore's Law
 * domain: technological/economic
 * temporal_scope: 1965-Present (The Silicon Era)
 * spatial_scope: Global (Computational Hardware)
 * * SUMMARY:
 * Moore's Law is the observation that the number of transistors on a 
 * microchip doubles approximately every two years, while the cost of 
 * computers is halved. It is less a physical law and more a self-fulfilling 
 * prophecy or a "socially enforced" pace of innovation that has driven 
 * the digital revolution.
 * * KEY AGENTS:
 * - The Semiconductor Engineer: Bound to the "treadmill" of miniaturization.
 * - The Software Developer: Relies on "free" hardware gains to offset 
 * inefficient code (Wirth's Law).
 * - The Strategic Investor: Uses the law as a predictable clock for 
 * capital deployment and market obsolescence.
 * * NARRATIVE ARC:
 * Originally a Rope (a beneficial coordination target), Moore's Law has 
 * become a Mountain (an seemingly immutable pace of progress) and a 
 * Snare for manufacturers who must spend billions in R&D just to stay 
 * in the same place relative to the market.
 */

/* ==========================================================================
   2. BASE PROPERTIES (The "Reality" Layer)
   ========================================================================== */

% Required for structural integration
narrative_ontology:interval(moores_law_interval, 0, 10).
narrative_ontology:constraint_claim(moores_law, mountain).

% Base extractiveness: 0.3 (Low-Moderate)
% Rationale: It extracts value through planned obsolescence. Devices lose 
% utility rapidly as the "frontier" moves forward, forcing a cycle of 
% consumption and extraction of consumer capital.
domain_priors:base_extractiveness(moores_law, 0.3).

% Suppression score: 0.5 (Moderate)
% Rationale: Alternative hardware architectures (e.g., analog computing) 
% are suppressed by the massive economies of scale and "gravity" of the 
% standard silicon roadmap.
domain_priors:suppression_score(moores_law, 0.5).

% Constraint metric facts (bridge for classification engine)
narrative_ontology:constraint_metric(moores_law, extractiveness, 0.3).
narrative_ontology:constraint_metric(moores_law, suppression_requirement, 0.5).

% Enforcement requirements: Requires active, massive capital enforcement 
% by the semiconductor industry to maintain the pace.
domain_priors:requires_active_enforcement(moores_law).

% Metrics for Section 1 of the Executive Summary
% Beneficiaries: Consumer electronics industry and data-intensive services.
constraint_beneficiary(moores_law, platform_capitalists).

% Victims: Older hardware owners and the environment (e-waste).
constraint_victim(moores_law, legacy_infrastructure_owners).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (Perspectival Truth)
   ========================================================================== */

/* --------------------------------------------------------------------------
   PERSPECTIVE 1: THE END USER - ROPE
   --------------------------------------------------------------------------
   
   WHO: powerless (A consumer of technology).
   WHEN: biographical (A lifetime of increasing computational power).
   WHERE: mobile (Can choose when to upgrade).
   SCOPE: global.
   
   WHY THIS CLASSIFICATION:
   For the user, Moore's Law is a Rope. It is a predictable ladder of 
   progress. It ensures that the computer they buy today will be 
   significantly more powerful than the one they had five years ago, 
   lowering the barrier to entry for complex software and services.
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    moores_law,
    rope,
    context(
        agent_power(powerless),
        time_horizon(biographical),
        exit_options(mobile),
        spatial_scope(global)
    )
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 2: THE CHIP FABRICATOR - SNARE
   --------------------------------------------------------------------------
   
   WHO: institutional (A semiconductor manufacturer like Intel or TSMC).
   WHEN: immediate (Quarterly cycles and multi-billion dollar R&D).
   WHERE: constrained (Cannot stop without losing market lead).
   SCOPE: global.
   
   WHY THIS CLASSIFICATION:
   For the manufacturer, the law is a Snare. It is an "unrelenting 
   treadmill." If they fail to meet the doubling pace for a single cycle, 
   their market cap can evaporate. The cost of maintaining the pace 
   (the "Snare") increases exponentially as physics reaches its limits.
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    moores_law,
    snare,
    context(
        agent_power(institutional),
        time_horizon(immediate),
        exit_options(constrained),
        spatial_scope(global)
    )
) :- !.

/* --------------------------------------------------------------------------
   PERSPECTIVE 3: THE QUANTUM PHYSICIST - MOUNTAIN
   --------------------------------------------------------------------------
   
   WHO: analytical (Scientific observer).
   WHEN: generational/historical (Viewing the physical limits of matter).
   WHERE: trapped (Atomic scales are fixed).
   SCOPE: global.
   
   WHY THIS CLASSIFICATION:
   To the physicist, the eventual "end" of Moore's Law is a Mountain. It 
   is a physical wall. Once transistors reach the size of a few atoms, 
   quantum tunneling makes current silicon-based logic impossible. 
   This is not a social choice, but an unchangeable physical constraint.
   -------------------------------------------------------------------------- */

constraint_indexing:constraint_classification(
    moores_law,
    mountain,
    context(
        agent_power(analytical),
        time_horizon(generational),
        exit_options(trapped),
        spatial_scope(global)
    )
) :- !.

/* ==========================================================================
   4. TESTS
   ========================================================================== */

:- begin_tests(moores_law_tests).

test(multi_perspective_variance) :-
    constraint_indexing:constraint_classification(moores_law, Type1, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(moores_law, Type2, context(agent_power(institutional), _, _, _)),
    constraint_indexing:constraint_classification(moores_law, Type3, context(agent_power(analytical), _, _, _)),
    Type1 \= Type2,
    Type2 \= Type3.

test(enforcement_scaling) :-
    % Institutional actors must enforce this (Requires Active Enforcement).
    domain_priors:requires_active_enforcement(moores_law).

test(time_immutability) :-
    % Long-term (Generational) analysis reveals the physical "Mountain" limit.
    constraint_indexing:constraint_classification(moores_law, mountain, context(_, generational, _, _)).

:- end_tests(moores_law_tests).

/* ==========================================================================
   5. MODEL INTERPRETATION (Commentary)
   ========================================================================== */

/**
 * LLM GENERATION NOTES
 * * Model: Gemini 2.0 Flash
 * * KEY DECISIONS:
 * 1. ENFORCEMENT: I classified this as "Requires Active Enforcement." While 
 * it looks like a natural law, it is actually the result of massive 
 * industrial coordination and investment.
 * 2. SNARE VS ROPE: The distinction depends on whether you are the 
 * producer (Snare) or the consumer (Rope) of the processing power.
 * 3. EXTRACTIVENESS: Set at 0.3. The gain in utility for users is real, 
 * but the extraction comes through the "forced" obsolescence of 
 * working hardware.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω)
   ========================================================================== */

omega_variable(
    post_silicon_transition,
    "Will new materials (Carbon nanotubes/Quantum) maintain the 2-year 
    doubling pace once silicon hits the atomic limit?",
    resolution_mechanism("Observation of commercial chip density post-2nm node"),
    impact("If Yes: Moore's Law remains a Rope/Snare. If No: It hits the Mountain."),
    confidence_without_resolution(medium)
).

/* ==========================================================================
   7. ALTERNATIVE ANALYSIS
   ========================================================================== */

/**
 * VIABLE ALTERNATIVES
 * * ALTERNATIVE 1: Software Optimization (Wirth's Law)
 * Viability: High. If software was written efficiently, we wouldn't 
 * need a hardware doubling every 2 years.
 * Suppression: High. Developers prefer "easy" code enabled by fast 
 * hardware over difficult optimization.
 * * ALTERNATIVE 2: Specialized Architecture (ASICs/FPGAs)
 * Viability: High. Moving away from general-purpose CPUs.
 * * CONCLUSION:
 * The "Snare" of Moore's Law is partly voluntary; we could exit via 
 * better software, but the "Rope" of free hardware gains is too seductive.
 */

/* ==========================================================================
   8. INTEGRATION HOOKS
   ========================================================================== */

/**
 * TO USE THIS FILE:
 * 1. Load: ?- [constraint_moores_law].
 * 2. Multi-perspective report: ?- multi_index_report(moores_law).
 */

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */
% ============================================================================
% CONSTRAINT STORY: multi_planetary_latency_lock
% ============================================================================
% Version: 5.2 (Deferential Realism Core + Boltzmann + Purity + Network)
% Logic: 5.2 (Indexed Tuple P,T,E,S + Coupling + Purity + Network Drift)
% Generated: 2024-07-15
% ============================================================================

:- module(constraint_multi_planetary_latency_lock, []).

:- use_module(constraint_indexing).
:- use_module(domain_priors).
:- use_module(narrative_ontology).

% --- Namespace Hooks (Required for loading) ---
:- multifile
    domain_priors:base_extractiveness/2,
    domain_priors:suppression_score/2,
    domain_priors:theater_ratio/2,
    domain_priors:requires_active_enforcement/1,
    narrative_ontology:has_sunset_clause/1,
    narrative_ontology:interval/3,
    narrative_ontology:measurement/5,
    narrative_ontology:constraint_metric/3,
    narrative_ontology:constraint_beneficiary/2,
    narrative_ontology:constraint_victim/2,
    narrative_ontology:constraint_claim/2,
    narrative_ontology:affects_constraint/2,
    narrative_ontology:coordination_type/2,
    narrative_ontology:boltzmann_floor_override/2,
    constraint_indexing:constraint_classification/3.

/* ==========================================================================
   1. NARRATIVE CONTEXT
   ========================================================================== */

/**
 * CONSTRAINT IDENTIFICATION
 * * constraint_id: multi_planetary_latency_lock
 * human_readable: Earth-Centric Interplanetary Clearing
 * domain: technological/economic
 * * SUMMARY:
 * As civilization expands to Mars, the speed of light creates an irreducible
 * communication latency (3-22 minutes). Earth-based financial institutions
 * leverage this physical limit by creating a centralized, Earth-time clearing
 * system. They charge significant "latency surcharges" for guaranteeing
 * transactions across the time gap, turning a physical constant into an
 * extractive policy. This policy actively suppresses decentralized, local
 * clearing alternatives that would be more efficient for off-world colonies.
 * * KEY AGENTS:
 * - Martian Colonist: Subject (Powerless)
 * - Earth-Based Financial Consortium: Beneficiary (Institutional)
 * - Systems Auditor: Auditor (Analytical)
 */

/* ==========================================================================
   2. BASE PROPERTIES (DOMAIN PRIORS)
   ========================================================================== */

% The constraint is the POLICY, not the physics. The policy is highly extractive.
domain_priors:base_extractiveness(multi_planetary_latency_lock, 0.75).
% Suppression is high because the central authority actively works to prevent
% the emergence of a decentralized, off-world financial system.
domain_priors:suppression_score(multi_planetary_latency_lock, 0.90).
domain_priors:theater_ratio(multi_planetary_latency_lock, 0.15). % Low theater; the enforcement and extraction are real.

% Constraint metric facts — primary keys used by the classification engine.
narrative_ontology:constraint_metric(multi_planetary_latency_lock, extractiveness, 0.75).
narrative_ontology:constraint_metric(multi_planetary_latency_lock, suppression_requirement, 0.90).
narrative_ontology:constraint_metric(multi_planetary_latency_lock, theater_ratio, 0.15).

% The system claims to be a necessary coordination mechanism for interplanetary stability.
narrative_ontology:constraint_claim(multi_planetary_latency_lock, coordination).

% Binary flags
domain_priors:requires_active_enforcement(multi_planetary_latency_lock). % Required for Tangled Rope

% Structural property derivation hooks for Tangled Rope:
narrative_ontology:constraint_beneficiary(multi_planetary_latency_lock, earth_financial_consortium).
narrative_ontology:constraint_victim(multi_planetary_latency_lock, off_world_colonists).

/* ==========================================================================
   3. INDEXED CLASSIFICATIONS (P, T, E, S)
   χ = ε × π(P) × σ(S)
   Power (P) and Scope (S) both affect effective extraction.
   Scope modifiers: universal=1.0.
   ========================================================================== */

% PERSPECTIVE 1: THE SUBJECT (SNARE)
% The colonist is trapped in an extractive system justified by physics they
% cannot change. Effective extraction χ = 0.75 * 1.5 * 1.0 = 1.125 (Snare).
constraint_indexing:constraint_classification(multi_planetary_latency_lock, snare,
    context(agent_power(powerless),
            time_horizon(biographical),
            exit_options(trapped),
            spatial_scope(universal))).

% PERSPECTIVE 2: THE BENEFICIARY (ROPE)
% The consortium sees the system as essential coordination.
% Effective extraction χ = 0.75 * -0.2 * 1.0 = -0.15 (Rope).
constraint_indexing:constraint_classification(multi_planetary_latency_lock, rope,
    context(agent_power(institutional),
            time_horizon(generational),
            exit_options(mobile),
            spatial_scope(universal))).

% PERSPECTIVE 3: THE ANALYTICAL OBSERVER (TANGLED ROPE)
% The observer sees both the coordination function for Earth and the asymmetric
% extraction from the colonies, supported by active enforcement.
% Effective extraction χ = 0.75 * 1.15 * 1.0 = 0.8625 (Tangled Rope).
constraint_indexing:constraint_classification(multi_planetary_latency_lock, tangled_rope,
    context(agent_power(analytical),
            time_horizon(civilizational),
            exit_options(analytical),
            spatial_scope(universal))).

/* ==========================================================================
   4. VALIDATION TESTS
   ========================================================================== */

:- begin_tests(multi_planetary_latency_lock_tests).

test(perspectival_gap) :-
    % Verify the gap between the colonist (Snare) and the consortium (Rope).
    constraint_indexing:constraint_classification(multi_planetary_latency_lock, snare, context(agent_power(powerless), _, _, _)),
    constraint_indexing:constraint_classification(multi_planetary_latency_lock, rope, context(agent_power(institutional), _, _, _)),
    constraint_indexing:constraint_classification(multi_planetary_latency_lock, tangled_rope, context(agent_power(analytical), _, _, _)).

test(tangled_rope_structural_properties) :-
    % Verify that all three requirements for Tangled Rope are met.
    narrative_ontology:constraint_beneficiary(multi_planetary_latency_lock, _),
    narrative_ontology:constraint_victim(multi_planetary_latency_lock, _),
    domain_priors:requires_active_enforcement(multi_planetary_latency_lock).

test(threshold_validation) :-
    % Ensure base extraction is high enough for a Snare/Tangled Rope classification.
    config:param(extractiveness_metric_name, ExtMetricName),
    narrative_ontology:constraint_metric(multi_planetary_latency_lock, ExtMetricName, E),
    E >= 0.46.

:- end_tests(multi_planetary_latency_lock_tests).

/* ==========================================================================
   5. GENERATIVE COMMENTARY
   ========================================================================== */

/**
 * LOGIC RATIONALE:
 * This model was refactored to focus on the *policy* of Earth-centric clearing,
 * not the physical law of light speed itself. The physical law acts as an
 * unchangeable pretext (a "Mountain") that justifies the creation of a highly
 * extractive policy (a "Tangled Rope"). The base extractiveness of 0.75
 * reflects the "latency surcharge" and other fees imposed by the system.
 *
 * PERSPECTIVAL GAP:
 * The gap is stark. The Martian Colonist experiences a Snare: a costly,
 * inescapable system. The Earth-Based Financial Consortium, which profits
 * immensely and feels no negative effects (in fact, a net benefit), views it
 * as a pure Rope providing necessary coordination and stability. The Analytical
 * Observer, seeing both the coordination claim and the severe asymmetric
 * extraction, correctly classifies it as a Tangled Rope.
 *
 * MANDATROPHY ANALYSIS:
 * [RESOLVED MANDATROPHY] The Tangled Rope classification is critical here.
 * A simpler model might label this a Snare, ignoring the consortium's valid
 * (from their perspective) coordination function. Another might label it a
 * Rope, ignoring the crippling extraction felt by colonists. Tangled Rope
 * captures the dual-nature of the constraint: it performs a real coordination
 * function for one group while simultaneously functioning as a predatory
 * extraction mechanism for another.
 */

/* ==========================================================================
   6. OMEGA VARIABLES (Ω) - IRREDUCIBLE UNCERTAINTIES
   ========================================================================== */

omega_variable(
    omega_ftl_comms,
    'Can non-local quantum entanglement or other novel physics bypass the light-speed latency lock for information transfer?',
    'Experimental validation of superluminal information transfer.',
    'If True: The physical pretext for the policy vanishes, causing the Tangled Rope to collapse or be revealed as a pure Snare. If False: The policy remains justifiable on physical grounds, solidifying its power.',
    confidence_without_resolution(low)
).

/* ==========================================================================
   7. INTEGRATION HOOKS
   ========================================================================== */

narrative_ontology:interval(multi_planetary_latency_lock, 0, 10).

/* ==========================================================================
   8. TEMPORAL MEASUREMENTS (LIFECYCLE DRIFT DATA)
   ========================================================================== */

% This system likely began as a mild coordination fee and grew more extractive
% as off-world dependence increased.
%
% Theater ratio over time (remains low):
narrative_ontology:measurement(mpll_tr_t0, multi_planetary_latency_lock, theater_ratio, 0, 0.05).
narrative_ontology:measurement(mpll_tr_t5, multi_planetary_latency_lock, theater_ratio, 5, 0.10).
narrative_ontology:measurement(mpll_tr_t10, multi_planetary_latency_lock, theater_ratio, 10, 0.15).

% Extraction over time (extraction_accumulation drift):
narrative_ontology:measurement(mpll_ex_t0, multi_planetary_latency_lock, base_extractiveness, 0, 0.50).
narrative_ontology:measurement(mpll_ex_t5, multi_planetary_latency_lock, base_extractiveness, 5, 0.65).
narrative_ontology:measurement(mpll_ex_t10, multi_planetary_latency_lock, base_extractiveness, 10, 0.75).

/* ==========================================================================
   9. BOLTZMANN & NETWORK DATA (v5.0-5.2)
   ========================================================================== */

% This policy is a form of financial resource allocation.
narrative_ontology:coordination_type(multi_planetary_latency_lock, resource_allocation).

% This constraint would be structurally coupled with rules governing off-world rights.
narrative_ontology:affects_constraint(multi_planetary_latency_lock, off_world_resource_rights).

/* ==========================================================================
   END OF CONSTRAINT STORY
   ========================================================================== */